<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ç¬¬ä¸‰è®²-ç¥ç»ç½‘ç»œçŸ¥è¯†</title>
    <link href="/2022/05/06/%E7%AC%AC%E4%B8%89%E8%AE%B2-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86/"/>
    <url>/2022/05/06/%E7%AC%AC%E4%B8%89%E8%AE%B2-%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9F%A5%E8%AF%86/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¥ç»ç½‘ç»œåŸºç¡€">1 ç¥ç»ç½‘ç»œåŸºç¡€</h1><h2 id="åˆ†ç±»é—®é¢˜åŸºç¡€">1.1 åˆ†ç±»é—®é¢˜åŸºç¡€</h2><p>å¯¹äºåˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬æœ‰è®­ç»ƒ<strong>æ•°æ®é›†</strong>ï¼šå®ƒç”±ä¸€äº›<strong>æ ·æœ¬</strong>ç»„æˆï¼š<span class="math display">\[\{x_i,y_i\}^N_{i=1}\]</span></p><ul><li><spanclass="math inline">\(x_i\)</span>æ˜¯<strong>è¾“å…¥</strong>ï¼Œä¾‹å¦‚å•è¯(ç´¢å¼•æˆ–æ˜¯å‘é‡)ï¼Œå¥å­ï¼Œæ–‡æ¡£ç­‰ç­‰(ç»´åº¦ä¸ºd)</li><li><spanclass="math inline">\(y_i\)</span>æ˜¯æˆ‘ä»¬å°è¯•é¢„æµ‹çš„æ ‡ç­¾(Cä¸ªç±»åˆ«ä¸­çš„ä¸€ä¸ª)ï¼Œä¾‹å¦‚ï¼š<ul><li>ç±»åˆ«ï¼šæ„Ÿæƒ…ï¼Œå‘½åå®ä½“ï¼Œè´­ä¹°/å”®å‡ºçš„å†³å®š</li><li>å…¶ä»–å•è¯</li><li>å¤šè¯åºåˆ—(ä¹‹åä¼šæåˆ°)</li></ul></li></ul><h2 id="åˆ†ç±»é—®é¢˜ç›´è§‚ç†è§£">1.2 åˆ†ç±»é—®é¢˜ç›´è§‚ç†è§£</h2><ul><li><p>ç”¨ä¸€ä¸ªæœ€ç®€å•çš„2ç»´è¯å‘é‡åˆ†ç±»é—®é¢˜ä½œä¸ºæ¡ˆä¾‹</p><ul><li>ä½¿ç”¨softmax / logisticå›å½’</li><li>æ„å»ºçº¿æ€§å†³ç­–è¾¹ç•Œ</li></ul></li><li><p><strong>ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ /ç»Ÿè®¡å­¦æ–¹æ³•</strong>ï¼šå‡è®¾<spanclass="math inline">\(x_i\)</span>æ˜¯å›ºå®šçš„ï¼Œè®­ç»ƒ softmax/logisticå›å½’çš„æƒé‡<span class="math inline">\(W \in R^{C \timesd}\)</span>æ¥å†³å®šå†³å®šè¾¹ç•Œ(è¶…å¹³é¢)</p></li><li><p><strong>é¢„æµ‹é˜¶æ®µ</strong>ï¼Œå¯¹æ¯ä¸ª<spanclass="math inline">\(x\)</span>ï¼Œé¢„æµ‹:</p></li></ul><p><span class="math display">\[p(y \mid x)=\frac{\exp \left(W_{y} \cdot x\right)}{\sum_{c=1}^{C} \exp\left(W_{c} \cdot x\right)}\]</span></p><h2 id="softmaxåˆ†ç±»å™¨çš„ç»†èŠ‚">1.3 softmaxåˆ†ç±»å™¨çš„ç»†èŠ‚</h2><p>æˆ‘ä»¬å¯ä»¥å°†é¢„æµ‹å‡½æ•°åˆ†ä¸º<strong>ä¸¤ä¸ªæ­¥éª¤</strong>ï¼š</p><h3 id="å°†wçš„ythè¡Œå’Œxä¸­çš„å¯¹åº”è¡Œç›¸ä¹˜å¾—åˆ°åˆ†æ•°">1 å°†<spanclass="math inline">\(W\)</span>çš„<spanclass="math inline">\(y^{th}\)</span>è¡Œå’Œ<spanclass="math inline">\(x\)</span>ä¸­çš„å¯¹åº”è¡Œç›¸ä¹˜å¾—åˆ°åˆ†æ•°ï¼š</h3><p><span class="math display">\[W_{y} \cdot x=\sum_{i=1}^{d} W_{y i} x_{i}=f_{y}\]</span></p><p>å¯¹c=1ï¼Œ2ï¼Œ...ï¼ŒCè®¡ç®—æ‰€æœ‰çš„<spanclass="math inline">\(f_y\)</span></p><h3 id="ä½¿ç”¨softmaxå‡½æ•°è·å¾—å½’ä¸€åŒ–çš„æ¦‚ç‡">2ä½¿ç”¨softmaxå‡½æ•°è·å¾—å½’ä¸€åŒ–çš„æ¦‚ç‡ï¼š</h3><p><span class="math display">\[p(y \mid x)=\frac{\exp \left(f_{y}\right)}{\sum_{c=1}^{C} \exp\left(f_{c}\right)}=\operatorname{softmax}\left(f_{y}\right)\]</span></p><h2 id="softmaxå’Œäº¤å‰ç†µæŸå¤±">1.4 softmaxå’Œäº¤å‰ç†µæŸå¤±</h2><p>åœ¨softmaxåˆ†ç±»å™¨ä¸­æœ€å¸¸ç”¨åˆ°äº¤å‰ç†µæŸå¤±ï¼Œä¹Ÿæ˜¯è´Ÿå¯¹æ•°æ¦‚ç‡å½¢æ€ã€‚</p><p>å¯¹äºæ¯ä¸ªè®­ç»ƒæ ·æœ¬<spanclass="math inline">\((x,y)\)</span>ï¼Œæˆ‘ä»¬çš„ç›®æ ‡<strong>æ˜¯æœ€å¤§åŒ–æ­£ç¡®ç±»</strong><spanclass="math inline">\(y\)</span>çš„æ¦‚ç‡ï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥<strong>æœ€å°åŒ–è¯¥ç±»çš„è´Ÿå¯¹æ•°æ¦‚ç‡</strong>:<span class="math display">\[-\log p(y \mid x)=-\log \left(\frac{\exp\left(f_{y}\right)}{\sum_{c=1}^{C} \exp \left(f_{c}\right)}\right)\]</span></p><h2 id="äº¤å‰ç†µæŸå¤±ç†è§£">1.5 äº¤å‰ç†µæŸå¤±ç†è§£</h2><ul><li>äº¤å‰ç†µçš„æ¦‚å¿µæ¥æºäºä¿¡æ¯è®ºï¼Œè¡¡é‡ä¸¤ä¸ªåˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼Œäº¤å‰ç†µè¶Šå¤§ï¼Œå˜é‡çš„å–å€¼è¶Šä¸ç¡®å®šï¼Œåä¹‹åˆ™è¶Šç¡®å®šã€‚</li><li>ä»¤çœŸå®æ¦‚ç‡åˆ†å¸ƒä¸º<spanclass="math inline">\(p\)</span>ï¼Œæˆ‘ä»¬è®¡ç®—çš„æ¨¡å‹æ¦‚ç‡åˆ†å¸ƒä¸º<spanclass="math inline">\(q\)</span></li><li>äº¤å‰ç†µä¸ºï¼š</li></ul><p><span class="math display">\[H(p, q)=-\sum_{c=1}^{C} p(c) \log q(c)\]</span></p><ul><li>å‡è®¾æ ‡å‡†ç­”æ¡ˆçš„æ¦‚ç‡åˆ†å¸ƒæ˜¯ï¼Œåœ¨æ­£ç¡®çš„ç±»ä¸Šä¸º1ï¼Œåœ¨å…¶ä»–ç±»åˆ«ä¸Šä¸º0ï¼š</li></ul><p><span class="math display">\[p=[0,...,0,1,...,0]\]</span></p><ul><li>å› ä¸ºæ˜¯ç‹¬çƒ­å‘é‡(one-hotvector)ï¼Œæ‰€ä»¥å”¯ä¸€å‰©ä¸‹çš„é¡¹æ˜¯çœŸå®ç±»çš„è´Ÿå¯¹æ•°æ¦‚ç‡ã€‚</li></ul><h2 id="å®Œæ•´æ•°æ®é›†ä¸Šçš„åˆ†ç±»">1.6 å®Œæ•´æ•°æ®é›†ä¸Šçš„åˆ†ç±»</h2><p>åœ¨æ•´ä¸ªæ•°æ®é›†<spanclass="math inline">\(\{x_i,y_i\}_{i=1}^N\)</span>ä¸Šçš„äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œæ˜¯æ‰€æœ‰æ ·æœ¬çš„äº¤å‰ç†µçš„å‡å€¼<span class="math display">\[J(\theta)=\frac{1}{N} \sum_{i=1}^{N}-\log\left(\frac{e^{f_{y_{i}}}}{\sum_{c=1}^{C} e^{f_{c}}}\right)\]</span> ä¸ä½¿ç”¨ <span class="math display">\[f_{y}=f_{y}(x)=W_{y} \cdot x=\sum_{j=1}^{d} W_{y j} x_{j}\]</span> è€Œæ˜¯ä½¿ç”¨å‘é‡åŒ–çš„å½¢æ€ï¼ŒåŸºäºçŸ©é˜µæ¥è¡¨ç¤º<spanclass="math inline">\(f:f=W_x\)</span></p><h2 id="ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ä¼˜åŒ–ç®—æ³•">1.7 ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ä¼˜åŒ–ç®—æ³•</h2><p>å¯¹äºä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼ˆå¦‚é€»è¾‘å›å½’ï¼‰æ¥è¯´ï¼Œä¸€èˆ¬æœºå™¨å­¦ä¹ çš„å‚æ•°<spanclass="math inline">\(\theta\)</span>é€šå¸¸åªç”±<spanclass="math inline">\(W\)</span>çš„åˆ—ç»„æˆ <span class="math display">\[\theta=\left[\begin{array}{c}W_{\cdot 1} \\\vdots \\W_{\cdot d}\end{array}\right]=W(:) \in \mathbb{R}^{C d}\]</span> å› æ­¤ï¼Œæˆ‘ä»¬åªé€šè¿‡ä»¥ä¸‹æ–¹å¼<strong>æ›´æ–°å†³ç­–è¾¹ç•Œ</strong> <spanclass="math display">\[\nabla_{\theta} J(\theta)=\left[\begin{array}{c}\nabla_{W_{1}} \\\vdots \\\nabla_{W_{d}}\end{array}\right] \in \mathbb{R}^{C d}\]</span></p><h2 id="ç¥ç»ç½‘ç»œåˆ†ç±»å™¨">1.8 ç¥ç»ç½‘ç»œåˆ†ç±»å™¨</h2><ul><li>å•ç‹¬ä½¿ç”¨çº¿æ€§åˆ†ç±»å™¨Softmax( â‰ˆ logisticå›å½’)å¹¶ä¸ååˆ†å¼ºå¤§</li></ul><p><img src="/img/nlp/ç¬¬ä¸‰è®²/1.png" /></p><ul><li>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒSoftmaxå¾—åˆ°çš„æ˜¯çº¿æ€§å†³ç­–è¾¹ç•Œ<ul><li>å¯¹äºå¤æ‚é—®é¢˜æ¥è¯´ï¼Œå®ƒçš„è¡¨è¾¾èƒ½åŠ›æ˜¯æœ‰é™çš„</li><li>æœ‰ä¸€äº›åˆ†é”™çš„ç‚¹ï¼Œéœ€è¦æ›´å¼ºçš„éçº¿æ€§è¡¨è¾¾èƒ½åŠ›æ¥åŒºåˆ†</li></ul></li></ul><h2 id="ç¥ç»ç½‘ç»œéçº¿æ€§åˆ‡åˆ†">1.9 ç¥ç»ç½‘ç»œéçº¿æ€§åˆ‡åˆ†</h2><ul><li><p>ç¥ç»ç½‘ç»œå¯ä»¥å­¦ä¹ æ›´å¤æ‚çš„å‡½æ•°å’Œéçº¿æ€§å†³ç­–è¾¹ç•Œ</p></li><li><p>tip ï¼šæ›´é«˜çº§çš„åˆ†ç±»éœ€è¦</p><ul><li>è¯å‘é‡</li><li>æ›´æ·±å±‚æ¬¡çš„æ·±å±‚ç¥ç»ç½‘ç»œ</li></ul></li></ul><h2 id="åŸºäºè¯å‘é‡çš„åˆ†ç±»å·®å¼‚">1.10 åŸºäºè¯å‘é‡çš„åˆ†ç±»å·®å¼‚</h2><ul><li>ä¸€èˆ¬åœ¨NLPæ·±åº¦å­¦ä¹ ä¸­ï¼š<ul><li>æˆ‘ä»¬å­¦ä¹ äº†çŸ©é˜µ<span class="math inline">\(W\)</span>å’Œè¯å‘é‡<spanclass="math inline">\(x\)</span>ã€‚</li><li>æˆ‘ä»¬å­¦ä¹ ä¼ ç»Ÿå‚æ•°å’Œè¡¨ç¤ºã€‚</li><li>è¯å‘é‡æ˜¯å¯¹ç‹¬çƒ­å‘é‡çš„é‡æ–°è¡¨ç¤ºâ€”â€”åœ¨ä¸­é—´å±‚å‘é‡ç©ºé—´ä¸­ç§»åŠ¨å®ƒä»¬â€”â€”ä»¥ä¾¿(çº¿æ€§)softmaxåˆ†ç±»å™¨å¯ä»¥æ›´å¥½åœ°åˆ†ç±»ã€‚</li></ul></li><li>å³å°†è¯å‘é‡ç†è§£ä¸ºä¸€å±‚ç¥ç»ç½‘ç»œï¼Œè¾“å…¥å•è¯çš„ç‹¬çƒ­å‘é‡å¹¶è·å¾—å•è¯çš„è¯å‘é‡è¡¨ç¤ºï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œæ›´æ–°ã€‚</li></ul><p><span class="math display">\[\nabla_{\theta} J(\theta)=\left[\begin{array}{c}\nabla_{W_{1}} \\\vdots \\\nabla_{W_{\text {dardvark }}} \\\vdots \\\nabla_{x_{z e b r a}}\end{array}\right] \in \mathbb{R}^{C d+V d}\]</span></p><ul><li>å…¶ä¸­ï¼Œ<span class="math inline">\(Vd\)</span>æ˜¯æ•°é‡å¾ˆå¤§çš„å‚æ•°ã€‚</li></ul><h2 id="ç¥ç»è®¡ç®—">1.11 ç¥ç»è®¡ç®—</h2><ul><li>An artificial neuron<ul><li>ç¥ç»ç½‘ç»œæœ‰è‡ªå·±çš„æœ¯è¯­åŒ…</li><li>ä½†å¦‚æœä½ äº†è§£ softmaxæ¨¡å‹æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°ç†è§£ç¥ç»å…ƒçš„æ“ä½œ</li></ul></li><li>Neural computationï¼šç¥ç»è®¡ç®—</li><li>Neural selectivityï¼šç¥ç»é€‰æ‹©æ€§</li><li>Hierarchy of neural processingï¼šç¥ç»å¤„ç†å±‚æ¬¡</li></ul><h2 id="å•ä¸ªç¥ç»å…ƒå¯è§†ä½œäºŒå…ƒé€»è¾‘å›å½’å•å…ƒ">1.12å•ä¸ªç¥ç»å…ƒï¼šå¯è§†ä½œäºŒå…ƒé€»è¾‘å›å½’å•å…ƒ</h2><p><span class="math display">\[h_{w, b}(x)=f\left(w^{T} x+b\right)\]</span></p><p><span class="math display">\[f(z)=\frac{1}{1+e^{-z}}\]</span></p><ul><li><spanclass="math inline">\(b\)</span>ï¼šæˆ‘ä»¬å¯ä»¥æœ‰ä¸€ä¸ªâ€œæ€»æ˜¯æ‰“å¼€â€çš„ç‰¹æ€§ï¼Œå®ƒç»™å‡ºä¸€ä¸ªå…ˆéªŒç±»ï¼Œæˆ–è€…å°†å®ƒä½œä¸ºä¸€ä¸ªåå‘é¡¹åˆ†ç¦»å‡ºæ¥ã€‚</li><li><span class="math inline">\(w\)</span>ï¼Œ<spanclass="math inline">\(b\)</span>æ˜¯ç¥ç»å…ƒçš„å‚æ•°ã€‚</li></ul><h2 id="ä¸€ä¸ªç¥ç»ç½‘ç»œå¤šä¸ªé€»è¾‘å›å½’ç»„åˆ">1.13ä¸€ä¸ªç¥ç»ç½‘ç»œï¼šå¤šä¸ªé€»è¾‘å›å½’ç»„åˆ</h2><ul><li>å¦‚æœæˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå‘é‡é€šè¿‡ä¸€ç³»åˆ—é€»è¾‘å›å½’å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªè¾“å‡ºå‘é‡ã€‚</li><li>ä½†æ˜¯æˆ‘ä»¬ä¸éœ€è¦æå‰å†³å®šè¿™äº›é€»è¾‘å›å½’è¯•å›¾é¢„æµ‹çš„å˜é‡æ˜¯ä»€ä¹ˆã€‚</li></ul><p><img src="/img/nlp/ç¬¬ä¸‰è®²/2.png" /></p><ul><li>æˆ‘ä»¬å¯ä»¥è¾“å…¥å¦ä¸€ä¸ªlogisticå›å½’å‡½æ•°ã€‚</li><li>æŸå¤±å‡½æ•°å°†æŒ‡å¯¼ä¸­é—´éšè—å˜é‡åº”è¯¥æ˜¯ä»€ä¹ˆï¼Œä»¥ä¾¿æ›´å¥½åœ°é¢„æµ‹ä¸‹ä¸€å±‚çš„ç›®æ ‡ã€‚</li></ul><p><img src="/img/nlp/ç¬¬ä¸‰è®²/3.png" /></p><p>æˆ‘ä»¬æ·»åŠ æ›´å¤šå±‚çš„ç¥ç»ç½‘ç»œï¼Œå°±å¾—åˆ°äº†å¤šå±‚æ„ŸçŸ¥å™¨ã€‚</p><p><img src="/img/nlp/ç¬¬ä¸‰è®²/4.png" /></p><h2 id="å•å±‚ç¥ç»ç½‘ç»œçš„çŸ©é˜µå½¢æ€è¡¨ç¤º">1.14 å•å±‚ç¥ç»ç½‘ç»œçš„çŸ©é˜µå½¢æ€è¡¨ç¤º</h2><p>æˆ‘ä»¬æœ‰ï¼š <span class="math display">\[a_{1}=f\left(W_{11} x_{1}+W_{12} x_{2}+W_{13} x_{3}+b_{1}\right)\]</span></p><p><span class="math display">\[a_{2}=f\left(W_{21} x_{1}+W_{22} x_{2}+W_{23} x_{3}+b_{2}\right)\]</span></p><p>åœ¨çŸ©é˜µä¸­ï¼š <span class="math display">\[z=Wx+b\]</span> æ¿€æ´»å‡½æ•°<spanclass="math inline">\(f\)</span>åœ¨è¿ç®—æ—¶æ˜¯element-wiseé€å…ƒç´ çš„ <spanclass="math display">\[f\left(\left[z_{1}, z_{2},z_{3}\right]\right)=\left[f\left(z_{1}\right), f\left(z_{2}\right),f\left(z_{3}\right)\right]\]</span> <img src="/img/nlp/ç¬¬ä¸‰è®²/5.png" /></p><h2 id="éçº¿æ€§å˜æ¢çš„å¿…è¦æ€§">1.15 éçº¿æ€§å˜æ¢çš„å¿…è¦æ€§</h2><ul><li>ä¾‹å¦‚ï¼šå‡½æ•°è¿‘ä¼¼ï¼Œå¦‚å›å½’æˆ–åˆ†ç±»<ul><li>æ²¡æœ‰éçº¿æ€§ï¼Œæ·±åº¦ç¥ç»ç½‘ç»œåªèƒ½åšçº¿æ€§å˜æ¢</li><li>å¤šä¸ªçº¿æ€§å˜æ¢ï¼Œä¹Ÿè¿˜æ˜¯ç»„æˆä¸€ä¸ªçº¿æ€§å˜æ¢<spanclass="math inline">\(W_1W_2x=Wx\)</span></li></ul></li><li>å› ä¸ºçº¿æ€§å˜æ¢æ˜¯ä»¥æŸç§æ–¹å¼æ—‹è½¬å’Œæ‹‰ä¼¸ç©ºé—´ï¼Œå¤šæ¬¡çš„æ—‹è½¬å’Œæ‹‰ä¼¸å¯ä»¥èåˆä¸ºä¸€æ¬¡çº¿æ€§å˜æ¢</li><li>å¯¹äºéçº¿æ€§å‡½æ•°è€Œè¨€ï¼Œä½¿ç”¨æ›´å¤šçš„å±‚ï¼Œä»–ä»¬å¯ä»¥è¿‘ä¼¼æ›´å¤æ‚çš„å‡½æ•°</li></ul><h1 id="å‘½åå®ä½“è¯†åˆ«">2 å‘½åå®ä½“è¯†åˆ«</h1><h2 id="å‘½åå®ä½“è¯†åˆ«ner">2.1 å‘½åå®ä½“è¯†åˆ«(NER)</h2><ul><li>å¯èƒ½çš„ç”¨é€”<ul><li>è·Ÿè¸ªæ–‡æ¡£ä¸­æåˆ°çš„ç‰¹å®šå®ä½“(ç»„ç»‡ã€ä¸ªäººã€åœ°ç‚¹ã€æ­Œæ›²åã€ç”µå½±åç­‰)</li><li>å¯¹äºé—®é¢˜å›ç­”ï¼Œç­”æ¡ˆé€šå¸¸æ˜¯å‘½åå®ä½“</li><li>è®¸å¤šéœ€è¦çš„ä¿¡æ¯å®é™…ä¸Šæ˜¯å‘½åå®ä½“ä¹‹é—´çš„å…³è”</li><li>åŒæ ·çš„æŠ€æœ¯å¯ä»¥æ‰©å±•åˆ°å…¶ä»– slot-filling æ§½å¡«å……åˆ†ç±»</li></ul></li><li>é€šå¸¸åé¢æ˜¯å‘½åå®ä½“é“¾æ¥/è§„èŒƒåŒ–åˆ°çŸ¥è¯†åº“</li></ul><h2 id="å¥å­ä¸­çš„å‘½åå®ä½“è¯†åˆ«">2.2 å¥å­ä¸­çš„å‘½åå®ä½“è¯†åˆ«</h2><p>æˆ‘ä»¬é€šè¿‡åœ¨ä¸Šä¸‹æ–‡ä¸­å¯¹å•è¯è¿›è¡Œåˆ†ç±»ï¼Œç„¶åå°†å®ä½“æå–ä¸ºå•è¯å­åºåˆ—æ¥é¢„æµ‹å®ä½“ã€‚</p><p><img src="/img/nlp/ç¬¬ä¸‰è®²/6.png" /></p><h2 id="nerçš„éš¾ç‚¹">2.3 NERçš„éš¾ç‚¹</h2><ul><li>å¾ˆéš¾è®¡ç®—å‡ºå®ä½“çš„è¾¹ç•Œ<ul><li>ç¬¬ä¸€ä¸ªå®ä½“æ˜¯ â€œFirst National Bankâ€ è¿˜æ˜¯ â€œNational Bankâ€</li></ul></li><li>å¾ˆéš¾çŸ¥é“æŸç‰©æ˜¯å¦æ˜¯ä¸€ä¸ªå®ä½“<ul><li>æ˜¯ä¸€æ‰€åä¸ºâ€œFuture Schoolâ€ çš„å­¦æ ¡ï¼Œè¿˜æ˜¯è¿™æ˜¯ä¸€æ‰€æœªæ¥çš„å­¦æ ¡ï¼Ÿ</li></ul></li><li>å¾ˆéš¾çŸ¥é“æœªçŸ¥/æ–°å¥‡å®ä½“çš„ç±»åˆ«<ul><li>â€œZig Ziglarâ€ ? ä¸€ä¸ªäºº</li></ul></li><li>å®ä½“ç±»æ˜¯æ¨¡ç³Šçš„ï¼Œä¾èµ–äºä¸Šä¸‹æ–‡<ul><li>è¿™é‡Œçš„â€œCharles Schwabâ€ æ˜¯ PER ä¸æ˜¯ ORG</li></ul></li></ul><h1 id="åŸºäºçª—å£æ•°æ®çš„åˆ†ç±»é¢„æµ‹">3.åŸºäºçª—å£æ•°æ®çš„åˆ†ç±»é¢„æµ‹</h1><h2 id="è¯-çª—åˆ†ç±»">3.1. è¯-çª—åˆ†ç±»</h2><ul><li>æ€è·¯ï¼šä¸ºåœ¨ä¸Šä¸‹æ–‡ä¸­çš„è¯­è¨€æ„å»ºåˆ†ç±»å™¨<ul><li>ä¸€èˆ¬æ¥è¯´ï¼Œå¾ˆå°‘å¯¹å•ä¸ªå•è¯è¿›è¡Œåˆ†ç±»</li></ul></li><li>ä¾‹å¦‚ï¼Œä¸Šä¸‹æ–‡ä¸­ä¸€ä¸ªå•è¯çš„å‘½åå®ä½“åˆ†ç±»<ul><li>äººã€åœ°ç‚¹ã€ç»„ç»‡ã€æ²¡æœ‰</li></ul></li><li>åœ¨ä¸Šä¸‹æ–‡ä¸­å¯¹å•è¯è¿›è¡Œåˆ†ç±»çš„ä¸€ä¸ªç®€å•æ–¹æ³•ï¼Œå¯èƒ½æ˜¯å¯¹çª—å£ä¸­çš„å•è¯å‘é‡è¿›è¡Œå¹³å‡ï¼Œå¹¶å¯¹å¹³å‡å‘é‡è¿›è¡Œåˆ†ç±»<ul><li>é—®é¢˜ï¼šè¿™ä¼šä¸¢å¤±ä½ç½®ä¿¡æ¯</li></ul></li></ul><h2 id="çª—å£åˆ†ç±»å™¨softmax">3.2 çª—å£åˆ†ç±»å™¨ï¼šsoftmax</h2><ul><li><p>è®­ç»ƒsoftmaxåˆ†ç±»å™¨å¯¹ä¸­å¿ƒè¯è¿›è¡Œåˆ†ç±»ï¼Œæ–¹æ³•æ˜¯åœ¨ä¸€ä¸ªçª—å£å†…å°†ä¸­å¿ƒè¯å‘¨å›´çš„è¯å‘é‡ä¸²è”èµ·æ¥</p></li><li><p>ä¾‹å­ï¼šåœ¨è¿™å¥è¯çš„ä¸Šä¸‹æ–‡ä¸­å¯¹â€œParisâ€è¿›è¡Œåˆ†ç±»ï¼Œçª—å£é•¿åº¦ä¸º2</p></li><li><p>ç»“æœå‘é‡<span class="math inline">\(x_{w i n d o w}=x \in R^{5d}\)</span>æ˜¯ä¸€ä¸ªåˆ—å‘é‡</p></li></ul><h2 id="æœ€ç®€å•çš„çª—å£åˆ†ç±»å™¨softmax">3.3 æœ€ç®€å•çš„çª—å£åˆ†ç±»å™¨ï¼šSoftmax</h2><p>å¯¹äº<spanclass="math inline">\(x=x_{window}\)</span>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„softmaxåˆ†ç±»å™¨<span class="math display">\[\hat{y}_{y}=p(y \mid x)=\frac{\exp \left(\sqrt{W_{y} \cdotx}\right)}{\sum_{c=1}^{C} \exp \left(W_{c} \cdot x\right)}\]</span> <strong>å¦‚ä½•æ›´æ–°å‘é‡</strong>ï¼Ÿ</p><ul><li>ç®€è€Œè¨€ä¹‹ï¼šå°±åƒä¹‹å‰è®²çš„é‚£æ ·ï¼Œæ±‚å¯¼å’Œä¼˜åŒ–</li></ul><h2 id="ç¨å¾®å¤æ‚ä¸€ç‚¹å¤šå±‚æ„ŸçŸ¥å™¨">3.4 ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼šå¤šå±‚æ„ŸçŸ¥å™¨</h2><ul><li><p>å‡è®¾æˆ‘ä»¬è¦å¯¹ä¸­å¿ƒè¯æ˜¯å¦ä¸ºä¸€ä¸ªåœ°ç‚¹ï¼Œè¿›è¡Œåˆ†ç±»</p></li><li><p>ä¸word2vecç±»ä¼¼ï¼Œæˆ‘ä»¬å°†éå†è¯­æ–™åº“ä¸­çš„æ‰€æœ‰ä½ç½®ã€‚ä½†è¿™ä¸€æ¬¡ï¼Œå®ƒå°†å—åˆ°ç›‘ç£ï¼Œåªæœ‰ä¸€äº›ä½ç½®èƒ½å¤Ÿå¾—åˆ°é«˜åˆ†ã€‚</p><ul><li>ä¾‹å¦‚ï¼Œåœ¨ä»–ä»¬çš„ä¸­å¿ƒæœ‰ä¸€ä¸ªå®é™…çš„NERLocationçš„ä½ç½®æ˜¯â€œçœŸå®çš„â€ä½ç½®ä¼šè·å¾—é«˜åˆ†</li></ul></li></ul><h2 id="ç¥ç»ç½‘ç»œå‰é¦ˆè®¡ç®—">3.5 ç¥ç»ç½‘ç»œå‰é¦ˆè®¡ç®—</h2><p>ä½¿ç”¨ç¥ç»æ¿€æ´»<spanclass="math inline">\(a\)</span>ç®€å•åœ°ç»™å‡ºä¸€ä¸ªéæ ‡å‡†åŒ–çš„åˆ†æ•° <spanclass="math display">\[\operatorname{score}(x)=U^{T} a \in \mathbb{R}\]</span> æˆ‘ä»¬ç”¨ä¸€ä¸ªä¸‰å±‚ç¥ç»ç½‘ç»œè®¡ç®—ä¸€ä¸ªçª—å£çš„å¾—åˆ†</p><ul><li>s = score(â€œmuseums in Paris are amazingâ€)</li></ul><p><img src="/img/nlp/ç¬¬ä¸‰è®²/7.png" /></p><h2 id="é™„åŠ å±‚">3.6 é™„åŠ å±‚</h2><p>ä¸­é—´å±‚å­¦ä¹ è¾“å…¥è¯å‘é‡ä¹‹é—´çš„éçº¿æ€§äº¤äº’</p><p><img src="/img/nlp/ç¬¬ä¸‰è®²/8.png" /></p><p>ä¾‹å¦‚ï¼šåªæœ‰å½“â€œmuseumâ€æ˜¯ç¬¬ä¸€ä¸ªå‘é‡æ—¶ï¼Œâ€œinâ€æ”¾åœ¨ç¬¬äºŒä¸ªä½ç½®æ‰é‡è¦</p><h1 id="åŸºäºpytorchå®ç°çš„åˆ†ç±»å™¨">4.åŸºäºpytorchå®ç°çš„åˆ†ç±»å™¨</h1><h2 id="æ›¿ä»£æœ€å¤§è¾¹ç¼˜æŸå¤±">4.1 æ›¿ä»£ï¼šæœ€å¤§è¾¹ç¼˜æŸå¤±</h2><p>å…³äºè®­ç»ƒç›®æ ‡çš„æƒ³æ³•ï¼šè®©çœŸå®çª—å£çš„å¾—åˆ†æ›´é«˜ï¼Œè€Œå…¶ä»–çª—å£çš„å¾—åˆ†æ›´ä½(ç›´åˆ°è¶³å¤Ÿå¥½ä¸ºæ­¢)</p><ul><li><span class="math inline">\(s = score(museums\ in\ Paris\ are\amazing)\)</span></li><li><span class="math inline">\(s_c = socre(Not\ all\ museums\ in\Paris)\)</span></li></ul><p><strong>æœ€å°åŒ–</strong>ï¼š <span class="math display">\[J=max(0,1-s-s_c)\]</span> è¿™æ˜¯ä¸å¯å¾®çš„ï¼Œä½†å®ƒæ˜¯è¿ç»­çš„ â†’ æˆ‘ä»¬å¯ä»¥ç”¨SGD</p><p><strong>è¡¥å……è§£æ</strong></p><ul><li>å•çª—å£çš„ç›®æ ‡å‡½æ•°ä¸º<spanclass="math inline">\(J=max(0,1-s-s_c)\)</span></li><li>æ¯ä¸ªä¸­å¿ƒæœ‰NERä½ç½®çš„çª—å£çš„å¾—åˆ†åº”è¯¥æ¯”ä¸­å¿ƒæ²¡æœ‰ä½ç½®çš„çª—å£é«˜1åˆ†</li><li>è¦è·å¾—å®Œæ•´çš„ç›®æ ‡å‡½æ•°ï¼šä¸ºæ¯ä¸ªçœŸçª—å£é‡‡æ ·å‡ ä¸ªæŸåçš„çª—å£ã€‚å¯¹æ‰€æœ‰è®­ç»ƒæ ·æœ¬çª—å£æ±‚å’Œ</li><li>ç±»ä¼¼äºword2vecä¸­çš„è´ŸæŠ½æ ·</li></ul><h2 id="éšæœºæ¢¯åº¦ä¸‹é™">4.2 éšæœºæ¢¯åº¦ä¸‹é™</h2>]]></content>
    
    
    <categories>
      
      <category>Deep Learning</category>
      
      <category>NLP</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>NLP-Assignment2</title>
    <link href="/2022/05/06/NLP-Assignment2/"/>
    <url>/2022/05/06/NLP-Assignment2/</url>
    
    <content type="html"><![CDATA[<h1 id="assignment2">Assignment2</h1><h2 id="è§£ç­”ç†è§£è¯å‘é‡23åˆ†">è§£ç­”ï¼šç†è§£è¯å‘é‡ï¼ˆ23åˆ†ï¼‰</h2><p>æˆ‘ä»¬å…ˆå¿«é€Ÿå›é¡¾ä¸€ä¸‹word2vecç®—æ³•ï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯â€œä¸€ä¸ªè¯çš„å«ä¹‰å¯ä»¥ç”±å®ƒå‘¨å›´çš„è¯æ¥è¡¨ç¤ºâ€ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸­å¿ƒè¯ï¼ˆcenterwordï¼‰ <em>c</em>ï¼Œå’Œè¿™ä¸ªè¯ <em>c</em>å‘¨å›´ä¸Šä¸‹æ–‡æ„æˆçš„çª—å£ï¼Œè¿™ä¸ªçª—å£å†…çš„é™¤äº† <em>c</em>ä¹‹å¤–çš„è¯å«åšå¤–å›´è¯ï¼ˆoutsidewordsï¼‰ã€‚æ¯”å¦‚ä¸‹å›¾ä¸­ï¼Œä¸­å¿ƒè¯æ˜¯â€œbankingâ€ï¼Œçª—å£å¤§å°ä¸º2ï¼Œæ‰€ä»¥ä¸Šä¸‹æ–‡çª—å£æ˜¯ï¼šâ€œturningâ€ã€â€intoâ€œã€â€crisesâ€œå’Œâ€asâ€œã€‚</p><p><img src="/img/nlp/assignment2/1.jpg"/></p><p>Skip-gramæ¨¡å‹ï¼ˆword2vecæ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§å®ç°ï¼Œå¦ä¸€ç§æ˜¯cbowï¼‰ç›®çš„æ˜¯å­¦ä¹ æ¦‚ç‡åˆ†å¸ƒ<spanclass="math inline">\(ğ‘ƒ(ğ‘‚|ğ¶)\)</span>ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°±èƒ½è®¡ç®—ç»™å®šçš„ä¸€ä¸ªè¯<span class="math inline">\(o\)</span> å’Œè¯ <spanclass="math inline">\(c\)</span> çš„æ¦‚ç‡ <spanclass="math inline">\(ğ‘ƒ(ğ‘‚=ğ‘œ|ğ¶=ğ‘)\)</span>ï¼ˆå³ï¼Œåœ¨å·²çŸ¥è¯ <spanclass="math inline">\(c\)</span> å‡ºç°çš„æƒ…å†µä¸‹ï¼Œè¯ <spanclass="math inline">\(o\)</span> å‡ºç°çš„æ¦‚ç‡ï¼‰ï¼Œ å…¶ä¸­<spanclass="math inline">\(c\)</span> æ˜¯ä¸­å¿ƒè¯ï¼Œ<spanclass="math inline">\(o\)</span> æ˜¯çª—å£ä¸­éä¸­å¿ƒçš„å¤–å›´è¯ã€‚</p><p>åœ¨word2vecä¸­ï¼Œè¿™ä¸ªæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒæ˜¯é€šè¿‡è®¡ç®—å‘é‡ç‚¹ç§¯ï¼ˆdot-productsï¼‰ï¼Œå†åº”ç”¨naive-softmaxå‡½æ•°å¾—åˆ°çš„ï¼š<span class="math display">\[P(O=o \mid C=c)=\frac{\exp \left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)}{\sum_{w \in \operatorname{Vocab}} \exp\left(\boldsymbol{u}_{w}^{\top} \boldsymbol{v}_{c}\right)}\]</span></p><p>è¿™é‡Œï¼Œ<span class="math inline">\(ğ‘¢_o\)</span>å‘é‡ä»£è¡¨å¤–å›´è¯ï¼Œ<spanclass="math inline">\(v_c\)</span>å‘é‡ä»£è¡¨ä¸­å¿ƒè¯ã€‚ä¸ºäº†åŒ…å«è¿™äº›å‘é‡ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªçŸ©é˜µ<span class="math inline">\(ğ‘ˆ\)</span> å’Œ <spanclass="math inline">\(ğ‘‰\)</span> ã€‚ <spanclass="math inline">\(ğ‘ˆ\)</span> çš„åˆ—æ˜¯å¤–å›´è¯ï¼Œ <spanclass="math inline">\(V\)</span> çš„åˆ—æ˜¯ä¸­å¿ƒè¯ï¼Œè¿™ä¸¤çŸ©é˜µéƒ½æœ‰æ‰€æœ‰è¯<spanclass="math inline">\(w \in Vocabulary\)</span>çš„è¡¨ç¤º ã€‚</p><p>å¯¹äºè¯ <span class="math inline">\(c\)</span> å’Œè¯ <spanclass="math inline">\(o\)</span>ï¼ŒæŸå¤±å‡½æ•°ä¸ºå¯¹æ•°å‡ ç‡ï¼š <spanclass="math display">\[\boldsymbol{J}_{naive-softmax}(v_c, o, \boldsymbol{U}) = -log P(O=o \midC=c)\]</span></p><p>å¯ä»¥ä»äº¤å‰ç†µçš„è§’åº¦çœ‹è¿™ä¸ªæŸå¤±å‡½æ•°ã€‚çœŸå®å€¼ä¸º <spanclass="math inline">\(y\)</span> ï¼Œæ˜¯ä¸€ä¸ªç‹¬çƒ­å‘é‡ï¼Œé¢„æµ‹å€¼ <spanclass="math inline">\(\hat{y}\)</span> è®¡ç®—å¾—åˆ°ã€‚å…·ä½“æ¥è¯´ï¼Œ <spanclass="math inline">\(y\)</span>å¦‚æœæ˜¯ç¬¬kä¸ªå•è¯ï¼Œé‚£ä¹ˆå®ƒçš„ç¬¬kç»´ä¸º1ï¼Œå…¶ä½™ç»´éƒ½æ˜¯0ï¼Œè€Œ <spanclass="math inline">\(\hat{y}\)</span>çš„ç¬¬kç»´è¡¨ç¤ºè¿™æ˜¯ç¬¬kä¸ªè¯çš„æ¦‚ç‡å¤§å°ã€‚</p><h3 id="é—®é¢˜a-3åˆ†">é—®é¢˜(a) (3åˆ†)</h3><p>è¯æ˜å…¬å¼(2)ç»™å‡ºçš„naive-softmaxçš„æŸå¤±å‡½æ•°ï¼Œå’Œ <spanclass="math inline">\(y\)</span> ä¸ <spanclass="math inline">\(\hat{y}\)</span>çš„äº¤å‰ç†µæŸå¤±å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œå‡å¦‚ä¸‹æ‰€ç¤ºï¼ˆç­”æ¡ˆæ§åˆ¶åœ¨ä¸€è¡Œï¼‰</p><p><span class="math display">\[-\sum_{w \in V o c a b} y_{w} \log\left(\hat{y}_{w}\right)=-\log \left(\hat{y}_{o}\right)\]</span></p><p><strong>ç­”ï¼š</strong>å› ä¸ºé™¤äº† <span class="math inline">\(o\)</span>ä¹‹å¤–çš„è¯éƒ½ä¸åœ¨çª—å£å†…ï¼Œæ‰€ä»¥åªæœ‰è¯ <span class="math inline">\(o\)</span>å¯¹æŸå¤±å‡½æ•°æœ‰è´¡çŒ®</p><h3 id="é—®é¢˜b-5åˆ†">é—®é¢˜(b) (5åˆ†)</h3><p>è®¡ç®—æŸå¤±å‡½æ•° <spanclass="math inline">\(\boldsymbol{J}_{naive-softmax}(v_c, o,\boldsymbol{U})\)</span> å¯¹ä¸­å¿ƒè¯ <spanclass="math inline">\(v_c\)</span> çš„åå¯¼æ•°ï¼Œç”¨ <spanclass="math inline">\(y\)</span> ï¼Œ<spanclass="math inline">\(\hat{y}\)</span>å’Œ <spanclass="math inline">\(ğ‘ˆ\)</span> æ¥è¡¨ç¤ºã€‚</p><p><strong>ç­”ï¼š</strong> <span class="math display">\[\begin{aligned}J_{\text {naive-softmax} }\left(\boldsymbol{v}_{c}, o,\boldsymbol{U}\right)&amp;=-\log P(O=o | C=c) \\&amp;= -\log \frac{\exp \left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)}{\sum_{w \in \operatorname{Vocab} } \exp\left(\boldsymbol{u}_{\boldsymbol{w} }^{\top} \boldsymbol{v}_{c}\right)}\\&amp;= - {u}_{o}^{\top}{v}_{c} + \log \sum_{w \in \operatorname{Vocab} }\exp \left(\boldsymbol{u}_{\boldsymbol{w} }^{\top}\boldsymbol{v}_{c}\right)\end{aligned}\]</span></p><p><span class="math display">\[\begin{aligned}\frac{\partial J_{\text {naive-softmax} }\left(\boldsymbol{v}_{c}, o,\boldsymbol{U}\right)}{\partial  v_c}&amp;= -u_o + \sum_{o \in \operatorname{Vocab} }\frac{\exp(u_o^\topv_c)}{\sum_{w \in \operatorname{Vocab} } \exp\left(\boldsymbol{u}_{\boldsymbol{w} }^{\top} \boldsymbol{v}_{c}\right)}\frac{\partial (u_o^\top v_c)}{\partial v_c}\\&amp;=-u_o + \sum_{o \in \operatorname{Vocab} } P(O=o | C=c)  u_o \\&amp;=- U y + U \hat y \\&amp;= U(\hat y - y)\end{aligned}\]</span></p><h3 id="é—®é¢˜c-5åˆ†">é—®é¢˜(c) (5åˆ†)</h3><p>è®¡ç®—æŸå¤±å‡½æ•° <spanclass="math inline">\(\boldsymbol{J}_{naive-softmax}(v_c, o,\boldsymbol{U})\)</span> å¯¹ä¸Šä¸‹æ–‡çª—å£å†…çš„è¯ <spanclass="math inline">\(w\)</span> çš„åå¯¼æ•°ï¼Œè€ƒè™‘ä¸¤ç§æƒ…å†µï¼Œå³ <spanclass="math inline">\(w\)</span> æ˜¯å¤–å›´è¯ <spanclass="math inline">\(o\)</span>ï¼Œå’Œ <spanclass="math inline">\(w\)</span> ä¸æ˜¯ <spanclass="math inline">\(o\)</span>ï¼Œç”¨ <spanclass="math inline">\(y\)</span> ï¼Œ<spanclass="math inline">\(\hat{y}\)</span>å’Œ <spanclass="math inline">\(v_c\)</span> æ¥è¡¨ç¤ºã€‚</p><p><strong>ç­”ï¼š</strong> <span class="math display">\[\begin{aligned}\frac{\partial J_{\text {naive-softmax} }\left(\boldsymbol{v}_{c}, o,\boldsymbol{U}\right)}{\partial  u_w}&amp;= -v_c 1_{\lbrace w=o \rbrace } + \frac{\exp(u_w^\top v_c)}{\sum_{w\in \operatorname{Vocab} } \exp \left(\boldsymbol{u}_{\boldsymbol{w}}^{\top} \boldsymbol{v}_{c}\right)}\frac{\partial (u_w^\top v_c)}{\partial u_w}\\&amp;=-v_c  1_{\lbrace w=o \rbrace } +  P(O=w | C=c)  v_c \\&amp;=v_c( \hat y_w -  y_w)\end{aligned}\]</span></p><h3 id="é—®é¢˜d-3åˆ†">é—®é¢˜(d) (3åˆ†)</h3><p>sigmoidå‡½æ•°å¦‚å…¬å¼æ‰€ç¤º <span class="math display">\[\sigma(\boldsymbol{x})=\frac{1}{1+e^{-\boldsymbol{x}}}=\frac{e^{\boldsymbol{x}}}{e^{\boldsymbol{x}}+1}\]</span> è¯·è®¡ç®—å‡ºå®ƒå¯¹äº <span class="math inline">\(x\)</span> çš„å¯¼æ•°ï¼Œ<span class="math inline">\(x\)</span> æ˜¯ä¸€ä¸ªå‘é‡</p><p><strong>ç­”ï¼š</strong></p><p>è®¡ç®—é›…å…‹æ¯”çŸ©é˜µå¯å¾— <span class="math display">\[\begin{aligned}\frac{\partial \sigma(x_i )}{\partial x_j }&amp;= \sigma (x_i) (1 -\sigma(x_i)) 1_{\lbrace i=j\rbrace  }\end{aligned}\]</span> æ‰€ä»¥æœ‰ <span class="math display">\[\frac{\partial \sigma(x)}{\partial  x}=\text{diag}(\sigma(x) (1- \sigma(x)))\]</span></p><h3 id="é—®é¢˜e-4åˆ†">é—®é¢˜(e) (4åˆ†)</h3><p>ç°åœ¨æˆ‘ä»¬è€ƒè™‘è´Ÿé‡‡æ ·çš„æŸå¤±å‡½æ•°ã€‚å‡è®¾æœ‰Kä¸ªè´Ÿæ ·æœ¬ï¼Œè¡¨ç¤ºä¸º<spanclass="math inline">\(w_1, w_2, â€¦, w_K\)</span>ï¼Œå®ƒä»¬å¯¹åº”çš„å‘é‡ä¸º <spanclass="math inline">\(u_1, u_2, â€¦, u_K\)</span>ï¼Œå¤–å›´è¯ <spanclass="math inline">\(o \not\in {w_1, w_2, â€¦, w_K}\)</span>ï¼Œåˆ™å¤–å›´è¯<span class="math inline">\(o\)</span> åœ¨ä¸­å¿ƒè¯æ˜¯ <spanclass="math inline">\(c\)</span> æ—¶äº§ç”Ÿçš„æŸå¤±å‡½æ•°å¦‚å…¬å¼æ‰€ç¤ºã€‚ <spanclass="math display">\[\boldsymbol{J}_{\text {neg-sample }}\left(\boldsymbol{v}_{c}, o,\boldsymbol{U}\right)=-\log \left(\sigma\left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)\right)-\sum_{k=1}^{K} \log\left(\sigma\left(-\boldsymbol{u}_{k}^{\top}\boldsymbol{v}_{c}\right)\right)\]</span> æ ¹æ®è¯¥æŸå¤±å‡½æ•°ï¼Œé‡æ–°è®¡ç®—é—®é¢˜(b)ã€é—®é¢˜(c)çš„åå¯¼æ•°ï¼Œç”¨ <spanclass="math inline">\(\boldsymbol{u}_o\)</span>ï¼Œ<spanclass="math inline">\(\boldsymbol{v}_c\)</span>ï¼Œ<spanclass="math inline">\(\boldsymbol{u}_k\)</span> æ¥è¡¨ç¤ºã€‚</p><p>å®Œæˆè®¡ç®—åï¼Œç®€è¦è§£é‡Šä¸ºä»€ä¹ˆè¿™ä¸ªæŸå¤±å‡½æ•°æ¯”naive-softmaxæ•ˆç‡æ›´é«˜ã€‚</p><p>æ³¨æ„ï¼šä½ å¯ä»¥ç”¨é—®é¢˜(d)çš„ç­”æ¡ˆæ¥å¸®åŠ©ä½ è®¡ç®—å¯¼æ•°</p><p><strong>ç­”ï¼š</strong> <span class="math display">\[\begin{aligned}\frac{\partial J_{\text {neg-sample} }\left(v_{c}, o,U\right)}{\partial  v_c}&amp;=-\frac{\sigma\left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)\left(1- \sigma\left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)\right)}{\sigma\left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)}u _o-\sum_{k=1}^K\frac{\sigma\left(-\boldsymbol{u}_{k}^{\top}\boldsymbol{v}_{c}\right)\left(1- \sigma\left(-\boldsymbol{u}_{k}^{\top}\boldsymbol{v}_{c}\right)\right)}{\sigma\left(-\boldsymbol{u}_{k}^{\top}\boldsymbol{v}_{c}\right)}(-u_k)\\&amp;= -\left(1- \sigma\left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)\right)u_o+ \sum_{k=1}^K  \left(1- \sigma\left(-\boldsymbol{u}_{k}^{\top}\boldsymbol{v}_{c}\right)\right)u_k\\\frac{\partial J_{\text {neg-sample} }\left(v_{c}, o,U\right)}{\partial  u_o}&amp;=-\frac{\sigma\left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)\left(1- \sigma\left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)\right)}{\sigma\left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)}v _c\\&amp;= -\left(1- \sigma\left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)\right)v_c \\\frac{\partial J_{\text {neg-sample} }\left(v_{c}, o,U\right)}{\partial  u_k}&amp;=-\frac{\sigma\left(-\boldsymbol{u}_{k}^{\top}\boldsymbol{v}_{c}\right)\left(1- \sigma\left(-\boldsymbol{u}_{k}^{\top}\boldsymbol{v}_{c}\right)\right)}{\sigma\left(-\boldsymbol{u}_{k}^{\top}\boldsymbol{v}_{c}\right)}(-v_c)\\&amp;= \left(1- \sigma\left(-\boldsymbol{u}_{k}^{\top}\boldsymbol{v}_{c}\right)\right)v_c\end{aligned}\]</span></p><ul><li><p>åŸå§‹çš„æŸå¤±å‡½æ•°ä¸­éœ€è¦æ±‚æŒ‡æ•°å’Œï¼Œå¾ˆå®¹æ˜“æº¢å‡ºï¼Œè´Ÿé‡‡æ ·çš„æŸå¤±å‡½æ•°èƒ½å¾ˆå¥½åœ°è§„é¿è¿™ä¸ªé—®é¢˜ã€‚</p></li><li><p>è¯åº“ä» ğ‘‰ğ‘œğ‘ğ‘ğ‘ å˜æˆäº†K+1ä¸ªè¯</p></li><li><p>åœ¨æ±‚å†…å±‚å¯¼æ•°çš„æ—¶å€™ç”¨äº†sigmoidå‡½æ•°</p></li></ul><h3 id="é—®é¢˜f-3åˆ†">é—®é¢˜(f) (3åˆ†)</h3><p>å‡è®¾ä¸­å¿ƒè¯æ˜¯ <span class="math inline">\(c =w_t\)</span>ï¼Œä¸Šä¸‹æ–‡çª—å£æ˜¯<span class="math inline">\([w_{t-m}, â€¦,w_{t-1}, w_t, w_{t+1}, â€¦, w_{t+m}]\)</span>ï¼Œ<spanclass="math inline">\(m\)</span>æ˜¯çª—å£å¤§å°ï¼Œå›é¡¾skip-gramçš„word2vecå®ç°ï¼Œåœ¨è¯¥çª—å£ä¸‹çš„æ€»æŸå¤±å‡½æ•°æ˜¯ï¼š<span class="math display">\[\boldsymbol{J}_{\text {skip-gram }}\left(\boldsymbol{v}_{c}, w_{t-m},\ldots w_{t+m}, \boldsymbol{U}\right)=\sum_{-m \leq j \leq m \atop j\neq 0} \boldsymbol{J}\left(\boldsymbol{v}_{c}, w_{t+j},\boldsymbol{U}\right)\]</span> è¿™é‡Œï¼Œ<spanclass="math inline">\(\boldsymbol{J}(\boldsymbol{v}_c, w_{t+j},\boldsymbol{U})\)</span>æ˜¯å¤–å›´è¯æ˜¯å¤–å›´è¯<spanclass="math inline">\(w_{t+j}\)</span>åœ¨ä¸­å¿ƒè¯åœ¨ä¸­å¿ƒè¯<spanclass="math inline">\(c=w_t\)</span>ä¸‹äº§ç”Ÿçš„æŸå¤±ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥æ˜¯naive-softmaxæˆ–è€…æ˜¯neg-sampleï¼ˆè´Ÿé‡‡æ ·ï¼‰ï¼Œè¿™å–å†³äºå…·ä½“å®ç°ã€‚</p><p>è®¡ç®—ï¼š</p><ol type="i"><li><p>æŸå¤±å‡½æ•°å¯¹ <span class="math inline">\(U\)</span>çš„åå¯¼æ•°</p></li><li><p>æŸå¤±å‡½æ•°å¯¹ <span class="math inline">\(\boldsymbol{v}_c\)</span>çš„åå¯¼æ•°</p></li><li><p>æŸå¤±å‡½æ•°å¯¹ <span class="math inline">\(\boldsymbol{v}_w\)</span>çš„åå¯¼æ•°</p></li></ol><strong>ç­”ï¼š</strong> $$<span class="math display">\[\begin{aligned}\partial \boldsymbol{J}_{\text {skip-gram } }\left(\boldsymbol{v}_{c},w_{t-m}, \dots w_{t+m}, \boldsymbol{U}\right) / \partial \boldsymbol{U}&amp;=\sum_{-m \leq j \leq m \atop j \neq 0} \partial\boldsymbol{J}\left(\boldsymbol{v}_{c}, w_{t+j}, \boldsymbol{U}\right) /\partial \boldsymbol{U} \\\partial \boldsymbol{J}_{\text {skip-gram } }\left(\boldsymbol{v}_{c},w_{t-m}, \dots w_{t+m}, \boldsymbol{U}\right) / \partial\boldsymbol{v_c}&amp;=\sum_{-m \leq j \leq m \atop j \neq 0} \partial\boldsymbol{J}\left(\boldsymbol{v}_{c}, w_{t+j}, \boldsymbol{U}\right) /\partial  \boldsymbol{v_c} \\\partial \boldsymbol{J}_{\text {skip-gram } }\left(\boldsymbol{v}_{c},w_{t-m}, \dots w_{t+m}, \boldsymbol{U}\right) / \partial\boldsymbol{v_w}&amp;=\sum_{-m \leq j \leq m \atop j \neq 0} \partial\boldsymbol{J}\left(\boldsymbol{v}_{c}, w_{t+j}, \boldsymbol{U}\right) /\partial  \boldsymbol{v_w} \\\end{aligned}\]</span><p>$$</p><h2 id="ä»£ç å®ç°word2vec20åˆ†">ä»£ç ï¼šå®ç°word2vecï¼ˆ20åˆ†ï¼‰</h2><p>ç‚¹å‡» <ahref="http://web.stanford.edu/class/cs224n/assignments/a2.zip">æ­¤å¤„</a>ä¸‹è½½ä»£ç ï¼Œpythonç‰ˆæœ¬ &gt;=3.5ï¼Œéœ€è¦å®‰è£…numpyï¼Œä½ åˆ©ç”¨condaæ¥é…ç½®ç¯å¢ƒï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">conda env create -f env.yml<br>conda activate a2<br></code></pre></div></td></tr></table></figure><p>å†™å®Œä»£ç åï¼Œè¿è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">conda deactivate<br></code></pre></div></td></tr></table></figure><h3 id="é—®é¢˜a-12åˆ†">é—®é¢˜(a) (12åˆ†)</h3><p>é¦–å…ˆï¼Œå®ç° word2vec.py é‡Œçš„sigmoidå‡½æ•°ï¼Œè¦æ”¯æŒå‘é‡è¾“å…¥ã€‚æ¥ç€å®ç°åŒä¸€ä¸ªæ–‡ä»¶é‡Œçš„ softmaxã€è´Ÿé‡‡æ ·æŸå¤±å’Œå¯¼æ•°ã€‚ç„¶åå®ç°skip-gramçš„æŸå¤±å‡½æ•°å’Œå¯¼æ•°ã€‚å…¨éƒ¨åšå®Œä¹‹åï¼Œè¿è¡Œpythonword2vec.pyæ¥æ£€æŸ¥æ˜¯å¦æ­£ç¡®ã€‚</p><p><strong>ç­”ï¼š</strong></p><h4 id="sigmoid">sigmoid</h4><p>numpyå…·å¤‡å¹¿æ’­ç‰¹æ€§ï¼Œæœ€ç»ˆå¾—åˆ°å‘é‡è¾“å‡º</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Compute the sigmoid function for the input here.</span><br><span class="hljs-string">    Arguments:</span><br><span class="hljs-string">    x -- A scalar or numpy array.</span><br><span class="hljs-string">    Return:</span><br><span class="hljs-string">    s -- sigmoid(x)</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    <span class="hljs-comment">### YOUR CODE HERE</span><br>    s = <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-x))<br><br>    <span class="hljs-comment">### END YOUR CODE</span><br><br>    <span class="hljs-keyword">return</span> s<br></code></pre></div></td></tr></table></figure><h4 id="naivesoftmaxlossandgradient">naiveSoftmaxLossAndGradient</h4><p>è¿™ä¸ªæ¨¡å‹å…¶å®å°±æ˜¯ä¸€ä¸ªä¸‰å±‚çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼Œåªéœ€è¦æ³¨æ„ç»´åº¦å³å¯ï¼Œæ³¨é‡Šé‡Œå·²ç»æ ‡è®°å‡ºäº†ç»´åº¦ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå•è¯è¡¨ç¤ºæ˜¯åœ¨è¡Œï¼Œè€Œä¸æ˜¯åˆ—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">### YOUR CODE HERE</span><br><br><span class="hljs-comment">### Please use the provided softmax function (imported earlier in this file)</span><br><span class="hljs-comment">### This numerically stable implementation helps you avoid issues pertaining</span><br><span class="hljs-comment">### to integer overflow. </span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    centerWordVec: 1 * d</span><br><span class="hljs-string">    outsideVectors: n * d</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><span class="hljs-comment">#1 * n</span><br>vec = centerWordVec.dot(outsideVectors.T)<br><span class="hljs-comment">#1 * n</span><br>prob = softmax(vec)<br>loss = -np.log(prob[outsideWordIdx])<br><span class="hljs-comment">#1 * d</span><br>gradCenterVec = -outsideVectors[outsideWordIdx] + prob.dot(outsideVectors)<br><span class="hljs-comment">#n * d</span><br>gradOutsideVecs = prob.reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).dot(centerWordVec.reshape(<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>))<br><span class="hljs-comment">#n * d</span><br>gradOutsideVecs[outsideWordIdx] -= centerWordVec<br><span class="hljs-comment">### END YOUR CODE</span><br></code></pre></div></td></tr></table></figure><h4 id="negsamplinglossandgradient">negSamplingLossAndGradient</h4><p>ä¸native-softmaxä¸åŒçš„æ˜¯ï¼š</p><ul><li>åªé€‰å–Kä¸ªéå¤–å›´è¯ä½œä¸ºè´Ÿæ ·æœ¬ï¼ŒåŠ ä¸Š1ä¸ªæ­£ç¡®çš„å¤–å›´è¯ï¼Œå…±K+1ä¸ªè¾“å‡º</li><li>æœ€åä¸€å±‚ä½¿ç”¨sigmoidè¾“å‡ºï¼Œè€Œä¸æ˜¯softmax</li></ul><p>æ³¨æ„ï¼Œåå‘ä¼ æ’­å¾—åˆ°çš„æ˜¯è¿™K+1ä¸ªè¯çš„æ¢¯åº¦ï¼Œæ‰€ä»¥éœ€è¦æŒ¨ä¸ªæ›´æ–°åˆ°<em>æ¢¯åº¦çŸ©é˜µ</em> ä¸­å»</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">### Please use your implementation of sigmoid in here.</span><br><br><span class="hljs-comment"># indices might have same index</span><br><span class="hljs-comment"># extract W</span><br>W = np.zeros((<span class="hljs-built_in">len</span>(indices), outsideVectors.shape[<span class="hljs-number">1</span>]))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(indices)):<br>    W[i] = outsideVectors[indices[i]]<br><br><span class="hljs-comment"># forward</span><br>a = centerWordVec<br>a = a.reshape((a.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>))<br><br>z = np.dot(W, a) <span class="hljs-comment"># (K+1, 1)</span><br>preds = sigmoid(z)<br><br><span class="hljs-comment"># backprop</span><br>y = np.zeros((preds.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>))<br>y[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span> <span class="hljs-comment"># index 0 is target</span><br><br>loss = -(y*np.log(preds) + (<span class="hljs-number">1</span> - y)*np.log(<span class="hljs-number">1</span> - preds)).<span class="hljs-built_in">sum</span>()<br><br>delta = preds - y<br>gradCenterVec = np.dot(W.T, delta) <span class="hljs-comment"># (V, 1)</span><br>gradW = np.dot(delta, a.T) <span class="hljs-comment"># (K+1, V)</span><br>gradCenterVec = gradCenterVec.flatten()<br><br><span class="hljs-comment"># apply gradW into gradOutsideVecs</span><br>gradOutsideVecs = np.zeros_like(outsideVectors)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(indices)):<br>    oi = indices[i]<br>    gradOutsideVecs[oi] += gradW[i]<br></code></pre></div></td></tr></table></figure><h4 id="skipgram">skipgram</h4><p>éå†æ‰€æœ‰çš„å¤–å›´è¯ï¼Œæ±‚å’ŒæŸå¤±å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">ci = word2Ind[currentCenterWord]<br>vc = centerWordVectors[ci]<br><br><span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> outsideWords:<br>    oi = word2Ind[o]<br>    loss_, gradVc, gradUo = word2vecLossAndGradient(vc, oi, outsideVectors, dataset)<br>    gradCenterVecs[ci] += gradVc<br>    gradOutsideVectors += gradUo<br>    loss += loss_<br></code></pre></div></td></tr></table></figure><h3 id="é—®é¢˜b-4åˆ†">é—®é¢˜(b) (4åˆ†)</h3><p>å®Œæˆsgd.pyæ–‡ä»¶çš„SGDä¼˜åŒ–å™¨ï¼Œè¿è¡Œpython sgd.pyæ¥æ£€æŸ¥æ˜¯å¦æ­£ç¡®ã€‚</p><p><strong>ç­”</strong>ï¼š</p><h4 id="sgd">sgd</h4><p>è°ƒç”¨å‡½æ•°å¾—åˆ°æŸå¤±å€¼å’Œæ¢¯åº¦ï¼Œæ›´æ–°å³å¯</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment">### YOUR CODE HERE</span><br>loss, grad = f(x)<br>x -= step * grad<br><br><span class="hljs-comment">### END YOUR CODE</span><br></code></pre></div></td></tr></table></figure><h3 id="é—®é¢˜c-4åˆ†">é—®é¢˜(c) (4åˆ†)</h3><p>è‡³æ­¤æ‰€æœ‰çš„ä»£ç éƒ½å†™å®Œäº†ï¼Œæ¥ä¸‹æ¥æ˜¯ä¸‹è½½æ•°æ®é›†ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨StanformSentimentTreebank(SST)æ•°æ®é›†ï¼Œå®ƒå¯ä»¥ç”¨åœ¨ç®€å•çš„è¯­ä¹‰åˆ†æä»»åŠ¡ä¸­å»ã€‚é€šè¿‡è¿è¡Œ shget_datasets.sh å¯ä»¥è·å¾—è¯¥æ•°æ®é›†ï¼Œä¸‹è½½å®Œæˆåè¿è¡Œ python run.pyå³å¯ã€‚</p><p>æ³¨æ„ï¼šè®­ç»ƒçš„æ—¶é—´å–å†³äºä»£ç æ˜¯å¦é«˜æ•ˆï¼ˆå³ä¾¿æ˜¯é«˜æ•ˆçš„å®ç°ï¼Œä¹Ÿè¦è·‘æ¥è¿‘ä¸€ä¸ªå°æ—¶ï¼‰</p><p>ç»è¿‡40,000æ¬¡è¿­ä»£åï¼Œæœ€ç»ˆç»“æœä¼šä¿å­˜åˆ° word_vectors.png é‡Œã€‚</p><p><strong>ç­”ï¼š</strong></p><p><img src="http://ww1.sinaimg.cn/large/0060yMmAly1gsz2rwoc9sj30hs0dc3zy.jpg" referrerpolicy="no-referrer" /></p><ul><li>åœ¨ä¸Šå›¾ä¸­å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œmale-&gt;famale å’Œ king -&gt; queenè¿™ä¸¤æ¡å‘é‡æ˜¯å¹³è¡Œçš„</li><li>(women, famale)ï¼Œ(enjoyable,annoying) è¿™äº›å«ä¹‰æ¥è¿‘çš„è¯è·ç¦»å¾ˆè¿‘</li></ul>]]></content>
    
    
    <categories>
      
      <category>Deep Learning</category>
      
      <category>NLP</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>NLP-Assignment1</title>
    <link href="/2022/05/05/NLP-Assignment1/"/>
    <url>/2022/05/05/NLP-Assignment1/</url>
    
    <content type="html"><![CDATA[<h1 id="assignment1">Assignment1</h1><p>æ‰€æœ‰ä½¿ç”¨åˆ°çš„å¤´æ–‡ä»¶å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># All Import Statements Defined Here</span><br><span class="hljs-comment"># Note: Do not add to this list.</span><br><span class="hljs-comment"># ----------------</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">assert</span> sys.version_info[<span class="hljs-number">0</span>]==<span class="hljs-number">3</span><br><span class="hljs-keyword">assert</span> sys.version_info[<span class="hljs-number">1</span>] &gt;= <span class="hljs-number">5</span><br><br><span class="hljs-keyword">from</span> gensim.models <span class="hljs-keyword">import</span> KeyedVectors<br><span class="hljs-keyword">from</span> gensim.test.utils <span class="hljs-keyword">import</span> datapath<br><span class="hljs-keyword">import</span> pprint<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br>plt.rcParams[<span class="hljs-string">&#x27;figure.figsize&#x27;</span>] = [<span class="hljs-number">10</span>, <span class="hljs-number">5</span>]<br><span class="hljs-keyword">import</span> nltk<br>nltk.download(<span class="hljs-string">&#x27;reuters&#x27;</span>)<br><span class="hljs-keyword">from</span> nltk.corpus <span class="hljs-keyword">import</span> reuters<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> scipy <span class="hljs-keyword">as</span> sp<br><span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> TruncatedSVD<br><span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> PCA<br><br>START_TOKEN = <span class="hljs-string">&#x27;&lt;START&gt;&#x27;</span><br>END_TOKEN = <span class="hljs-string">&#x27;&lt;END&gt;&#x27;</span><br><br>np.random.seed(<span class="hljs-number">0</span>)<br>random.seed(<span class="hljs-number">0</span>)<br><span class="hljs-comment"># ----------------</span><br></code></pre></div></td></tr></table></figure><h2 id="part-1åŸºäºè®¡æ•°çš„è¯å‘é‡">Part 1ï¼šåŸºäºè®¡æ•°çš„è¯å‘é‡</h2><p>å¤§å¤šæ•°è¯å‘é‡æ¨¡å‹éƒ½æ˜¯åŸºäºä¸€ä¸ªè§‚ç‚¹ï¼š</p><p><strong>You shall know a word by the company it keeps (<ahref="https://en.wikipedia.org/wiki/John_Rupert_Firth">Firth, J. R.1957:11</a>)</strong></p><p>å¤§å¤šæ•°è¯å‘é‡çš„å®ç°çš„æ ¸å¿ƒæ˜¯ <em>ç›¸ä¼¼è¯</em>ï¼Œä¹Ÿå°±æ˜¯åŒä¹‰è¯ï¼Œå› ä¸ºå®ƒä»¬æœ‰ç›¸ä¼¼çš„ä¸Šä¸‹æ–‡ã€‚è¿™é‡Œæˆ‘ä»¬ä»‹ç»ä¸€ç§ç­–ç•¥å«åš<em>å…±ç°çŸ©é˜µ</em> (æ›´å¤šä¿¡æ¯å¯ä»¥æŸ¥çœ‹ <ahref="http://web.stanford.edu/class/cs124/lec/vectorsemantics.video.pdf">è¿™é‡Œ</a>æˆ– <ahref="https://medium.com/data-science-group-iitr/word-embedding-2d05d270b285">è¿™é‡Œ</a>)</p><p>è¿™éƒ¨åˆ†è¦å®ç°çš„æ˜¯ï¼Œç»™å®šè¯­æ–™åº“ï¼Œæ ¹æ®å…±ç°çŸ©é˜µè®¡ç®—è¯å‘é‡ï¼Œå¾—åˆ°è¯­æ–™åº“ä¸­æ¯ä¸ªè¯çš„è¯å‘é‡ï¼Œæµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>è®¡ç®—è¯­æ–™åº“çš„å•è¯é›†</li><li>è®¡ç®—å…±ç°çŸ©é˜µ</li><li>ä½¿ç”¨SVDé™ç»´</li><li>åˆ†æè¯å‘é‡</li></ul><h3 id="é—®é¢˜1.1å®ç°-dicintct_words">é—®é¢˜1.1ï¼šå®ç° dicintct_words</h3><p>è®¡ç®—è¯­æ–™åº“çš„å•è¯æ•°é‡ã€å•è¯é›†</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">distinct_words</span>(<span class="hljs-params">corpus</span>):<br>    <span class="hljs-string">&quot;&quot;&quot; Determine a list of distinct words for the corpus.</span><br><span class="hljs-string">        Params:</span><br><span class="hljs-string">            corpus (list of list of strings): corpus of documents</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            corpus_words (list of strings): list of distinct words across the corpus, sorted (using python &#x27;sorted&#x27; function)</span><br><span class="hljs-string">            num_corpus_words (integer): number of distinct words across the corpus</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    corpus_words = []<br>    num_corpus_words = -<span class="hljs-number">1</span><br>    <br>    <span class="hljs-comment"># ------------------</span><br>    <span class="hljs-comment"># Write your implementation here.</span><br>    corpus_words =  <span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">list</span>(<span class="hljs-built_in">set</span>([word <span class="hljs-keyword">for</span> sentence <span class="hljs-keyword">in</span> corpus <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> sentence])))<br>    num_corpus_words = <span class="hljs-built_in">len</span>(corpus_words)<br><br>    <span class="hljs-comment"># ------------------</span><br><br>    <span class="hljs-keyword">return</span> corpus_words, num_corpus_words<br></code></pre></div></td></tr></table></figure><p>æµ‹è¯•ç”¨ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># ---------------------</span><br><span class="hljs-comment"># Run this sanity check</span><br><span class="hljs-comment"># Note that this not an exhaustive check for correctness.</span><br><span class="hljs-comment"># ---------------------</span><br><br><span class="hljs-comment"># Define toy corpus</span><br>test_corpus = [<span class="hljs-string">&quot;&#123;&#125; All that glitters isn&#x27;t gold &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(START_TOKEN, END_TOKEN).split(<span class="hljs-string">&quot; &quot;</span>), <span class="hljs-string">&quot;&#123;&#125; All&#x27;s well that ends well &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(START_TOKEN, END_TOKEN).split(<span class="hljs-string">&quot; &quot;</span>)]<br>test_corpus_words, num_corpus_words = distinct_words(test_corpus)<br><br><span class="hljs-comment"># Correct answers</span><br>ans_test_corpus_words = <span class="hljs-built_in">sorted</span>([START_TOKEN, <span class="hljs-string">&quot;All&quot;</span>, <span class="hljs-string">&quot;ends&quot;</span>, <span class="hljs-string">&quot;that&quot;</span>, <span class="hljs-string">&quot;gold&quot;</span>, <span class="hljs-string">&quot;All&#x27;s&quot;</span>, <span class="hljs-string">&quot;glitters&quot;</span>, <span class="hljs-string">&quot;isn&#x27;t&quot;</span>, <span class="hljs-string">&quot;well&quot;</span>, END_TOKEN])<br>ans_num_corpus_words = <span class="hljs-built_in">len</span>(ans_test_corpus_words)<br><br><span class="hljs-comment"># Test correct number of words</span><br><span class="hljs-keyword">assert</span>(num_corpus_words == ans_num_corpus_words), <span class="hljs-string">&quot;Incorrect number of distinct words. Correct: &#123;&#125;. Yours: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(ans_num_corpus_words, num_corpus_words)<br><br><span class="hljs-comment"># Test correct words</span><br><span class="hljs-keyword">assert</span> (test_corpus_words == ans_test_corpus_words), <span class="hljs-string">&quot;Incorrect corpus_words.\nCorrect: &#123;&#125;\nYours:   &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">str</span>(ans_test_corpus_words), <span class="hljs-built_in">str</span>(test_corpus_words))<br><br><span class="hljs-comment"># Print Success</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">80</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Passed All Tests!&quot;</span>)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">80</span>)<br></code></pre></div></td></tr></table></figure><h3id="é—®é¢˜1.2å®ç°compute_co_occurrence_matrix">é—®é¢˜1.2ï¼šå®ç°compute_co_occurrence_matrix</h3><p>è®¡ç®—ç»™å®šè¯­æ–™åº“çš„å…±ç°çŸ©é˜µã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºæ¯ä¸€ä¸ªè¯<code>w</code>ï¼Œç»Ÿè®¡å‰ã€åæ–¹ <code>window_size</code> ä¸ªè¯çš„å‡ºç°æ¬¡æ•°</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_co_occurrence_matrix</span>(<span class="hljs-params">corpus, window_size=<span class="hljs-number">4</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot; Compute co-occurrence matrix for the given corpus and window_size (default of 4).</span><br><span class="hljs-string">    </span><br><span class="hljs-string">        Note: Each word in a document should be at the center of a window. Words near edges will have a smaller</span><br><span class="hljs-string">              number of co-occurring words.</span><br><span class="hljs-string">              </span><br><span class="hljs-string">              For example, if we take the document &quot;START All that glitters is not gold END&quot; with window size of 4,</span><br><span class="hljs-string">              &quot;All&quot; will co-occur with &quot;START&quot;, &quot;that&quot;, &quot;glitters&quot;, &quot;is&quot;, and &quot;not&quot;.</span><br><span class="hljs-string">    </span><br><span class="hljs-string">        Params:</span><br><span class="hljs-string">            corpus (list of list of strings): corpus of documents</span><br><span class="hljs-string">            window_size (int): size of context window</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            M (numpy matrix of shape (number of corpus words, number of corpus words)): </span><br><span class="hljs-string">                Co-occurence matrix of word counts. </span><br><span class="hljs-string">                The ordering of the words in the rows/columns should be the same as the ordering of the words given by the distinct_words function.</span><br><span class="hljs-string">            word2Ind (dict): dictionary that maps word to index (i.e. row/column number) for matrix M.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    words, num_words = distinct_words(corpus)<br>    M = np.zeros((num_words, num_words))<br>    word2Ind = <span class="hljs-built_in">dict</span>([(word, index) <span class="hljs-keyword">for</span> index, word <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(words)])<br>    <br>    <span class="hljs-comment"># ------------------</span><br>    <span class="hljs-comment"># Write your implementation here.</span><br>    <span class="hljs-keyword">for</span> sentence <span class="hljs-keyword">in</span> corpus:<br>        current_index = <span class="hljs-number">0</span><br>        sentence_len = <span class="hljs-built_in">len</span>(sentence)<br>        indices = [word2Ind[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> sentence]<br>        <span class="hljs-keyword">while</span> current_index &lt; sentence_len:<br>            left  = <span class="hljs-built_in">max</span>(current_index - window_size, <span class="hljs-number">0</span>)<br>            right = <span class="hljs-built_in">min</span>(current_index + window_size + <span class="hljs-number">1</span>, sentence_len) <br>            current_word = sentence[current_index]<br>            current_word_index = word2Ind[current_word]<br>            words_around = indices[left:current_index] + indices[current_index+<span class="hljs-number">1</span>:right]<br>            <br>            <span class="hljs-keyword">for</span> ind <span class="hljs-keyword">in</span> words_around:<br>                M[current_word_index, ind] += <span class="hljs-number">1</span><br>            <br>            current_index += <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># ------------------</span><br><br>    <span class="hljs-keyword">return</span> M, word2Ind<br></code></pre></div></td></tr></table></figure><p>æµ‹è¯•ç”¨ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># ---------------------</span><br><span class="hljs-comment"># Run this sanity check</span><br><span class="hljs-comment"># Note that this is not an exhaustive check for correctness.</span><br><span class="hljs-comment"># ---------------------</span><br><br><span class="hljs-comment"># Define toy corpus and get student&#x27;s co-occurrence matrix</span><br>test_corpus = [<span class="hljs-string">&quot;&#123;&#125; All that glitters isn&#x27;t gold &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(START_TOKEN, END_TOKEN).split(<span class="hljs-string">&quot; &quot;</span>), <span class="hljs-string">&quot;&#123;&#125; All&#x27;s well that ends well &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(START_TOKEN, END_TOKEN).split(<span class="hljs-string">&quot; &quot;</span>)]<br>M_test, word2ind_test = compute_co_occurrence_matrix(test_corpus, window_size=<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># Correct M and word2ind</span><br>M_test_ans = np.array( <br>    [[<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>,],<br>     [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,],<br>     [<span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>,],<br>     [<span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>,],<br>     [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>,],<br>     [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>,],<br>     [<span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,],<br>     [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>,],<br>     [<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>,],<br>     [<span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>,]]<br>)<br>ans_test_corpus_words = <span class="hljs-built_in">sorted</span>([START_TOKEN, <span class="hljs-string">&quot;All&quot;</span>, <span class="hljs-string">&quot;ends&quot;</span>, <span class="hljs-string">&quot;that&quot;</span>, <span class="hljs-string">&quot;gold&quot;</span>, <span class="hljs-string">&quot;All&#x27;s&quot;</span>, <span class="hljs-string">&quot;glitters&quot;</span>, <span class="hljs-string">&quot;isn&#x27;t&quot;</span>, <span class="hljs-string">&quot;well&quot;</span>, END_TOKEN])<br>word2ind_ans = <span class="hljs-built_in">dict</span>(<span class="hljs-built_in">zip</span>(ans_test_corpus_words, <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ans_test_corpus_words))))<br><br><span class="hljs-comment"># Test correct word2ind</span><br><span class="hljs-keyword">assert</span> (word2ind_ans == word2ind_test), <span class="hljs-string">&quot;Your word2ind is incorrect:\nCorrect: &#123;&#125;\nYours: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(word2ind_ans, word2ind_test)<br><br><span class="hljs-comment"># Test correct M shape</span><br><span class="hljs-keyword">assert</span> (M_test.shape == M_test_ans.shape), <span class="hljs-string">&quot;M matrix has incorrect shape.\nCorrect: &#123;&#125;\nYours: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(M_test.shape, M_test_ans.shape)<br><br><span class="hljs-comment"># Test correct M values</span><br><span class="hljs-keyword">for</span> w1 <span class="hljs-keyword">in</span> word2ind_ans.keys():<br>    idx1 = word2ind_ans[w1]<br>    <span class="hljs-keyword">for</span> w2 <span class="hljs-keyword">in</span> word2ind_ans.keys():<br>        idx2 = word2ind_ans[w2]<br>        student = M_test[idx1, idx2]<br>        correct = M_test_ans[idx1, idx2]<br>        <span class="hljs-keyword">if</span> student != correct:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct M:&quot;</span>)<br>            <span class="hljs-built_in">print</span>(M_test_ans)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Your M: &quot;</span>)<br>            <span class="hljs-built_in">print</span>(M_test)<br>            <span class="hljs-keyword">raise</span> AssertionError(<span class="hljs-string">&quot;Incorrect count at index (&#123;&#125;, &#123;&#125;)=(&#123;&#125;, &#123;&#125;) in matrix M. Yours has &#123;&#125; but should have &#123;&#125;.&quot;</span>.<span class="hljs-built_in">format</span>(idx1, idx2, w1, w2, student, correct))<br><br><span class="hljs-comment"># Print Success</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">80</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Passed All Tests!&quot;</span>)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">80</span>)<br></code></pre></div></td></tr></table></figure><h3 id="é—®é¢˜1.3å®ç°-reduce_to_k_dim">é—®é¢˜1.3ï¼šå®ç° reduce_to_k_dim</h3><p>è¿™ä¸€æ­¥æ˜¯é™ç»´ã€‚åœ¨é—®é¢˜1.2å¾—åˆ°çš„æ˜¯ä¸€ä¸ªN xNçš„çŸ©é˜µï¼ˆNæ˜¯å•è¯é›†çš„å¤§å°ï¼‰ï¼Œä½¿ç”¨scikit-learnå®ç°çš„SVDï¼ˆå¥‡å¼‚å€¼åˆ†è§£ï¼‰ï¼Œä»è¿™ä¸ªå¤§çŸ©é˜µé‡Œåˆ†è§£å‡ºä¸€ä¸ªå«kä¸ªç‰¹åˆ¶çš„Nx k å°çŸ©é˜µã€‚</p><p><strong>æ³¨æ„</strong>ï¼šåœ¨numpyã€scipyå’Œscikit-learnéƒ½æä¾›äº†ä¸€äº›SVDçš„å®ç°ï¼Œä½†æ˜¯åªæœ‰scipyã€sklearnæœ‰TruncatedSVDï¼Œå¹¶ä¸”åªæœ‰sklearnæä¾›äº†è®¡ç®—å¤§è§„æ¨¡SVDçš„é«˜æ•ˆçš„randomizedç®—æ³•ï¼Œè¯¦æƒ…å‚è€ƒ<ahref="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.TruncatedSVD.html">sklearn.decomposition.TruncatedSVD</a>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">reduce_to_k_dim</span>(<span class="hljs-params">M, k=<span class="hljs-number">2</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot; Reduce a co-occurence count matrix of dimensionality (num_corpus_words, num_corpus_words)</span><br><span class="hljs-string">        to a matrix of dimensionality (num_corpus_words, k) using the following SVD function from Scikit-Learn:</span><br><span class="hljs-string">            - http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.TruncatedSVD.html</span><br><span class="hljs-string">    </span><br><span class="hljs-string">        Params:</span><br><span class="hljs-string">            M (numpy matrix of shape (number of corpus words, number of corpus words)): co-occurence matrix of word counts</span><br><span class="hljs-string">            k (int): embedding size of each word after dimension reduction</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            M_reduced (numpy matrix of shape (number of corpus words, k)): matrix of k-dimensioal word embeddings.</span><br><span class="hljs-string">                    In terms of the SVD from math class, this actually returns U * S</span><br><span class="hljs-string">    &quot;&quot;&quot;</span>    <br>    n_iters = <span class="hljs-number">10</span>     <span class="hljs-comment"># Use this parameter in your call to `TruncatedSVD`</span><br>    M_reduced = <span class="hljs-literal">None</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Running Truncated SVD over %i words...&quot;</span> % (M.shape[<span class="hljs-number">0</span>]))<br>    <br>    <span class="hljs-comment"># ------------------</span><br>    <span class="hljs-comment"># Write your implementation here.</span><br>    TSVD = TruncatedSVD(n_components=k, n_iter=n_iters)<br>    M_reduced = TSVD.fit_transform(M)<br><br>    <span class="hljs-comment"># ------------------</span><br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Done.&quot;</span>)<br>    <span class="hljs-keyword">return</span> M_reduced<br></code></pre></div></td></tr></table></figure><p>æµ‹è¯•ç”¨ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># ---------------------</span><br><span class="hljs-comment"># Run this sanity check</span><br><span class="hljs-comment"># Note that this is not an exhaustive check for correctness </span><br><span class="hljs-comment"># In fact we only check that your M_reduced has the right dimensions.</span><br><span class="hljs-comment"># ---------------------</span><br><br><span class="hljs-comment"># Define toy corpus and run student code</span><br>test_corpus = [<span class="hljs-string">&quot;&#123;&#125; All that glitters isn&#x27;t gold &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(START_TOKEN, END_TOKEN).split(<span class="hljs-string">&quot; &quot;</span>), <span class="hljs-string">&quot;&#123;&#125; All&#x27;s well that ends well &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(START_TOKEN, END_TOKEN).split(<span class="hljs-string">&quot; &quot;</span>)]<br>M_test, word2ind_test = compute_co_occurrence_matrix(test_corpus, window_size=<span class="hljs-number">1</span>)<br>M_test_reduced = reduce_to_k_dim(M_test, k=<span class="hljs-number">2</span>)<br><br><span class="hljs-comment"># Test proper dimensions</span><br><span class="hljs-keyword">assert</span> (M_test_reduced.shape[<span class="hljs-number">0</span>] == <span class="hljs-number">10</span>), <span class="hljs-string">&quot;M_reduced has &#123;&#125; rows; should have &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(M_test_reduced.shape[<span class="hljs-number">0</span>], <span class="hljs-number">10</span>)<br><span class="hljs-keyword">assert</span> (M_test_reduced.shape[<span class="hljs-number">1</span>] == <span class="hljs-number">2</span>), <span class="hljs-string">&quot;M_reduced has &#123;&#125; columns; should have &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(M_test_reduced.shape[<span class="hljs-number">1</span>], <span class="hljs-number">2</span>)<br><br><span class="hljs-comment"># Print Success</span><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">80</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Passed All Tests!&quot;</span>)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">80</span>)<br></code></pre></div></td></tr></table></figure><h3 id="é—®é¢˜1.4-å®ç°-plot_embeddings">é—®é¢˜1.4 å®ç° plot_embeddings</h3><p>åŸºäºmatplotlibï¼Œç”¨<code>scatter</code> ç”» â€œÃ—â€ï¼Œç”¨ <code>text</code>å†™å­—</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">plot_embeddings</span>(<span class="hljs-params">M_reduced, word2Ind, words</span>):<br>    <span class="hljs-string">&quot;&quot;&quot; Plot in a scatterplot the embeddings of the words specified in the list &quot;words&quot;.</span><br><span class="hljs-string">        NOTE: do not plot all the words listed in M_reduced / word2Ind.</span><br><span class="hljs-string">        Include a label next to each point.</span><br><span class="hljs-string">        </span><br><span class="hljs-string">        Params:</span><br><span class="hljs-string">            M_reduced (numpy matrix of shape (number of unique words in the corpus , k)): matrix of k-dimensioal word embeddings</span><br><span class="hljs-string">            word2Ind (dict): dictionary that maps word to indices for matrix M</span><br><span class="hljs-string">            words (list of strings): words whose embeddings we want to visualize</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    <span class="hljs-comment"># ------------------</span><br>    <span class="hljs-comment"># Write your implementation here.</span><br>    <br>    <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> words:<br>        index = word2Ind[w]<br>        embedding = M_reduced[index]<br>        x, y  = embedding[<span class="hljs-number">0</span>], embedding[<span class="hljs-number">1</span>]<br>        plt.scatter(x, y, marker=<span class="hljs-string">&#x27;x&#x27;</span>, color=<span class="hljs-string">&#x27;red&#x27;</span>)<br>        plt.text(x, y, word, fontsize=<span class="hljs-number">9</span>)<br>    plt.show()<br>    <span class="hljs-comment"># ------------------</span><br></code></pre></div></td></tr></table></figure><p>æµ‹è¯•ç”¨ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># ---------------------</span><br><span class="hljs-comment"># Run this sanity check</span><br><span class="hljs-comment"># Note that this is not an exhaustive check for correctness.</span><br><span class="hljs-comment"># The plot produced should look like the &quot;test solution plot&quot; depicted below. </span><br><span class="hljs-comment"># ---------------------</span><br><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">80</span>)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;Outputted Plot:&quot;</span>)<br><br>M_reduced_plot_test = np.array([[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>], [-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>]])<br>word2ind_plot_test = &#123;<span class="hljs-string">&#x27;test1&#x27;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;test2&#x27;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;test3&#x27;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;test4&#x27;</span>: <span class="hljs-number">3</span>, <span class="hljs-string">&#x27;test5&#x27;</span>: <span class="hljs-number">4</span>&#125;<br>words = [<span class="hljs-string">&#x27;test1&#x27;</span>, <span class="hljs-string">&#x27;test2&#x27;</span>, <span class="hljs-string">&#x27;test3&#x27;</span>, <span class="hljs-string">&#x27;test4&#x27;</span>, <span class="hljs-string">&#x27;test5&#x27;</span>]<br>plot_embeddings(M_reduced_plot_test, word2ind_plot_test, words)<br><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">80</span>)<br></code></pre></div></td></tr></table></figure><p>æ•ˆæœï¼š</p><p><img src="/img/nlp/assignment1/1.jpg"/></p><h3 id="é—®é¢˜1.5å…±ç°æ‰“å°åˆ†æ">é—®é¢˜1.5ï¼šå…±ç°æ‰“å°åˆ†æ</h3><p>å°†è¯åµŒå…¥åˆ°2ä¸ªç»´åº¦ä¸Šï¼Œå½’ä¸€åŒ–ï¼Œæœ€ç»ˆè¯å‘é‡ä¼šè½åˆ°ä¸€ä¸ªå•ä½åœ†å†…ï¼Œåœ¨åæ ‡ç³»ä¸Šå¯»æ‰¾ç›¸è¿‘çš„è¯ã€‚</p><p>æµ‹è¯•ç”¨ä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># -----------------------------</span><br><span class="hljs-comment"># Run This Cell to Produce Your Plot</span><br><span class="hljs-comment"># ------------------------------</span><br>reuters_corpus = read_corpus()<br>M_co_occurrence, word2ind_co_occurrence = compute_co_occurrence_matrix(reuters_corpus)<br>M_reduced_co_occurrence = reduce_to_k_dim(M_co_occurrence, k=<span class="hljs-number">2</span>)<br><br><span class="hljs-comment"># Rescale (normalize) the rows to make them each of unit-length</span><br>M_lengths = np.linalg.norm(M_reduced_co_occurrence, axis=<span class="hljs-number">1</span>)<br>M_normalized = M_reduced_co_occurrence / M_lengths[:, np.newaxis] <span class="hljs-comment"># broadcasting</span><br><br>words = [<span class="hljs-string">&#x27;barrels&#x27;</span>, <span class="hljs-string">&#x27;bpd&#x27;</span>, <span class="hljs-string">&#x27;ecuador&#x27;</span>, <span class="hljs-string">&#x27;energy&#x27;</span>, <span class="hljs-string">&#x27;industry&#x27;</span>, <span class="hljs-string">&#x27;kuwait&#x27;</span>, <span class="hljs-string">&#x27;oil&#x27;</span>, <span class="hljs-string">&#x27;output&#x27;</span>, <span class="hljs-string">&#x27;petroleum&#x27;</span>, <span class="hljs-string">&#x27;iraq&#x27;</span>]<br><br>plot_embeddings(M_normalized, word2ind_co_occurrence, words)<br></code></pre></div></td></tr></table></figure><p><img src="/img/nlp/assignment1/2.jpg"/></p><h2 id="part-2åŸºäºé¢„æµ‹çš„è¯å‘é‡">Part 2ï¼šåŸºäºé¢„æµ‹çš„è¯å‘é‡</h2><p>ç›®å‰ï¼ŒåŸºäºé¢„æµ‹çš„è¯å‘é‡æ˜¯æœ€æµè¡Œçš„ï¼Œæ¯”å¦‚word2vecã€‚ç°åœ¨æˆ‘ä»¬æ¥æ¢ç´¢word2vecç”Ÿæˆçš„è¯å‘é‡ï¼Œå¦‚æœæƒ³è¦æ·±å…¥äº†è§£ï¼Œå¯ä»¥è¯»ä¸€è¯»<ahref="https://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf">åŸå§‹è®ºæ–‡</a>ã€‚</p><p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯ä½¿ç”¨gensimæ¢ç´¢è¯å‘é‡ï¼Œä¸æ˜¯è‡ªå·±å®ç°word2vecï¼Œæ‰€ä½¿ç”¨çš„è¯å‘é‡ç»´åº¦æ˜¯300ï¼Œç”±googleå‘å¸ƒã€‚</p><p>é¦–å…ˆä½¿ç”¨SVDé™ç»´ï¼Œå°†300ç»´é™2ç»´ï¼Œæ–¹ä¾¿æ‰“å°æŸ¥çœ‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">load_embedding_model</span>():<br>    <span class="hljs-string">&quot;&quot;&quot; Load GloVe Vectors</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            wv_from_bin: All 400000 embeddings, each lengh 200</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">import</span> gensim.downloader <span class="hljs-keyword">as</span> api<br>    wv_from_bin = api.load(<span class="hljs-string">&quot;glove-wiki-gigaword-200&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Loaded vocab size %i&quot;</span> % <span class="hljs-built_in">len</span>(wv_from_bin.vocab.keys()))<br>    <span class="hljs-keyword">return</span> wv_from_bin<br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># -----------------------------------</span><br><span class="hljs-comment"># Run Cell to Load Word Vectors</span><br><span class="hljs-comment"># Note: This will take a couple minutes</span><br><span class="hljs-comment"># -----------------------------------</span><br>wv_from_bin = load_embedding_model()<br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_matrix_of_vectors</span>(<span class="hljs-params">wv_from_bin, required_words=[<span class="hljs-string">&#x27;barrels&#x27;</span>, <span class="hljs-string">&#x27;bpd&#x27;</span>, <span class="hljs-string">&#x27;ecuador&#x27;</span>, <span class="hljs-string">&#x27;energy&#x27;</span>, <span class="hljs-string">&#x27;industry&#x27;</span>, <span class="hljs-string">&#x27;kuwait&#x27;</span>, <span class="hljs-string">&#x27;oil&#x27;</span>, <span class="hljs-string">&#x27;output&#x27;</span>, <span class="hljs-string">&#x27;petroleum&#x27;</span>, <span class="hljs-string">&#x27;iraq&#x27;</span>]</span>):<br>    <span class="hljs-string">&quot;&quot;&quot; Put the GloVe vectors into a matrix M.</span><br><span class="hljs-string">        Param:</span><br><span class="hljs-string">            wv_from_bin: KeyedVectors object; the 400000 GloVe vectors loaded from file</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            M: numpy matrix shape (num words, 200) containing the vectors</span><br><span class="hljs-string">            word2ind: dictionary mapping each word to its row number in M</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">import</span> random<br>    words = <span class="hljs-built_in">list</span>(wv_from_bin.vocab.keys())<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Shuffling words ...&quot;</span>)<br>    random.seed(<span class="hljs-number">224</span>)<br>    random.shuffle(words)<br>    words = words[:<span class="hljs-number">10000</span>]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Putting %i words into word2ind and matrix M...&quot;</span> % <span class="hljs-built_in">len</span>(words))<br>    word2ind = &#123;&#125;<br>    M = []<br>    curInd = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> words:<br>        <span class="hljs-keyword">try</span>:<br>            M.append(wv_from_bin.word_vec(w))<br>            word2ind[w] = curInd<br>            curInd += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">except</span> KeyError:<br>            <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> required_words:<br>        <span class="hljs-keyword">if</span> w <span class="hljs-keyword">in</span> words:<br>            <span class="hljs-keyword">continue</span><br>        <span class="hljs-keyword">try</span>:<br>            M.append(wv_from_bin.word_vec(w))<br>            word2ind[w] = curInd<br>            curInd += <span class="hljs-number">1</span><br>        <span class="hljs-keyword">except</span> KeyError:<br>            <span class="hljs-keyword">continue</span><br>    M = np.stack(M)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Done.&quot;</span>)<br>    <span class="hljs-keyword">return</span> M, word2ind<br></code></pre></div></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># -----------------------------------------------------------------</span><br><span class="hljs-comment"># Run Cell to Reduce 200-Dimensional Word Embeddings to k Dimensions</span><br><span class="hljs-comment"># Note: This should be quick to run</span><br><span class="hljs-comment"># -----------------------------------------------------------------</span><br>M, word2ind = get_matrix_of_vectors(wv_from_bin)<br>M_reduced = reduce_to_k_dim(M, k=<span class="hljs-number">2</span>)<br><br><span class="hljs-comment"># Rescale (normalize) the rows to make them each of unit-length</span><br>M_lengths = np.linalg.norm(M_reduced, axis=<span class="hljs-number">1</span>)<br>M_reduced_normalized = M_reduced / M_lengths[:, np.newaxis] <span class="hljs-comment"># broadcasting</span><br></code></pre></div></td></tr></table></figure><h3 id="é—®é¢˜2.1word2vecæ‰“å°åˆ†æ">é—®é¢˜2.1ï¼šword2vecæ‰“å°åˆ†æ</h3><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">words = [<span class="hljs-string">&#x27;barrels&#x27;</span>, <span class="hljs-string">&#x27;bpd&#x27;</span>, <span class="hljs-string">&#x27;ecuador&#x27;</span>, <span class="hljs-string">&#x27;energy&#x27;</span>, <span class="hljs-string">&#x27;industry&#x27;</span>, <span class="hljs-string">&#x27;kuwait&#x27;</span>, <span class="hljs-string">&#x27;oil&#x27;</span>, <span class="hljs-string">&#x27;output&#x27;</span>, <span class="hljs-string">&#x27;petroleum&#x27;</span>, <span class="hljs-string">&#x27;iraq&#x27;</span>]<br>plot_embeddings(M_reduced_normalized, word2ind, words)<br></code></pre></div></td></tr></table></figure><p>å’Œé—®é¢˜1.5ä¸€æ ·</p><h3 id="é—®é¢˜2.2ä¸€è¯å¤šä¹‰">é—®é¢˜2.2ï¼šä¸€è¯å¤šä¹‰</h3><p>æ‰¾åˆ°ä¸€ä¸ªæœ‰å¤šä¸ªå«ä¹‰çš„è¯ï¼ˆæ¯”å¦‚â€œleavesâ€ï¼Œâ€scoopâ€ï¼‰ï¼Œè¿™ç§è¯çš„top-10ç›¸ä¼¼è¯ï¼ˆæ ¹æ®ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰é‡Œæœ‰ä¸¤ä¸ªè¯çš„æ„æ€ä¸ä¸€æ ·ã€‚æ¯”å¦‚â€leavesâ€ï¼ˆå¶å­ï¼ŒèŠ±ç“£ï¼‰çš„top-10è¯é‡Œæœ‰â€vanishesâ€ï¼ˆæ¶ˆå¤±ï¼‰å’Œâ€stalksâ€ï¼ˆèŒç§†ï¼‰ã€‚</p><p><strong>Note</strong>: You should use the<code>wv_from_bin.most_similar(word)</code> function to get the top 10similar words. This function ranks all other words in the vocabularywith respect to their cosine similarity to the given word. For furtherassistance, please check the <strong><ahref="https://radimrehurek.com/gensim/models/keyedvectors.html#gensim.models.keyedvectors.FastTextKeyedVectors.most_similar">GenSimdocumentation</a></strong>.</p><p>è¿™é‡Œæˆ‘æ‰¾åˆ°çš„è¯æ˜¯â€columnâ€ï¼ˆåˆ—ï¼‰ï¼Œå®ƒçš„top-10é‡Œæœ‰â€columnistâ€ï¼ˆä¸“æ ä½œå®¶ï¼‰å’Œâ€articleâ€ï¼ˆæ–‡ç« ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># ------------------</span><br><span class="hljs-comment"># Write your polysemous word exploration code here.</span><br><br>wv_from_bin.most_similar(<span class="hljs-string">&quot;column&quot;</span>)<br><br><span class="hljs-comment"># ------------------</span><br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scheme">[(<span class="hljs-symbol">&#x27;columns</span>&#x27;, <span class="hljs-number">0.767943263053894</span>),<br> (<span class="hljs-symbol">&#x27;columnist</span>&#x27;, <span class="hljs-number">0.6541407108306885</span>),<br> (<span class="hljs-symbol">&#x27;article</span>&#x27;, <span class="hljs-number">0.651928186416626</span>),<br> (<span class="hljs-symbol">&#x27;columnists</span>&#x27;, <span class="hljs-number">0.617466926574707</span>),<br> (<span class="hljs-symbol">&#x27;syndicated_column</span>&#x27;, <span class="hljs-number">0.599014401435852</span>),<br> (<span class="hljs-symbol">&#x27;op_ed</span>&#x27;, <span class="hljs-number">0.588202714920044</span>),<br> (<span class="hljs-symbol">&#x27;Op_Ed</span>&#x27;, <span class="hljs-number">0.5801560282707214</span>),<br> (<span class="hljs-symbol">&#x27;op_ed_column</span>&#x27;, <span class="hljs-number">0.5779396891593933</span>),<br> (<span class="hljs-symbol">&#x27;nationally_syndicated_column</span>&#x27;, <span class="hljs-number">0.572504997253418</span>),<br> (<span class="hljs-symbol">&#x27;colum</span>&#x27;, <span class="hljs-number">0.5595961213111877</span>)]<br></code></pre></div></td></tr></table></figure><h3 id="é—®é¢˜2.3è¿‘ä¹‰è¯å’Œåä¹‰è¯">é—®é¢˜2.3ï¼šè¿‘ä¹‰è¯å’Œåä¹‰è¯</h3><p>æ‰¾åˆ°ä¸‰ä¸ªè¯(w1, w2,w3)ï¼Œå…¶ä¸­w1å’Œw2æ˜¯è¿‘ä¹‰è¯ï¼Œw1å’Œw3æ˜¯åä¹‰è¯ï¼Œä½†æ˜¯w1å’Œw3çš„è·ç¦»&lt;w1å’Œw2çš„è·ç¦»ã€‚ä¾‹å¦‚ï¼šw1=â€happyâ€ï¼Œw2=â€cheerfulâ€ï¼Œw3=â€sadâ€</p><p>You should use the the <code>wv_from_bin.distance(w1, w2)</code>function here in order to compute the cosine distance between two words.Please see the <strong><ahref="https://radimrehurek.com/gensim/models/keyedvectors.html#gensim.models.keyedvectors.FastTextKeyedVectors.distance">GenSimdocumentation</a></strong> for further assistance.</p><p>ä¸ºä»€ä¹ˆåä¹‰è¯çš„ç›¸ä¼¼åº¦åè€Œæ›´å¤§å‘¢ï¼ˆè·ç¦»è¶Šå°è¯´æ˜è¶Šç›¸ä¼¼ï¼‰ï¼Ÿå› ä¸ºä»–ä»¬çš„ä¸Šä¸‹æ–‡é€šå¸¸éå¸¸ä¸€è‡´</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># ------------------</span><br><span class="hljs-comment"># Write your synonym &amp; antonym exploration code here.</span><br><br>w1 = <span class="hljs-string">&quot;love&quot;</span><br>w2 = <span class="hljs-string">&quot;like&quot;</span><br>w3 = <span class="hljs-string">&quot;hate&quot;</span><br>w1_w2_dist = wv_from_bin.distance(w1, w2)<br>w1_w3_dist = wv_from_bin.distance(w1, w3)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Synonyms &#123;&#125;, &#123;&#125; have cosine distance: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(w1, w2, w1_w2_dist))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Antonyms &#123;&#125;, &#123;&#125; have cosine distance: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(w1, w3, w1_w3_dist))<br><br><span class="hljs-comment"># ------------------</span><br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">Synonyms</span> love, like have cosine distance: <span class="hljs-number">0</span>.<span class="hljs-number">6328612565994263</span><br><span class="hljs-attribute">Antonyms</span> love, hate have cosine distance: <span class="hljs-number">0</span>.<span class="hljs-number">39960432052612305</span><br></code></pre></div></td></tr></table></figure><h3 id="é—®é¢˜2.4ç±»æ¯”">é—®é¢˜2.4ï¼šç±»æ¯”</h3><p>man å¯¹äºkingï¼Œç›¸å½“äºwomanå¯¹äº___ï¼Œè¿™æ ·çš„é—®é¢˜ä¹Ÿå¯ä»¥ç”¨word2vecæ¥è§£å†³ï¼Œå…³äºmost_similarçš„è¯¦ç»†ç”¨æ³•å¯ä»¥å‚è€ƒ<ahref="https://radimrehurek.com/gensim/models/keyedvectors.html#gensim.models.keyedvectors.FastTextKeyedVectors.most_similar">GenSimæ–‡æ¡£</a>ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬æ‰¾å¦å¤–ä¸€ç»„ç±»æ¯”</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># ------------------</span><br><span class="hljs-comment"># Write your analogy exploration code here.</span><br><span class="hljs-comment"># man : him :: woman : her</span><br>pprint.pprint(wv_from_bin.most_similar(positive=[<span class="hljs-string">&#x27;woman&#x27;</span>, <span class="hljs-string">&#x27;him&#x27;</span>], negative=[<span class="hljs-string">&#x27;man&#x27;</span>]))<br><br><span class="hljs-comment"># ------------------</span><br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scheme">[(<span class="hljs-symbol">&#x27;her</span>&#x27;, <span class="hljs-number">0.694490909576416</span>),<br> (<span class="hljs-symbol">&#x27;she</span>&#x27;, <span class="hljs-number">0.6385233402252197</span>),<br> (<span class="hljs-symbol">&#x27;me</span>&#x27;, <span class="hljs-number">0.628451406955719</span>),<br> (<span class="hljs-symbol">&#x27;herself</span>&#x27;, <span class="hljs-number">0.6239798665046692</span>),<br> (<span class="hljs-symbol">&#x27;them</span>&#x27;, <span class="hljs-number">0.5843966007232666</span>),<br> (<span class="hljs-symbol">&#x27;She</span>&#x27;, <span class="hljs-number">0.5237804651260376</span>),<br> (<span class="hljs-symbol">&#x27;myself</span>&#x27;, <span class="hljs-number">0.4885627031326294</span>),<br> (<span class="hljs-symbol">&#x27;saidshe</span>&#x27;, <span class="hljs-number">0.48337966203689575</span>),<br> (<span class="hljs-symbol">&#x27;he</span>&#x27;, <span class="hljs-number">0.48184287548065186</span>),<br> (<span class="hljs-symbol">&#x27;Gail_Quets</span>&#x27;, <span class="hljs-number">0.4784894585609436</span>)]<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ­£ç¡®çš„è®¡ç®—å‡ºäº†â€herâ€</p><h3 id="é—®é¢˜2.5é”™è¯¯çš„ç±»æ¯”">é—®é¢˜2.5ï¼šé”™è¯¯çš„ç±»æ¯”</h3><p>æ‰¾åˆ°ä¸€ä¸ªé”™è¯¯çš„ç±»æ¯”ï¼Œæ ‘ï¼šæ ‘å¶ ï¼šï¼šèŠ±ï¼šèŠ±ç“£</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># ------------------</span><br><span class="hljs-comment"># Write your incorrect analogy exploration code here.</span><br><span class="hljs-comment"># tree : leaf :: flower : petal</span><br>pprint.pprint(wv_from_bin.most_similar(positive=[<span class="hljs-string">&#x27;leaf&#x27;</span>, <span class="hljs-string">&#x27;flower&#x27;</span>], negative=[<span class="hljs-string">&#x27;tree&#x27;</span>]))<br><br><span class="hljs-comment"># ------------------</span><br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scheme">[(<span class="hljs-symbol">&#x27;floral</span>&#x27;, <span class="hljs-number">0.5532568693161011</span>),<br> (<span class="hljs-symbol">&#x27;marigold</span>&#x27;, <span class="hljs-number">0.5291938185691833</span>),<br> (<span class="hljs-symbol">&#x27;tulip</span>&#x27;, <span class="hljs-number">0.521312952041626</span>),<br> (<span class="hljs-symbol">&#x27;rooted_cuttings</span>&#x27;, <span class="hljs-number">0.5189826488494873</span>),<br> (<span class="hljs-symbol">&#x27;variegation</span>&#x27;, <span class="hljs-number">0.5136324763298035</span>),<br> (<span class="hljs-symbol">&#x27;Asiatic_lilies</span>&#x27;, <span class="hljs-number">0.5132641792297363</span>),<br> (<span class="hljs-symbol">&#x27;gerberas</span>&#x27;, <span class="hljs-number">0.5106234550476074</span>),<br> (<span class="hljs-symbol">&#x27;gerbera_daisies</span>&#x27;, <span class="hljs-number">0.5101010203361511</span>),<br> (<span class="hljs-symbol">&#x27;Verbena_bonariensis</span>&#x27;, <span class="hljs-number">0.5070016980171204</span>),<br> (<span class="hljs-symbol">&#x27;violet</span>&#x27;, <span class="hljs-number">0.5058108568191528</span>)]<br></code></pre></div></td></tr></table></figure><p>ç»“æœè¾“å‡ºçš„é‡Œé¢æ²¡æœ‰â€œèŠ±ç“£â€</p><h3 id="é—®é¢˜2.6åè§åˆ†æ">é—®é¢˜2.6ï¼šåè§åˆ†æ</h3><p>æ³¨æ„åè§æ˜¯å¾ˆé‡è¦çš„æ¯”å¦‚æ€§åˆ«æ­§è§†ã€ç§æ—æ­§è§†ç­‰ï¼Œæ‰§è¡Œä¸‹é¢ä»£ç ï¼Œåˆ†æä¸¤ä¸ªé—®é¢˜ï¼š</p><ol type="a"><li><p>å“ªä¸ªè¯ä¸â€œwomanâ€å’Œâ€œbossâ€æœ€ç›¸ä¼¼ï¼Œå’Œâ€œmanâ€æœ€ä¸ç›¸ä¼¼?</p></li><li><p>å“ªä¸ªè¯ä¸â€œmanâ€å’Œâ€œbossâ€æœ€ç›¸ä¼¼ï¼Œå’Œâ€œwomanâ€æœ€ä¸ç›¸ä¼¼?</p></li></ol><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># Run this cell</span><br><span class="hljs-comment"># Here `positive` indicates the list of words to be similar to and `negative` indicates the list of words to be</span><br><span class="hljs-comment"># most dissimilar from.</span><br>pprint.pprint(wv_from_bin.most_similar(positive=[<span class="hljs-string">&#x27;woman&#x27;</span>, <span class="hljs-string">&#x27;boss&#x27;</span>], negative=[<span class="hljs-string">&#x27;man&#x27;</span>]))<br><span class="hljs-built_in">print</span>()<br>pprint.pprint(wv_from_bin.most_similar(positive=[<span class="hljs-string">&#x27;man&#x27;</span>, <span class="hljs-string">&#x27;boss&#x27;</span>], negative=[<span class="hljs-string">&#x27;woman&#x27;</span>]))<br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scheme">[(<span class="hljs-symbol">&#x27;bosses</span>&#x27;, <span class="hljs-number">0.5522644519805908</span>),<br> (<span class="hljs-symbol">&#x27;manageress</span>&#x27;, <span class="hljs-number">0.49151360988616943</span>),<br> (<span class="hljs-symbol">&#x27;exec</span>&#x27;, <span class="hljs-number">0.45940813422203064</span>),<br> (<span class="hljs-symbol">&#x27;Manageress</span>&#x27;, <span class="hljs-number">0.45598435401916504</span>),<br> (<span class="hljs-symbol">&#x27;receptionist</span>&#x27;, <span class="hljs-number">0.4474116563796997</span>),<br> (<span class="hljs-symbol">&#x27;Jane_Danson</span>&#x27;, <span class="hljs-number">0.44480544328689575</span>),<br> (<span class="hljs-symbol">&#x27;Fiz_Jennie_McAlpine</span>&#x27;, <span class="hljs-number">0.44275766611099243</span>),<br> (<span class="hljs-symbol">&#x27;Coronation_Street_actress</span>&#x27;, <span class="hljs-number">0.44275566935539246</span>),<br> (<span class="hljs-symbol">&#x27;supremo</span>&#x27;, <span class="hljs-number">0.4409853219985962</span>),<br> (<span class="hljs-symbol">&#x27;coworker</span>&#x27;, <span class="hljs-number">0.43986251950263977</span>)]<br><br>[(<span class="hljs-symbol">&#x27;supremo</span>&#x27;, <span class="hljs-number">0.6097398400306702</span>),<br> (<span class="hljs-symbol">&#x27;MOTHERWELL_boss</span>&#x27;, <span class="hljs-number">0.5489562153816223</span>),<br> (<span class="hljs-symbol">&#x27;CARETAKER_boss</span>&#x27;, <span class="hljs-number">0.5375303626060486</span>),<br> (<span class="hljs-symbol">&#x27;Bully_Wee_boss</span>&#x27;, <span class="hljs-number">0.5333974361419678</span>),<br> (<span class="hljs-symbol">&#x27;YEOVIL_Town_boss</span>&#x27;, <span class="hljs-number">0.5321705341339111</span>),<br> (<span class="hljs-symbol">&#x27;head_honcho</span>&#x27;, <span class="hljs-number">0.5281980037689209</span>),<br> (<span class="hljs-symbol">&#x27;manager_Stan_Ternent</span>&#x27;, <span class="hljs-number">0.525971531867981</span>),<br> (<span class="hljs-symbol">&#x27;Viv_Busby</span>&#x27;, <span class="hljs-number">0.5256162881851196</span>),<br> (<span class="hljs-symbol">&#x27;striker_Gabby_Agbonlahor</span>&#x27;, <span class="hljs-number">0.5250812768936157</span>),<br> (<span class="hljs-symbol">&#x27;BARNSLEY_boss</span>&#x27;, <span class="hljs-number">0.5238943099975586</span>)]<br></code></pre></div></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªç±»æ¯” ç”·äºº:å¥³äºº ::è€æ¿:___ï¼Œæœ€åˆé€‚çš„è¯åº”è¯¥æ˜¯â€landladyâ€ï¼ˆè€æ¿å¨˜ï¼‰ä¹‹ç±»çš„ï¼Œä½†æ˜¯top-10é‡Œåªæœ‰â€manageressâ€ï¼ˆå¥³ç»ç†ï¼‰ï¼Œâ€receptionistâ€ï¼ˆæ¥å¾…å‘˜ï¼‰ä¹‹ç±»çš„è¯ã€‚</p><p>ç¬¬äºŒä¸ªç±»æ¯” å¥³äºº:ç”·äºº :: è€æ¿:___ï¼Œè¾“å‡ºçš„ä¸çŸ¥é“æ˜¯äº›ä»€ä¹ˆä¸œè¥¿/æ‚è„¸</p><h3 id="é—®é¢˜2.7è‡ªè¡Œåˆ†æåè§">é—®é¢˜2.7ï¼šè‡ªè¡Œåˆ†æåè§</h3><p>è¿™é‡Œæˆ‘æ‰¾çš„ä¾‹å­æ˜¯ï¼š</p><ul><li>ç”·äºº:å¥³äºº :: åŒ»ç”Ÿ:___</li><li>å¥³äºº:ç”·äºº :: åŒ»ç”Ÿ:___</li></ul><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># ------------------</span><br><span class="hljs-comment"># Write your bias exploration code here.</span><br><br>pprint.pprint(wv_from_bin.most_similar(positive=[<span class="hljs-string">&#x27;woman&#x27;</span>, <span class="hljs-string">&#x27;doctor&#x27;</span>], negative=[<span class="hljs-string">&#x27;man&#x27;</span>]))<br><span class="hljs-built_in">print</span>()<br>pprint.pprint(wv_from_bin.most_similar(positive=[<span class="hljs-string">&#x27;man&#x27;</span>, <span class="hljs-string">&#x27;doctor&#x27;</span>], negative=[<span class="hljs-string">&#x27;woman&#x27;</span>]))<br><br><span class="hljs-comment"># ------------------</span><br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight scheme"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scheme">[(<span class="hljs-symbol">&#x27;gynecologist</span>&#x27;, <span class="hljs-number">0.7093892097473145</span>),<br> (<span class="hljs-symbol">&#x27;nurse</span>&#x27;, <span class="hljs-number">0.647728681564331</span>),<br> (<span class="hljs-symbol">&#x27;doctors</span>&#x27;, <span class="hljs-number">0.6471461057662964</span>),<br> (<span class="hljs-symbol">&#x27;physician</span>&#x27;, <span class="hljs-number">0.64389967918396</span>),<br> (<span class="hljs-symbol">&#x27;pediatrician</span>&#x27;, <span class="hljs-number">0.6249487996101379</span>),<br> (<span class="hljs-symbol">&#x27;nurse_practitioner</span>&#x27;, <span class="hljs-number">0.6218312978744507</span>),<br> (<span class="hljs-symbol">&#x27;obstetrician</span>&#x27;, <span class="hljs-number">0.6072014570236206</span>),<br> (<span class="hljs-symbol">&#x27;ob_gyn</span>&#x27;, <span class="hljs-number">0.5986712574958801</span>),<br> (<span class="hljs-symbol">&#x27;midwife</span>&#x27;, <span class="hljs-number">0.5927063226699829</span>),<br> (<span class="hljs-symbol">&#x27;dermatologist</span>&#x27;, <span class="hljs-number">0.5739566683769226</span>)]<br><br>[(<span class="hljs-symbol">&#x27;physician</span>&#x27;, <span class="hljs-number">0.6463665962219238</span>),<br> (<span class="hljs-symbol">&#x27;doctors</span>&#x27;, <span class="hljs-number">0.5858404040336609</span>),<br> (<span class="hljs-symbol">&#x27;surgeon</span>&#x27;, <span class="hljs-number">0.5723941326141357</span>),<br> (<span class="hljs-symbol">&#x27;dentist</span>&#x27;, <span class="hljs-number">0.552364706993103</span>),<br> (<span class="hljs-symbol">&#x27;cardiologist</span>&#x27;, <span class="hljs-number">0.5413815975189209</span>),<br> (<span class="hljs-symbol">&#x27;neurologist</span>&#x27;, <span class="hljs-number">0.5271126627922058</span>),<br> (<span class="hljs-symbol">&#x27;neurosurgeon</span>&#x27;, <span class="hljs-number">0.5249835848808289</span>),<br> (<span class="hljs-symbol">&#x27;urologist</span>&#x27;, <span class="hljs-number">0.5247740149497986</span>),<br> (<span class="hljs-symbol">&#x27;Doctor</span>&#x27;, <span class="hljs-number">0.5240625143051147</span>),<br> (<span class="hljs-symbol">&#x27;internist</span>&#x27;, <span class="hljs-number">0.5183224081993103</span>)]<br></code></pre></div></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªç±»æ¯”ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†â€nurseâ€ï¼ˆæŠ¤å£«ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰åè§çš„ç±»æ¯”</p><h3 id="é—®é¢˜2.8æ€è€ƒåè§é—®é¢˜">é—®é¢˜2.8ï¼šæ€è€ƒåè§é—®é¢˜</h3><p>ä»€ä¹ˆä¼šå¯¼è‡´è¯å‘é‡é‡Œçš„åè§ï¼Ÿ</p><p>å› ä¸ºæ•°æ®é›†ä¸­æœ‰åè§</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p>[1] CS224n: Natural Language Processing with Deep Learning,2019-03-12. http://web.stanford.edu/class/cs224n.</p><p>[2]https://github.com/ShowMeAI-Hub/awesome-AI-courses-notes-cheatsheets/tree/main/CS224n-Natural-Language-Processing-with-Deep-Learning/assignment-solutions/Assignment1</p>]]></content>
    
    
    <categories>
      
      <category>Deep Learning</category>
      
      <category>NLP</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬äºŒè®²-è¯å‘é‡è¿›é˜¶</title>
    <link href="/2022/05/05/%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E8%AF%8D%E5%90%91%E9%87%8F%E8%BF%9B%E9%98%B6/"/>
    <url>/2022/05/05/%E7%AC%AC%E4%BA%8C%E8%AE%B2-%E8%AF%8D%E5%90%91%E9%87%8F%E8%BF%9B%E9%98%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®—æ³•ä¼˜åŒ–åŸºç¡€">1 ç®—æ³•ä¼˜åŒ–åŸºç¡€</h1><h2 id="è¯å‘é‡æ¢¯åº¦ä¸‹é™ç®—æ³•">1.1 è¯å‘é‡æ¢¯åº¦ä¸‹é™ç®—æ³•</h2><p>é—®é¢˜ï¼šæ¢¯åº¦ä¸‹é™ä¼šä¸€æ¬¡æ€§ä½¿ç”¨æ‰€æœ‰æ•°æ®æ ·æœ¬è¿›è¡Œå‚æ•°æ›´æ–°ï¼Œå¯¹åº”åˆ°æˆ‘ä»¬å½“å‰çš„è¯å‘é‡å»ºæ¨¡é—®é¢˜ï¼Œå°±æ˜¯<spanclass="math inline">\(J(\theta)\)</span>çš„è®¡ç®—éœ€è¦åŸºäºè¯­æ–™åº“æ‰€æœ‰çš„æ ·æœ¬(çª—å£)ï¼Œæ•°æ®è§„æ¨¡éå¸¸å¤§ï¼š</p><ul><li>è®¡ç®—éå¸¸è€—èµ„æº</li><li>è®¡ç®—æ—¶é—´é•¿</li></ul><p>è§£å†³æ–¹æ¡ˆï¼šéšæœºæ¢¯åº¦ä¸‹é™ç®—æ³• Stochastic Gradient Descentï¼ˆSGDï¼‰</p><ul><li>åœ¨å•ä¸ªæ ·æœ¬ä¸­è®¡ç®—å’Œæ›´æ–°å‚æ•°ï¼Œå¹¶éå†æ‰€æœ‰æ ·æœ¬</li></ul><p>ä½†åŸºäºå•ä¸ªæ ·æœ¬æ›´æ–°ä¼šè¡¨ç°ä¸ºå‚æ•°éœ‡è¡å¾ˆå‰å®³ï¼Œæ”¶æ•›è¿‡ç¨‹å¹¶ä¸å¹³ç¨³ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šæ”¹ä¸ºä½¿ç”¨<strong>mini-batchgradient descent</strong></p><h2 id="è¯å‘é‡å»ºæ¨¡ä¸­çš„éšæœºæ¢¯åº¦ä¸‹é™">1.2 è¯å‘é‡å»ºæ¨¡ä¸­çš„éšæœºæ¢¯åº¦ä¸‹é™</h2><ul><li>åº”ç”¨éšæœºæ¢¯åº¦ä¸‹é™ï¼Œåœ¨æ¯ä¸ªçª—å£è®¡ç®—å’Œæ›´æ–°å‚æ•°ï¼Œéå†æ‰€æœ‰æ ·æœ¬</li><li>åœ¨æ¯ä¸ªçª—å£å†…ï¼Œæˆ‘ä»¬æœ€å¤šåªæœ‰<spanclass="math inline">\(2m+1\)</span>ä¸ªè¯ï¼Œå› æ­¤<spanclass="math inline">\(\nabla_{\theta}J_{t}(\theta)\)</span>æ˜¯éå¸¸ç¨€ç–çš„</li></ul><p><span class="math display">\[\nabla_{\theta} J_{t}(\theta)=\left[\begin{array}{l}0 \\\vdots \\\nabla_{v_{\text {like }}} \\\vdots \\0 \\\nabla_{u_{I}} \\\vdots \\\nabla_{u_{\text {learning }}} \\\vdots\end{array}\right] \in \mathbb{R}^{2 d V}\]</span></p><p>ä¸Šé¢æåˆ°çš„ç¨€ç–æ€§é—®é¢˜ï¼Œä¸€ç§è§£å†³æ–¹å¼æ˜¯æˆ‘ä»¬<strong>åªæ›´æ–°å®é™…å‡ºç°çš„å‘é‡</strong></p><ul><li>éœ€è¦ç¨€ç–çŸ©é˜µæ›´æ–°æ“ä½œæ¥åªæ›´æ–°çŸ©é˜µ<spanclass="math inline">\(U\)</span>å’Œ<spanclass="math inline">\(V\)</span>ä¸­çš„ç‰¹å®šè¡Œ</li><li>éœ€è¦ä¿ç•™å•è¯å‘é‡çš„å“ˆå¸Œ/æ•£åˆ—</li></ul><p>å¦‚æœæœ‰æ•°ç™¾ä¸‡ä¸ªå•è¯å‘é‡ï¼Œå¹¶ä¸”è¿›è¡Œåˆ†å¸ƒå¼è®¡ç®—ï¼Œæˆ‘ä»¬æ— éœ€å†ä¼ è¾“å·¨å¤§çš„æ›´æ–°ä¿¡æ¯ï¼ˆæ•°æ®ä¼ è¾“æœ‰æˆæœ¬ï¼‰</p><h2 id="word2vecçš„æ›´å¤šç»†èŠ‚">1.3 Word2vecçš„æ›´å¤šç»†èŠ‚</h2><p>word2vecæœ‰ä¸¤ä¸ªæ¨¡å‹å˜ä½“ï¼š</p><ul><li>1.Skip-grams (SG)ï¼šè¾“å…¥ä¸­å¿ƒè¯å¹¶é¢„æµ‹ä¸Šä¸‹æ–‡ä¸­çš„å•è¯</li><li>2.Continuous Bag of Words(CBOW)ï¼šè¾“å…¥ä¸Šä¸‹æ–‡ä¸­çš„å•è¯å¹¶é¢„æµ‹ä¸­å¿ƒè¯</li></ul><p>ä¹‹å‰ä¸€ç›´ä½¿ç”¨naiveçš„softmax(ç®€å•ä½†ä»£ä»·å¾ˆé«˜çš„è®­ç»ƒæ–¹æ³•)ï¼Œå…¶å®å¯ä»¥ä½¿ç”¨è´Ÿé‡‡æ ·æ–¹æ³•åŠ å¿«è®­ç»ƒé€Ÿç‡</p><h2 id="è´Ÿä¾‹é‡‡æ ·çš„skip-gramæ¨¡å‹ä½œä¸š2">1.4è´Ÿä¾‹é‡‡æ ·çš„skip-gramæ¨¡å‹ï¼ˆä½œä¸š2ï¼‰</h2><p>softmaxä¸­ç”¨äºå½’ä¸€åŒ–çš„åˆ†æ¯çš„è®¡ç®—ä»£ä»·å¤ªé«˜</p><ul><li>æˆ‘ä»¬å°†åœ¨ä½œä¸š2ä¸­å®ç°ä½¿ç”¨ negative sampling/è´Ÿä¾‹é‡‡æ ·æ–¹æ³•çš„ skip-gramæ¨¡å‹ã€‚</li><li>ä½¿ç”¨ä¸€ä¸ª true pair (ä¸­å¿ƒè¯åŠå…¶ä¸Šä¸‹æ–‡çª—å£ä¸­çš„è¯)ä¸å‡ ä¸ª noise pair(ä¸­å¿ƒè¯ä¸éšæœºè¯æ­é…) å½¢æˆçš„æ ·æœ¬ï¼Œè®­ç»ƒäºŒå…ƒé€»è¾‘å›å½’ã€‚</li></ul><p>åŸæ–‡ä¸­çš„(æœ€å¤§åŒ–)ç›®æ ‡å‡½æ•°æ˜¯ï¼š<spanclass="math inline">\(J(\theta)=\frac{1}{T} \sum_{t=1}^{T}J_{t}(\theta)\)</span> <span class="math display">\[J_{t}(\theta)=\log \sigma\left(u_{o}^{T} v_{c}\right)+\sum_{i=1}^{k}\mathbb{E}_{j \sim P(w)}\left[\log \sigma\left(-u_{j}^{T}v_{c}\right)\right]\]</span></p><ul><li>å·¦ä¾§ä¸ºsigmoidå‡½æ•°(å¤§å®¶ä¼šåœ¨åç»­çš„å†…å®¹é‡Œç»å¸¸è§åˆ°å®ƒ)</li><li>æˆ‘ä»¬è¦æœ€å¤§åŒ–2ä¸ªè¯å…±ç°çš„æ¦‚ç‡</li></ul><p>æœ¬è¯¾ä»¥åŠä½œä¸šä¸­çš„ç›®æ ‡å‡½æ•°æ˜¯: <span class="math display">\[J_{n e g-s a m p l e}\left(\boldsymbol{o}, \boldsymbol{v}_{c},\boldsymbol{U}\right)=-\log \left(\sigma\left(\boldsymbol{u}_{o}^{\top}\boldsymbol{v}_{c}\right)\right)-\sum_{k=1}^{K} \log\left(\sigma\left(-\boldsymbol{u}_{k}^{\top}\boldsymbol{v}_{c}\right)\right)\]</span></p><ul><li>æˆ‘ä»¬å–<span class="math inline">\(K\)</span>ä¸ªè´Ÿä¾‹é‡‡æ ·</li><li>æœ€å¤§åŒ–çª—å£ä¸­åŒ…å›´ã€Œä¸­å¿ƒè¯ã€çš„è¿™äº›è¯è¯­å‡ºç°çš„æ¦‚ç‡ï¼Œè€Œæœ€å°åŒ–å…¶ä»–æ²¡æœ‰å‡ºç°çš„éšæœºè¯çš„æ¦‚ç‡</li><li><span class="math inline">\(P(w)=U(w)^{3 / 4} /Z\)</span>æˆ‘ä»¬ç”¨å·¦ä¾§çš„å…¬å¼è¿›è¡ŒæŠ½æ ·ï¼Œå…¶ä¸­<spanclass="math inline">\(U(w)\)</span>â€‹æ˜¯ unigram åˆ†å¸ƒ</li><li>é€šè¿‡ 3/4 æ¬¡æ–¹ï¼Œç›¸å¯¹å‡å°‘å¸¸è§å•è¯çš„é¢‘ç‡ï¼Œå¢å¤§ç¨€æœ‰è¯çš„æ¦‚ç‡</li><li><span class="math inline">\(Z\)</span>ç”¨äºç”Ÿæˆæ¦‚ç‡åˆ†å¸ƒ</li></ul><h1 id="è®¡æ•°ä¸å…±çº¿çŸ©é˜µ">2 è®¡æ•°ä¸å…±çº¿çŸ©é˜µ</h1><h2 id="å…±ç°çŸ©é˜µä¸è¯å‘é‡æ„å»º">2.1 å…±ç°çŸ©é˜µä¸è¯å‘é‡æ„å»º</h2><p>åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é‡Œå¦å¤–ä¸€ä¸ªæ„å»ºè¯å‘é‡çš„æ€è·¯æ˜¯å€ŸåŠ©äº<strong>å…±ç°çŸ©é˜µ</strong>ï¼ˆæˆ‘ä»¬è®¾å…¶ä¸º<spanclass="math inline">\(X\)</span>ï¼‰ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹å¼ï¼Œå¯ä»¥åŸºäºçª—å£ï¼ˆwindowï¼‰æˆ–è€…å…¨æ–‡æ¡£ï¼ˆfulldocument)ç»Ÿè®¡ï¼š</p><ul><li><strong>Window</strong>ï¼šä¸word2vecç±»ä¼¼ï¼Œåœ¨æ¯ä¸ªå•è¯å‘¨å›´éƒ½ä½¿ç”¨Windowï¼ŒåŒ…æ‹¬è¯­æ³•(POS)å’Œè¯­ä¹‰ä¿¡æ¯</li><li><strong>Word-document</strong>å…±ç°çŸ©é˜µçš„åŸºæœ¬å‡è®¾æ˜¯åœ¨åŒä¸€ç¯‡æ–‡ç« ä¸­å‡ºç°çš„å•è¯æ›´æœ‰å¯èƒ½ç›¸äº’å…³è”ã€‚å‡è®¾å•è¯<spanclass="math inline">\(i\)</span>å‡ºç°åœ¨æ–‡ç« <spanclass="math inline">\(j\)</span>ä¸­ï¼Œåˆ™çŸ©é˜µå…ƒç´ <spanclass="math inline">\(X_{ij}\)</span>åŠ ä¸€ï¼Œå½“æˆ‘ä»¬å¤„ç†å®Œæ•°æ®åº“ä¸­çš„æ‰€æœ‰æ–‡ç« åï¼Œå°±å¾—åˆ°äº†çŸ©é˜µ<spanclass="math inline">\(X\)</span>ï¼Œå…¶å¤§å°ä¸º<spanclass="math inline">\(|V| \times M\)</span>ï¼Œå…¶ä¸­<spanclass="math inline">\(|V|\)</span>ä¸ºè¯æ±‡é‡ï¼Œè€Œ<spanclass="math inline">\(M\)</span>ä¸ºæ–‡ç« æ•°ã€‚è¿™ä¸€æ„å»ºå•è¯æ–‡ç« co-occurrencematrixçš„æ–¹æ³•ä¹Ÿæ˜¯ç»å…¸çš„Latent SemanticAnalysisæ‰€é‡‡ç”¨çš„ã€è¯­ä¹‰åˆ†æã€‘ã€‚</li></ul><h2 id="åŸºäºçª—å£çš„å…±ç°çŸ©é˜µç¤ºä¾‹">2.2 åŸºäºçª—å£çš„å…±ç°çŸ©é˜µç¤ºä¾‹</h2><p>åˆ©ç”¨æŸä¸ªå®šé•¿çª—å£(é€šå¸¸å–5-10)ä¸­å•è¯ä¸å•è¯åŒæ—¶å‡ºç°çš„æ¬¡æ•°ï¼Œæ¥äº§ç”ŸåŸºäºçª—å£çš„å…±ç°çŸ©é˜µã€‚</p><p>ä¸‹é¢ä»¥çª—å£é•¿åº¦ä¸º1æ¥ä¸¾ä¾‹ï¼Œå‡è®¾æˆ‘ä»¬çš„æ•°æ®åŒ…å«ä»¥ä¸‹å‡ ä¸ªå¥å­ï¼š</p><ul><li>I like deep learning.</li><li>I like NLP.</li><li>I enjoy flying.</li></ul><p>æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„è¯è¯å…±ç°çŸ©é˜µï¼ˆword-word co-occurrence matrixï¼‰</p><p><img src="/img/nlp/ç¬¬äºŒè®²/1.png" /></p><h2 id="åŸºäºç›´æ¥çš„å…±ç°çŸ©é˜µæ„å»ºè¯å‘é‡çš„é—®é¢˜">2.3åŸºäºç›´æ¥çš„å…±ç°çŸ©é˜µæ„å»ºè¯å‘é‡çš„é—®é¢˜</h2><p>ç›´æ¥åŸºäºå…±ç°çŸ©é˜µæ„å»ºè¯å‘é‡ï¼Œä¼šæœ‰ä¸€äº›æ˜æ˜¾çš„é—®é¢˜ï¼Œå¦‚ä¸‹ï¼š</p><ul><li>ä½¿ç”¨å…±ç°æ¬¡æ•°è¡¡é‡å•è¯çš„ç›¸ä¼¼æ€§ï¼Œä½†æ˜¯ä¼šéšç€è¯æ±‡é‡çš„å¢åŠ è€Œå¢å¤§çŸ©é˜µçš„å¤§å°ã€‚</li><li>éœ€è¦å¾ˆå¤šç©ºé—´æ¥å­˜å‚¨è¿™ä¸€é«˜ç»´çŸ©é˜µã€‚</li><li>åç»­çš„åˆ†ç±»æ¨¡å‹ä¹Ÿä¼šç”±äºçŸ©é˜µçš„ç¨€ç–æ€§è€Œå­˜åœ¨ç¨€ç–æ€§é—®é¢˜ï¼Œä½¿å¾—æ•ˆæœä¸ä½³ã€‚</li></ul><h2 id="è§£å†³æ–¹æ¡ˆä½ç»´å‘é‡">2.4 è§£å†³æ–¹æ¡ˆï¼šä½ç»´å‘é‡</h2><p>é’ˆå¯¹ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬çš„ä¸€ä¸ªå¤„ç†æ–¹å¼æ˜¯é™ç»´ï¼Œè·å¾—ä½ç»´ç¨ å¯†å‘é‡ã€‚</p><ul><li>é€šå¸¸é™ç»´åˆ°(25-1000)ç»´ï¼Œå’Œword2vecç±»ä¼¼</li></ul><p>å¦‚ä½•é™ç»´å‘¢ï¼Ÿ</p><h2 id="æ–¹æ³•1å¯¹xè¿›è¡Œé™ç»´ä½œä¸š1">2.5 æ–¹æ³•1ï¼šå¯¹Xè¿›è¡Œé™ç»´ï¼ˆä½œä¸š1ï¼‰</h2><p>å¯ä»¥ä½¿ç”¨å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSVDï¼‰æ–¹æ³•å°†å…±ç°çŸ©é˜µ<spanclass="math inline">\(X\)</span>åˆ†è§£ä¸º<span class="math inline">\(U\Sigma V^{T}\)</span>ï¼Œå…¶ä¸­ï¼š</p><ul><li><spanclass="math inline">\(\Sigma\)</span>æ˜¯å¯¹è§’çº¿çŸ©é˜µï¼Œå¯¹è§’çº¿ä¸Šçš„å€¼æ˜¯çŸ©é˜µçš„å¥‡å¼‚å€¼</li><li><span class="math inline">\(U\)</span>ï¼Œ<spanclass="math inline">\(V\)</span>æ˜¯å¯¹åº”äºè¡Œå’Œåˆ—çš„æ­£äº¤åŸº</li></ul><p>ä¸ºäº†å‡å°‘å°ºåº¦åŒæ—¶å°½é‡ä¿å­˜æœ‰æ•ˆä¿¡æ¯ï¼Œå¯ä¿ç•™å¯¹è§’çŸ©é˜µçš„æœ€å¤§çš„<spanclass="math inline">\(k\)</span>ä¸ªå€¼ï¼Œå¹¶å°†çŸ©é˜µ<spanclass="math inline">\(U\)</span>ï¼Œ<spanclass="math inline">\(V\)</span>çš„ç›¸åº”çš„è¡Œåˆ—ä¿ç•™ã€‚</p><ul><li>è¿™æ˜¯ç»å…¸çš„çº¿æ€§ä»£æ•°ç®—æ³•ï¼Œå¯¹äºå¤§å‹çŸ©é˜µè€Œè¨€ï¼Œè®¡ç®—ä»£ä»·æ˜‚è´µã€‚</li></ul><h2 id="è¯å‘é‡svdåˆ†è§£çš„pythonä»£ç ç¤ºä¾‹">2.6è¯å‘é‡SVDåˆ†è§£çš„pythonä»£ç ç¤ºä¾‹</h2><p><img src="/img/nlp/ç¬¬äºŒè®²/2.png" /></p><p>å°†å‘é‡è¿›è¡Œå¯è§†åŒ–</p><p><img src="/img/nlp/ç¬¬äºŒè®²/3.png" /></p><h2 id="è®ºæ–‡è®²è§£">2.7 è®ºæ–‡è®²è§£</h2><h3 id="hacks-to-x-several-used-in-rohde-et-al.-2005">Hacks to X(several used in Rohde et al. 2005)</h3><p>æŒ‰æ¯”ä¾‹è°ƒæ•´ counts ä¼šå¾ˆæœ‰æ•ˆ</p><ul><li>å¯¹é«˜é¢‘è¯è¿›è¡Œç¼©æ”¾(è¯­æ³•æœ‰å¤ªå¤šçš„å½±å“)<ul><li>ä½¿ç”¨logè¿›è¡Œç¼©æ”¾</li><li><span class="math inline">\(\min (X, t), t \approx 100\)</span></li><li>ç›´æ¥å…¨éƒ¨å¿½è§†</li></ul></li><li>åœ¨åŸºäºwindowçš„è®¡æ•°ä¸­ï¼Œæé«˜æ›´åŠ æ¥è¿‘çš„å•è¯çš„è®¡æ•°</li><li>ä½¿ç”¨Personç›¸å…³ç³»æ•°</li></ul><h2 id="è¯å‘é‡åˆ†å¸ƒæ¢ç©¶">2.8 è¯å‘é‡åˆ†å¸ƒæ¢ç©¶</h2><p>å¦‚æœå¯¹è¯å‘é‡è¿›è¡Œç©ºé—´åˆ†å¸ƒï¼Œä¼šå‘ç°åŒä¸€ä¸ªè¯æ±‡çš„é™„è¿‘åˆ†å¸ƒç€å®ƒä¸åŒæ—¶æ€è¯­æ€çš„å•è¯ï¼š</p><ul><li><span class="math inline">\(dirve \to deriver\)</span></li><li><span class="math inline">\(swim \to swimmer\)</span></li><li><span class="math inline">\(teach \to teacher\)</span></li></ul><p>åœ¨å‘é‡ä¸­å‡ºç°çš„æœ‰è¶£çš„å¥æ³•æ¨¡å¼ï¼šè¯­ä¹‰å‘é‡åŸºæœ¬ä¸Šæ˜¯çº¿æ€§ç»„ä»¶ï¼Œè™½ç„¶æœ‰ä¸€äº›æ‘†åŠ¨ï¼Œä½†æ˜¯åŸºæœ¬æ˜¯å­˜åœ¨åŠ¨è¯å’ŒåŠ¨è¯å®æ–½è€…çš„æ–¹å‘ã€‚</p><h2 id="åŸºäºè®¡æ•°-vs.-åŸºäºé¢„ä¼°">2.9 åŸºäºè®¡æ•° VS. åŸºäºé¢„ä¼°</h2><p>æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹åŸºäºå…±ç°çŸ©é˜µè®¡æ•°å’ŒåŸºäºé¢„ä¼°æ¨¡å‹ä¸¤ç§å¾—åˆ°è¯å‘é‡çš„æ–¹å¼</p><p><strong>åŸºäºè®¡æ•°</strong>ï¼šä½¿ç”¨æ•´ä¸ªçŸ©é˜µçš„å…¨å±€ç»Ÿè®¡æ•°æ®æ¥ç›´æ¥ä¼°è®¡</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šè®­ç»ƒå¿«é€Ÿï¼›ç»Ÿè®¡æ•°æ®é«˜æ•ˆåˆ©ç”¨</li><li><strong>ç¼ºç‚¹</strong>ï¼šä¸»è¦ç”¨äºæ•æ‰å•è¯ç›¸ä¼¼æ€§ï¼›å¯¹å¤§é‡æ•°æ®ç»™äºˆæ¯”ä¾‹å¤±è°ƒçš„é‡è§†</li></ul><p><strong>åŸºäºé¢„ä¼°æ¨¡å‹</strong>ï¼šå®šä¹‰æ¦‚ç‡åˆ†å¸ƒå¹¶è¯•å›¾é¢„æµ‹å•è¯</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šæé«˜å…¶ä»–ä»»åŠ¡çš„æ€§èƒ½ï¼›èƒ½æ•è·é™¤äº†å•è¯ç›¸ä¼¼æ€§ä»¥å¤–çš„å¤æ‚çš„æ¨¡å¼</li><li><strong>ç¼ºç‚¹</strong>ï¼šéšè¯­æ–™åº“å¢å¤§ä¼šå¢å¤§è§„æ¨¡ï¼›ç»Ÿè®¡æ•°æ®çš„ä½æ•ˆä½¿ç”¨ï¼ˆé‡‡æ ·æ˜¯å¯¹ç»Ÿè®¡æ•°æ®çš„ä½æ•ˆä½¿ç”¨ï¼‰</li></ul><h1 id="gloveæ¨¡å‹">3 GloVeæ¨¡å‹</h1><h2 id="è®ºæ–‡è®²è§£-1">3.1 è®ºæ–‡è®²è§£</h2><h3 id="encoding-meaning-in-vector-differences">3.1.1 Encoding meaningin vector differences</h3><p>GloVeæ¨¡å‹å…³é”®æ€æƒ³ï¼šå…±ç°æ¦‚ç‡çš„æ¯”å€¼å¯ä»¥å¯¹meaningcomponentè¿›è¡Œç¼–ç ã€‚å°†ä¸¤ä¸ªæµæ´¾çš„æƒ³æ³•ç»“åˆèµ·æ¥ï¼Œåœ¨ç¥ç»ç½‘ç»œä¸­ä½¿ç”¨è®¡æ•°çŸ©é˜µã€‚</p><p><img src="/img/nlp/ç¬¬äºŒè®²/4.png" /></p><p>ä¾‹å¦‚æˆ‘ä»¬æƒ³åŒºåˆ†çƒ­åŠ›å­¦ä¸Šä¸¤ç§ä¸åŒçŠ¶æ€iceå†°ä¸è’¸æ±½steamï¼Œå¦‚æœåªæ˜¯çœ‹æ¦‚ç‡åˆ™æ•°å€¼å¾ˆå°ï¼Œä¸èƒ½é€éœ²æœ‰æ•ˆçš„ä¿¡æ¯ï¼Œä½†æ˜¯ä»–ä»¬çš„æ¯”å€¼æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥ä½¿ç”¨æ¯”å€¼æ›´èƒ½ä½“ç°ä¿¡æ¯ã€‚å›¾ä¸­å¯ä»¥çœ‹å‡ºsolidæ›´å¸¸æ¥æè¿°iceçš„çŠ¶æ€è€Œä¸æ˜¯steamï¼Œæ‰€ä»¥solidåœ¨iceçš„ä¸Šä¸‹æ–‡ä¸­å‡ºç°çš„å‡ ç‡æ›´å¤§ã€‚å¯¹äºgasåˆ™æ°æ°ç›¸åï¼Œè€Œå¯¹äºwaterè¿™ç§æè¿°iceä¸steamå‡å¯æˆ–è€…fashionè¿™ç§ä¸ä¸¤è€…éƒ½æ²¡ä»€ä¹ˆè”ç³»çš„å•è¯ï¼Œåˆ™æ¯”å€¼æ¥è¿‘äº1ã€‚æ‰€ä»¥ç›¸è¾ƒäºå•çº¯çš„å…±ç°æ¦‚ç‡ï¼Œå®é™…ä¸Šå…±ç°æ¦‚ç‡çš„ç›¸å¯¹æ¯”å€¼æ›´æœ‰æ„ä¹‰ã€‚</p><h3id="combining-the-best-of-both-worlds-glove-pennington-et-al.-emnlp-2014">3.1.2Combining the best of both worlds GloVe [Pennington et al., EMNLP2014]</h3><p><span class="math display">\[w_i \cdot w_j = \log P(i|j)\]</span></p><p><span class="math display">\[J=\sum_{i, j=1}^{V} f\left(X_{i j}\right)\left(w_{i}^{T}\tilde{w}_{j}+b_{i}+\tilde{b}_{j}-\log X_{i j}\right)^{2}\]</span></p><ul><li>è®­ç»ƒå¿«é€Ÿ</li><li>å¯ä»¥æ‰©å±•åˆ°å¤§å‹è¯­æ–™åº“</li><li>å³ä½¿æ˜¯å°è¯­æ–™åº“å’Œå°å‘é‡ï¼Œæ€§èƒ½ä¹Ÿå¾ˆå¥½</li></ul><h2 id="gloveçš„ä¸€äº›ç»“æœå±•ç¤º">3.2 GloVeçš„ä¸€äº›ç»“æœå±•ç¤º</h2><p>ä¸‹å›¾æ˜¯ä¸€ä¸ªGloVeè¯å‘é‡ç¤ºä¾‹ï¼Œæˆ‘ä»¬é€šè¿‡GloVeå¾—åˆ°çš„è¯å‘é‡ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°frogï¼ˆé’è›™ï¼‰æœ€æ¥è¿‘çš„ä¸€äº›è¯æ±‡ï¼Œå¯ä»¥çœ‹å‡ºå®ƒä»¬æœ¬èº«æ˜¯å¾ˆç±»ä¼¼çš„åŠ¨ç‰©ã€‚</p><p><img src="/img/nlp/ç¬¬äºŒè®²/5.png" /></p><h1 id="è¯å‘é‡ä¼°è®¡">4 è¯å‘é‡ä¼°è®¡</h1><h2 id="å¦‚ä½•è¯„ä¼°è¯å‘é‡">4.1 å¦‚ä½•è¯„ä¼°è¯å‘é‡ï¼Ÿ</h2><p>æˆ‘ä»¬å¦‚ä½•è¯„ä¼°è¯å‘é‡å‘¢ï¼Œæœ‰å†…åœ¨å’Œå¤–åœ¨ä¸¤ç§æ–¹å¼ï¼š</p><ul><li><strong>å†…åœ¨è¯„ä¼°æ–¹å¼</strong><ul><li>å¯¹ç‰¹å®š/ä¸­é—´å­ä»»åŠ¡è¿›è¡Œè¯„ä¼°</li><li>è®¡ç®—é€Ÿåº¦å¿«</li><li>æœ‰åŠ©äºç†è§£è¿™ä¸ªç³»ç»Ÿ</li><li>ä¸æ¸…æ¥šæ˜¯å¦çœŸçš„æœ‰ç”¨ï¼Œé™¤éä¸å®é™…ä»»åŠ¡å»ºç«‹äº†ç›¸å…³æ€§</li></ul></li><li><strong>å¤–éƒ¨ä»»åŠ¡æ–¹å¼</strong><ul><li>å¯¹çœŸå®ä»»åŠ¡ï¼ˆå¦‚ä¸‹æ¸¸NLPä»»åŠ¡ï¼‰çš„è¯„ä¼°</li><li>è®¡ç®—ç²¾ç¡®åº¦å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´</li><li>ä¸æ¸…æ¥šå­ç³»ç»Ÿé—®é¢˜æ‰€åœ¨ï¼Œæ˜¯äº¤äº’è¿˜æ˜¯å…¶ä»–å­ç³»ç»Ÿé—®é¢˜</li><li>å¦‚æœç”¨å¦ä¸€ä¸ªå­ç³»ç»Ÿæ›¿æ¢ä¸€ä¸ªå­ç³»ç»Ÿå¯ä»¥æé«˜ç²¾ç¡®åº¦</li></ul></li></ul><h2 id="å†…åœ¨è¯å‘é‡è¯„ä¼°">4.2 å†…åœ¨è¯å‘é‡è¯„ä¼°</h2><p>ä¸€ç§å†…åœ¨è¯å‘é‡è¯„ä¼°æ–¹å¼æ˜¯ã€Œ<strong>è¯å‘é‡ç±»æ¯”</strong>ã€ï¼šå¯¹äºå…·å¤‡æŸç§å…³ç³»çš„è¯å¯¹a,bï¼Œåœ¨ç»™å®šè¯cçš„æƒ…å†µä¸‹ï¼Œæ‰¾åˆ°å…·å¤‡ç±»ä¼¼å…³ç³»çš„è¯d<span class="math display">\[a: b:: c: ? \rightarrow d=\arg \max _{i}\frac{\left(x_{b}-x_{a}+x_{c}\right)^{T}x_{i}}{\left\|x_{b}-x_{a}+x_{c}\right\|}\]</span></p><ul><li>é€šè¿‡åŠ æ³•åçš„ä½™å¼¦è·ç¦»æ˜¯å¦èƒ½å¾ˆå¥½åœ°æ•æ‰åˆ°ç›´è§‚çš„è¯­ä¹‰å’Œå¥æ³•ç±»æ¯”é—®é¢˜æ¥è¯„ä¼°å•è¯å‘é‡</li><li>ä»æœç´¢ä¸­ä¸¢å¼ƒè¾“å…¥çš„å•è¯</li><li>é—®é¢˜:å¦‚æœæœ‰ä¿¡æ¯ä½†ä¸æ˜¯çº¿æ€§çš„æ€ä¹ˆåŠï¼Ÿ</li></ul><h2 id="gloveå¯è§†åŒ–æ•ˆæœ">4.3 Gloveå¯è§†åŒ–æ•ˆæœ</h2><p>ä¸‹å›¾ä¸ºGloVeå¾—åˆ°çš„è¯å‘é‡ç©ºé—´åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯¹è¯å‘é‡è¿›è¡Œå‡æ³•è®¡ç®—ï¼Œå¯ä»¥å‘ç°ç±»æ¯”çš„è¯å¯¹æœ‰ç›¸ä¼¼çš„è·ç¦»ã€‚</p><p>brother â€“ sister, man â€“ woman, king - queen</p><p><img src="/img/nlp/ç¬¬äºŒè®²/6.png" /></p><h2 id="ç±»æ¯”ä»»åŠ¡è¯„ä¼°ä¸è¶…å‚æ•°">4.4 ç±»æ¯”ä»»åŠ¡è¯„ä¼°ä¸è¶…å‚æ•°</h2><p><img src="/img/nlp/ç¬¬äºŒè®²/7.png" /></p><p><img src="/img/nlp/ç¬¬äºŒè®²/8.png" /></p><ul><li>æ•°æ®é›†è¶Šå¤§è¶Šå¥½ï¼Œå¹¶ä¸”ç»´åŸºç™¾ç§‘æ•°æ®é›†æ¯”æ–°é—»æ–‡æœ¬æ•°æ®é›†è¦å¥½</li><li>300æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¯å‘é‡ç»´åº¦</li></ul><h2 id="å¦ä¸€ä¸ªå†…åœ¨çš„è¯å‘é‡è¯„ä¼°">4.5 å¦ä¸€ä¸ªå†…åœ¨çš„è¯å‘é‡è¯„ä¼°</h2><p><img src="/img/nlp/ç¬¬äºŒè®²/9.png" /></p><h2 id="ç›¸å…³æ€§è¯„ä¼°">4.6 ç›¸å…³æ€§è¯„ä¼°</h2><h3 id="section"><img src="/img/nlp/ç¬¬äºŒè®²/10.png" /></h3><h1 id="word-senses">5 word senses</h1><h2 id="è¯ä¹‰ä¸è¯ä¹‰æ­§ä¹‰">5.1 è¯ä¹‰ä¸è¯ä¹‰æ­§ä¹‰</h2><p>å¤§å¤šæ•°å•è¯éƒ½æ˜¯å¤šä¹‰çš„</p><ul><li>ç‰¹åˆ«æ˜¯å¸¸è§å•è¯</li><li>ç‰¹åˆ«æ˜¯å­˜åœ¨å·²ä¹…çš„å•è¯</li></ul><p>ä¾‹å¦‚ï¼špike</p><p>é‚£ä¹ˆï¼Œè¯å‘é‡æ˜¯æ€»ä½“æ•æ‰äº†æ‰€æœ‰è¿™äº›ä¿¡æ¯ï¼Œè¿˜æ˜¯æ‚ä¹±åœ¨ä¸€èµ·äº†å‘¢ï¼Ÿ</p><h2 id="pikeçš„ä¸åŒå«ä¹‰ç¤ºä¾‹">5.2 pikeçš„ä¸åŒå«ä¹‰ç¤ºä¾‹</h2><p><img src="/img/nlp/ç¬¬äºŒè®²/11.png" /></p><h2 id="è®ºæ–‡è®²è§£-2">5.3 è®ºæ–‡è®²è§£</h2><h3id="improving-word-representations-via-global-context-and-multiple-word-prototypes-huang-et-al.-2012">5.3.1Improving Word Representations Via Global Context And Multiple WordPrototypes (Huang et al. 2012)</h3><p><img src="/img/nlp/ç¬¬äºŒè®²/12.png" /></p><p>å°†å¸¸ç”¨è¯çš„æ‰€æœ‰ä¸Šä¸‹æ–‡è¿›è¡Œèšç±»ï¼Œé€šè¿‡è¯¥è¯å¾—åˆ°ä¸€äº›æ¸…æ™°çš„ç°‡ï¼Œä»è€Œå°†è¿™ä¸ªå¸¸ç”¨è¯åˆ†è§£ä¸ºå¤šä¸ªå•è¯ï¼Œä¾‹å¦‚bank1ã€bank2</p><h3id="linear-algebraic-structure-of-word-senses-with-applications-to-polysemy">5.3.2Linear Algebraic Structure of Word Senses, with Applications toPolysemy</h3><ul><li>å•è¯åœ¨æ ‡å‡†å•è¯åµŒå…¥(å¦‚word2vec)ä¸­çš„ä¸åŒå«ä¹‰ä»¥çº¿æ€§å åŠ (åŠ æƒå’Œ)çš„å½¢å¼å­˜åœ¨</li></ul><p><span class="math display">\[v_{pike} = \alpha_1 v_{pike_1} + \alpha_2 v_{pike_2} + \alpha_3v_{pike_3}\]</span></p><ul><li>å…¶ä¸­ï¼Œ<span class="math inline">\(\alpha =\frac{f_{1}}{f_{1}+f_{2}+f_{3}}\)</span></li></ul><p>ä»¤äººæƒŠè®¶çš„ç»“æœï¼š</p><ul><li>åªæ˜¯åŠ æƒå¹³å‡å€¼å°±å·²ç»å¯ä»¥è·å¾—å¾ˆå¥½çš„æ•ˆæœ</li><li>ç”±äºä»ç¨€ç–ç¼–ç ä¸­å¾—åˆ°çš„æ¦‚å¿µï¼Œä½ å®é™…ä¸Šå¯ä»¥å°†æ„Ÿå®˜åˆ†ç¦»å‡ºæ¥(å‰ææ˜¯å®ƒä»¬ç›¸å¯¹æ¯”è¾ƒå¸¸è§)</li></ul><h2 id="å¤–å‘è¯å‘é‡è¯„ä¼°">5.4 å¤–å‘è¯å‘é‡è¯„ä¼°</h2><ul><li>å•è¯å‘é‡çš„å¤–éƒ¨è¯„ä¼°ï¼šè¯å‘é‡å¯ä»¥åº”ç”¨äºNLPçš„å¾ˆå¤šä¸‹æ¸¸ä»»åŠ¡</li><li>ä¸€ä¸ªä¾‹å­æ˜¯åœ¨å‘½åå®ä½“è¯†åˆ«ä»»åŠ¡ä¸­ï¼Œå¯»æ‰¾äººåã€æœºæ„åã€åœ°ç†ä½ç½®åï¼Œè¯å‘é‡éå¸¸æœ‰å¸®åŠ©</li></ul><p><img src="/img/nlp/ç¬¬äºŒè®²/13.png" /></p>]]></content>
    
    
    <categories>
      
      <category>Deep Learning</category>
      
      <category>NLP</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å›æº¯</title>
    <link href="/2022/05/03/%E5%9B%9E%E6%BA%AF/"/>
    <url>/2022/05/03/%E5%9B%9E%E6%BA%AF/</url>
    
    <content type="html"><![CDATA[<h2 id="ç”µè¯å·ç çš„å­—æ¯ç»„åˆ">17ã€ç”µè¯å·ç çš„å­—æ¯ç»„åˆ</h2><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/17.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">letterCombinations</span>(<span class="hljs-params">self, digits: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:<br>        <span class="hljs-keyword">if</span> digits == <span class="hljs-string">&#x27;&#x27;</span>:<br>            <span class="hljs-keyword">return</span> []<br><br>        phoneMap = &#123;<br>        <span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-string">&#x27;abc&#x27;</span>,<br>        <span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-string">&#x27;def&#x27;</span>,<br>        <span class="hljs-string">&#x27;4&#x27;</span>: <span class="hljs-string">&#x27;ghi&#x27;</span>,<br>        <span class="hljs-string">&#x27;5&#x27;</span>: <span class="hljs-string">&#x27;jkl&#x27;</span>,<br>        <span class="hljs-string">&#x27;6&#x27;</span>: <span class="hljs-string">&#x27;mno&#x27;</span>,<br>        <span class="hljs-string">&#x27;7&#x27;</span>: <span class="hljs-string">&#x27;pqrs&#x27;</span>,<br>        <span class="hljs-string">&#x27;8&#x27;</span>: <span class="hljs-string">&#x27;tuv&#x27;</span>,<br>        <span class="hljs-string">&#x27;9&#x27;</span>: <span class="hljs-string">&#x27;wxyz&#x27;</span>,   <br>        &#125;<br>        <br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">index: <span class="hljs-built_in">int</span></span>):<span class="hljs-comment"># å›æº¯</span><br>            <span class="hljs-keyword">if</span> index == <span class="hljs-built_in">len</span>(digits):<br>                combinations.append(<span class="hljs-string">&#x27;&#x27;</span>.join(combination))<br>            <span class="hljs-keyword">else</span>:<br>                digit = digits[index]<br>                <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> phoneMap[digit]:<br>                    combination.append(ch)<br>                    backtrack(index + <span class="hljs-number">1</span>)<br>                    combination.pop()<br><br>        combination = <span class="hljs-built_in">list</span>()<br>        combinations = <span class="hljs-built_in">list</span>()<br>        backtrack(<span class="hljs-number">0</span>)<br><br>        <span class="hljs-keyword">return</span> combinations<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬ä¸€è®²-NLPä»‹ç»ä¸è¯å‘é‡åˆæ­¥</title>
    <link href="/2022/05/01/%E7%AC%AC%E4%B8%80%E8%AE%B2-NLP%E4%BB%8B%E7%BB%8D%E4%B8%8E%E8%AF%8D%E5%90%91%E9%87%8F%E5%88%9D%E6%AD%A5/"/>
    <url>/2022/05/01/%E7%AC%AC%E4%B8%80%E8%AE%B2-NLP%E4%BB%8B%E7%BB%8D%E4%B8%8E%E8%AF%8D%E5%90%91%E9%87%8F%E5%88%9D%E6%AD%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="è‡ªç„¶è¯­è¨€ä¸è¯æ±‡å«ä¹‰">1 è‡ªç„¶è¯­è¨€ä¸è¯æ±‡å«ä¹‰</h1><h2 id="å¦‚ä½•åœ¨è®¡ç®—æœºé‡Œè¡¨è¾¾è¯çš„æ„ä¹‰">1.1 å¦‚ä½•åœ¨è®¡ç®—æœºé‡Œè¡¨è¾¾è¯çš„æ„ä¹‰</h2><p>è¦ä½¿ç”¨è®¡ç®—æœºå¤„ç†æ–‡æœ¬è¯æ±‡ï¼Œä¸€ç§å¤„ç†æ–¹å¼æ˜¯<strong>WordNet</strong>ï¼šå³æ„å»ºä¸€ä¸ªåŒ…å«åŒä¹‰è¯é›†å’Œä¸Šä½è¯(â€œisaâ€å…³ç³»)çš„åˆ—è¡¨çš„è¾å…¸ã€‚è‹±æ–‡å½“ä¸­ç¡®å®æœ‰è¿™æ ·ä¸€ä¸ªwordnetï¼Œæˆ‘ä»¬åœ¨å®‰è£…å®ŒNLTKå·¥å…·åº“å’Œä¸‹è½½æ•°æ®åŒ…åå¯ä»¥ä½¿ç”¨ï¼Œå¯¹åº”çš„ pythonä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> nltk.corpus <span class="hljs-keyword">import</span> wordnet <span class="hljs-keyword">as</span> wn<br>poses = &#123; <span class="hljs-string">&#x27;n&#x27;</span>:<span class="hljs-string">&#x27;noun&#x27;</span>, <span class="hljs-string">&#x27;v&#x27;</span>:<span class="hljs-string">&#x27;verb&#x27;</span>, <span class="hljs-string">&#x27;s&#x27;</span>:<span class="hljs-string">&#x27;adj (s)&#x27;</span>, <span class="hljs-string">&#x27;a&#x27;</span>:<span class="hljs-string">&#x27;adj&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>:<span class="hljs-string">&#x27;adv&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> synset <span class="hljs-keyword">in</span> wn.synsets(<span class="hljs-string">&quot;good&quot;</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;: &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(poses[synset.pos()], <span class="hljs-string">&quot;, &quot;</span>.join([l.name() <span class="hljs-keyword">for</span> l <span class="hljs-keyword">in</span> synset.lemmas()])))<br>        <br><span class="hljs-keyword">from</span> nltk.corpus <span class="hljs-keyword">import</span> wordnet <span class="hljs-keyword">as</span> wn<br>panda = wn.synset(<span class="hljs-string">&quot;panda.n.01&quot;</span>)<br>hyper = <span class="hljs-keyword">lambda</span> s: s.hypernyms()<br><span class="hljs-built_in">list</span>(panda.closure(hyper))<br></code></pre></div></td></tr></table></figure><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">noun: good<br>noun: good, goodness<br>noun: good, goodness<br>noun: commodity, trade_good, good<br>adj: good<br>adj (sat): full, good<br>adj: good<br>adj (sat): estimable, good, honorable, respectable<br>adj (sat): beneficial, good<br>adj (sat): good<br>adj (sat): good, just, upright<br>â€¦<br>adverb: well, good<br>adverb: thoroughly, soundly, good<br></code></pre></div></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[Synset(&#x27;procyonid.n.01&#x27;),<br>Synset(&#x27;carnivore.n.01&#x27;),<br>Synset(&#x27;placental.n.01&#x27;),<br>Synset(&#x27;mammal.n.01&#x27;),<br>Synset(&#x27;vertebrate.n.01&#x27;),<br>Synset(&#x27;chordate.n.01&#x27;),<br>Synset(&#x27;animal.n.01&#x27;),<br>Synset(&#x27;organism.n.01&#x27;),<br>Synset(&#x27;living_thing.n.01&#x27;),<br>Synset(&#x27;whole.n.02&#x27;),<br>Synset(&#x27;object.n.01&#x27;),<br>Synset(&#x27;physical_entity.n.01&#x27;),<br>Synset(&#x27;entity.n.01&#x27;)]<br></code></pre></div></td></tr></table></figure><h2 id="wordnetçš„é—®é¢˜">1.2 WordNetçš„é—®é¢˜</h2><ul><li><p>ä½œä¸ºä¸€ä¸ªèµ„æºå¾ˆå¥½ï¼Œä½†å¿½ç•¥äº†ç»†å¾®å·®åˆ«ã€‚ä¾‹å¦‚â€œproficientâ€è¢«åˆ—ä¸ºâ€œgoodâ€çš„åŒä¹‰è¯ï¼Œè¿™åªæ˜¯åœ¨ä¸€äº›ä¸Šä¸‹æ–‡ä¸­æ˜¯æ­£ç¡®çš„ã€‚</p></li><li><p>ç¼ºå°‘å•è¯çš„æ–°å«ä¹‰ï¼Œéš¾ä»¥æŒç»­æ›´æ–°ã€‚</p></li><li><p>æ˜¯ä¸»è§‚çš„ï¼Œéœ€è¦äººä»¬æ¥åˆ›é€ å’Œè°ƒæ•´ï¼Œæ— æ³•è®¡ç®—å•è¯ç›¸ä¼¼åº¦ã€‚</p></li></ul><h2 id="æ–‡æœ¬è¯æ±‡çš„ç¦»æ•£è¡¨å¾">1.3 æ–‡æœ¬(è¯æ±‡)çš„ç¦»æ•£è¡¨å¾</h2><p>åœ¨ä¼ ç»Ÿçš„è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œæˆ‘ä»¬ä¼šå¯¹æ–‡æœ¬åšç¦»æ•£è¡¨å¾ï¼ŒæŠŠè¯è¯­çœ‹ä½œç¦»æ•£çš„ç¬¦å·ï¼šä¾‹å¦‚hotelã€conferenceã€motelç­‰ã€‚</p><p>one-hot vectoræ˜¯åªæœ‰ä¸€ä¸ª1ï¼Œå…¶ä½™å…¨ä¸ºé›¶çš„ç¨€ç–å‘é‡ï¼Œå•è¯å¯ä»¥é€šè¿‡one-hotvectoræ¥è¡¨ç¤ºï¼š <span class="math display">\[\text { motel }=\left[\begin{array}{lllllllllllllll}0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp;0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\end{array}\right]\]</span></p><p><span class="math display">\[\text { hotel }=\left[\begin{array}{lllllllllllllll}0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp;0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\end{array}\right]\]</span></p><p>åœ¨one-hot vectorä¸­å‘é‡ç»´åº¦ = è¯æ±‡é‡ï¼ˆå¦‚500ï¼Œ000ï¼‰</p><h2 id="ç¦»æ•£è¡¨å¾çš„é—®é¢˜">1.4 ç¦»æ•£è¡¨å¾çš„é—®é¢˜</h2><p>åœ¨ä¸Šè¿°çš„ç‹¬çƒ­å‘é‡ç¦»æ•£è¡¨å¾é‡Œï¼Œæ‰€æœ‰è¯å‘é‡æ˜¯æ­£äº¤çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ã€‚å¯¹äºç‹¬çƒ­å‘é‡ï¼Œæ²¡æœ‰å…³äºç›¸ä¼¼æ€§æ¦‚å¿µï¼Œå¹¶ä¸”å‘é‡ç»´åº¦è¿‡å¤§ã€‚</p><p>å¯¹äºä¸Šè¿°é—®é¢˜æœ‰ä¸€äº›è§£å†³æ€è·¯ï¼š</p><ul><li>â‘ ä½¿ç”¨ç±»ä¼¼WordNetçš„å·¥å…·ä¸­çš„åˆ—è¡¨ï¼Œè·å¾—ç›¸ä¼¼åº¦ï¼Œä½†ä¼šå› ä¸å¤Ÿå®Œæ•´è€Œå¤±è´¥</li><li>â‘¡ é€šè¿‡å¤§é‡æ•°æ®å­¦ä¹ è¯å‘é‡æœ¬èº«ç›¸ä¼¼æ€§ï¼Œè·å¾—æ›´ç²¾ç¡®çš„ç¨ å¯†è¯å‘é‡ç¼–ç </li></ul><h2 id="åŸºäºä¸Šä¸‹æ–‡çš„è¯æ±‡è¡¨å¾">1.5 åŸºäºä¸Šä¸‹æ–‡çš„è¯æ±‡è¡¨å¾</h2><p><strong>è¿‘å¹´æ¥åœ¨æ·±åº¦å­¦ä¹ ä¸­æ¯”è¾ƒæœ‰æ•ˆçš„æ–¹å¼æ˜¯åŸºäºä¸Šä¸‹æ–‡çš„è¯æ±‡è¡¨å¾</strong>ã€‚å®ƒçš„<strong>æ ¸å¿ƒæƒ³æ³•</strong>æ˜¯ï¼šä¸€ä¸ªå•è¯çš„æ„æ€æ˜¯ç”±ç»å¸¸å‡ºç°åœ¨å®ƒé™„è¿‘çš„å•è¯ç»™å‡ºçš„</p><p>è¿™æ˜¯ç°ä»£ç»Ÿè®¡NLPæœ€æˆåŠŸçš„ç†å¿µä¹‹ä¸€ï¼Œæ€»ä½“æ€è·¯æœ‰ç‚¹ç‰©ä»¥ç±»èšï¼Œäººä»¥ç¾¤åˆ†çš„æ„Ÿè§‰ã€‚</p><ul><li>å½“ä¸€ä¸ªå•è¯<spanclass="math inline">\(w\)</span>å‡ºç°åœ¨æ–‡æœ¬ä¸­æ—¶ï¼Œå®ƒçš„ä¸Šä¸‹æ–‡æ˜¯å‡ºç°åœ¨å…¶é™„è¿‘çš„ä¸€ç»„å•è¯(åœ¨ä¸€ä¸ªå›ºå®šå¤§å°çš„çª—å£ä¸­)</li><li>åŸºäºæµ·é‡æ•°æ®ï¼Œä½¿ç”¨<spanclass="math inline">\(w\)</span>çš„è®¸å¤šä¸Šä¸‹æ–‡æ¥æ„å»º<spanclass="math inline">\(w\)</span>çš„è¡¨ç¤º</li></ul><h1 id="word-vectors">2 Word Vectors</h1><h2 id="è¯å‘é‡è¡¨ç¤º">2.1 è¯å‘é‡è¡¨ç¤º</h2><p><strong>Word2vec</strong> (Mikolov et al.2013)æ˜¯ä¸€ä¸ªå­¦ä¹ è¯å‘é‡è¡¨å¾çš„æ¡†æ¶ã€‚</p><ul><li><strong>æ ¸å¿ƒæ€è·¯</strong>å¦‚ä¸‹ï¼š<ul><li>åŸºäºæµ·é‡æ–‡æœ¬è¯­æ–™åº“æ„å»º</li><li>è¯æ±‡è¡¨ä¸­çš„æ¯ä¸ªå•è¯éƒ½ç”±ä¸€ä¸ªå‘é‡è¡¨ç¤ºï¼ˆå­¦ä¹ å®Œæˆåä¼šå›ºå®šï¼‰</li><li>å¯¹åº”è¯­æ–™åº“æ–‡æœ¬ä¸­çš„æ¯ä¸ªä½ç½®<spanclass="math inline">\(t\)</span>ï¼Œæœ‰ä¸€ä¸ªä¸­å¿ƒè¯<spanclass="math inline">\(c\)</span>å’Œä¸€äº›ä¸Šä¸‹æ–‡(â€œå¤–éƒ¨â€)å•è¯<spanclass="math inline">\(o\)</span></li><li>ä½¿ç”¨<span class="math inline">\(c\)</span>å’Œ<spanclass="math inline">\(o\)</span>çš„è¯å‘é‡æ¥è®¡ç®—æ¦‚ç‡<spanclass="math inline">\(P(o|c)\)</span>ï¼Œå³ç»™å®šä¸­å¿ƒè¯æ¨æ–­ä¸Šä¸‹æ–‡è¯æ±‡çš„æ¦‚ç‡ï¼ˆåä¹‹äº¦ç„¶ï¼‰</li><li>ä¸æ–­è°ƒæ•´è¯å‘é‡æ¥æœ€å¤§åŒ–è¿™ä¸ªæ¦‚ç‡</li></ul></li></ul><p><img src="/img/nlp/3.png" /></p><h1 id="word2vec-ç›®æ ‡å‡½æ•°">3 Word2vec ç›®æ ‡å‡½æ•°</h1><h2 id="ä¼¼ç„¶å‡½æ•°">3.1 ä¼¼ç„¶å‡½æ•°</h2><p>å¯¹äºæ¯ä¸ªä½ç½®t = 1, â€¦ , T, åœ¨å¤§å°ä¸º<spanclass="math inline">\(m\)</span>çš„å›ºå®šçª—å£å†…é¢„æµ‹ä¸Šä¸‹æ–‡å•è¯ï¼Œç»™å®šä¸­å¿ƒè¯<spanclass="math inline">\(w_j\)</span>ï¼Œä¼¼ç„¶å‡½æ•°å¯ä»¥è¡¨ç¤ºä¸ºï¼š <spanclass="math display">\[Likelihood = L(\theta) = \prod_{t=1}^{T} \prod_{\substack{-m \leq j \leqm \\ j \neq 0}}P(w_{t+j}|w_t;\theta)\]</span></p><p>ä¸Šè¿°å…¬å¼ä¸­ï¼Œ<spanclass="math inline">\(\theta\)</span>ä¸ºæ¨¡å‹åŒ…å«çš„æ‰€æœ‰å¾…ä¼˜åŒ–æƒé‡å˜é‡</p><h2 id="ç›®æ ‡å‡½æ•°">3.2 ç›®æ ‡å‡½æ•°</h2><p>å¯¹åº”ä¸Šè¿°ä¼¼ç„¶å‡½æ•°çš„ç›®æ ‡å‡½<spanclass="math inline">\(J(\theta)\)</span>å¯ä»¥å–ä½œ(å¹³å‡)è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼š <spanclass="math display">\[Likelihood=-\frac1T \log L(\theta)=-\frac1T \sum_{t=1}^{T}\sum_{\substack{-m \leq j \leq m \\ j \neq 0}} \logP(w_{t+j}|w_t;\theta)\]</span></p><p>æ³¨æ„ï¼š</p><ul><li>ç›®æ ‡å‡½æ•°<spanclass="math inline">\(J(\theta)\)</span>æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºâ€œ<strong>ä»£ä»·å‡½æ•°</strong>â€æˆ–â€œ<strong>æŸå¤±å‡½æ•°</strong>â€</li><li>æœ€å°åŒ–ç›®æ ‡å‡½æ•°ä¸æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°ï¼ˆé¢„æµ‹æ¦‚ç‡/ç²¾åº¦ï¼‰<strong>ä¸¤è€…ç­‰ä»·</strong></li></ul><p>å¾—åˆ°ç›®æ ‡å‡½æ•°åï¼Œæˆ‘ä»¬å¸Œæœ›æœ€å°åŒ–ç›®æ ‡å‡½æ•°ï¼Œé‚£æˆ‘ä»¬å¦‚ä½•è®¡ç®—<spanclass="math inline">\(P(w_{t+j}|w_t;\theta)\)</span>?</p><p>å¯¹äºæ¯ä¸ªè¯<span class="math inline">\(w\)</span>éƒ½ä¼šç”¨ä¸¤ä¸ªå‘é‡ï¼š</p><ul><li>å½“<spanclass="math inline">\(w\)</span>æ˜¯ä¸­å¿ƒè¯æ—¶ï¼Œæˆ‘ä»¬æ ‡è®°è¯å‘é‡ä¸º<spanclass="math inline">\(v_w\)</span></li><li>å½“<spanclass="math inline">\(w\)</span>æ˜¯ä¸Šä¸‹æ–‡è¯æ—¶ï¼Œæˆ‘ä»¬æ ‡è®°è¯å‘é‡ä¸º<spanclass="math inline">\(u_w\)</span></li></ul><p>åˆ™å¯¹äºä¸€ä¸ªä¸­å¿ƒè¯<spanclass="math inline">\(c\)</span>å’Œä¸€ä¸ªä¸Šä¸‹æ–‡è¯<spanclass="math inline">\(o\)</span>ï¼Œæˆ‘ä»¬æœ‰å¦‚ä¸‹æ¦‚ç‡è®¡ç®—å…¬å¼ <spanclass="math display">\[P(o \mid c)=\frac{\exp \left(u_{o}^{T} v_{c}\right)}{\sum_{w \in V} \exp\left(u_{w}^{T} v_{c}\right)}\]</span></p><ul><li>å¯¹<spanclass="math inline">\(u_o^Tv_c\)</span>æ˜¯å°†ä¸¤ä¸ªå‘é‡è¿›è¡Œç‚¹ç§¯ï¼Œä¸ºäº†è®¡ç®—ä¸¤ä¸ªè¯å‘é‡çš„ç›¸ä¼¼åº¦ï¼Œç‚¹ç§¯çš„ç»“æœè¶Šå¤§ï¼Œé‚£ä¹ˆç›¸ä¼¼åº¦è¶Šå¤§ã€‚</li><li>æ¨¡å‹çš„è®­ç»ƒæ­£æ˜¯ä¸ºäº†ä½¿å¾—å…·æœ‰ç›¸ä¼¼ä¸Šä¸‹æ–‡çš„å•è¯ï¼Œå…·æœ‰ç›¸ä¼¼çš„å‘é‡</li><li>ç‚¹ç§¯æ˜¯è®¡ç®—ç›¸ä¼¼æ€§çš„ä¸€ç§ç®€å•æ–¹æ³•ï¼Œåœ¨æ³¨æ„åŠ›æœºåˆ¶ä¸­å¸¸ä½¿ç”¨ç‚¹ç§¯è®¡ç®—Score</li></ul><h1 id="word2vecé¢„æµ‹å‡½æ•°">4 Word2vecé¢„æµ‹å‡½æ•°</h1><p>è¿™ä¹Ÿå°±æ˜¯softmax function(<spanclass="math inline">\(R^n\Rightarrow(0,1)^n\)</span>â€‹)çš„ä¸€ä¸ªä¾‹å­ï¼Œå°†<spanclass="math inline">\(x_i\)</span>æ˜ å°„åˆ°<spanclass="math inline">\(p_i\)</span>ï¼š <span class="math display">\[\operatorname{softmax}\left(x_{i}\right)=\frac{\exp\left(x_{i}\right)}{\sum_{j=1}^{n} \exp \left(x_{j}\right)}=p_{i}\]</span> ä¸ºäº†è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬å°±è¦æ‰¾å‡ºå‚æ•°æœ€å°åŒ–losså‡½æ•°</p><ul><li><p>Recallï¼š<spanclass="math inline">\(\theta\)</span>é€šè¿‡ä¸€ä¸ªé•¿å‘é‡æ¥ä»£è¡¨æ‰€æœ‰çš„æ¨¡å‹å‚æ•°</p></li><li><p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå¯¹äºdç»´å‘é‡å’ŒVä¸ªå•è¯ï¼Œæˆ‘ä»¬å¾—å‡ºï¼š</p></li><li><p><span class="math display">\[\theta=\left[\begin{array}{l}v_{\text {aardvark }} \\v_{a} \\\vdots \\v_{z e b r a} \\u_{a a r d v a r k} \\u_{a} \\\vdots \\u_{z e b r a}\end{array}\right] \in \mathbb{R}^{2 d V}\]</span></p></li><li><p>æ‰€ä»¥æˆ‘ä»¬æ¯ä¸ªå•è¯æœ‰ä¸¤ä¸ªå‘é‡</p></li></ul><p>æˆ‘ä»¬å°±éœ€è¦è®¡ç®—æ‰€æœ‰å‘é‡çš„æ¢¯åº¦è¿›è¡Œæ¢¯åº¦ä¸‹é™ç®—æ³•æ¥æœ€å°åŒ–losså‡½æ•°</p>]]></content>
    
    
    <categories>
      
      <category>Deep Learning</category>
      
      <category>NLP</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åŒæŒ‡é’ˆ</title>
    <link href="/2022/05/01/%E5%8F%8C%E6%8C%87%E9%92%88/"/>
    <url>/2022/05/01/%E5%8F%8C%E6%8C%87%E9%92%88/</url>
    
    <content type="html"><![CDATA[<h2 id="ç››æ°´æœ€å¤šçš„å®¹å™¨">11ã€ç››æ°´æœ€å¤šçš„å®¹å™¨</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/3.png" /></p><p>æˆ‘ä»¬ä½¿ç”¨åŒæŒ‡é’ˆçš„æ€æƒ³ï¼Œä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«ä¸ºæ•°ç»„çš„å¤´å°¾ç»“ç‚¹ï¼Œæ¯è½®éƒ½è¿›è¡Œé¢ç§¯çš„è®¡ç®—ï¼Œå¹¶ä¸”æ¯è½®åªç§»åŠ¨è¾ƒå°ç»“ç‚¹çš„æŒ‡é’ˆã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">maxArea</span>(<span class="hljs-params">self, height: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-built_in">int</span>:<br>        n = <span class="hljs-built_in">len</span>(height)<br>        left = <span class="hljs-number">0</span>    <span class="hljs-comment"># å·¦æŒ‡é’ˆ</span><br>        right = n - <span class="hljs-number">1</span>   <span class="hljs-comment"># å³æŒ‡é’ˆ</span><br>        max_s = <span class="hljs-number">0</span>   <span class="hljs-comment"># é¢ç§¯æœ€å¤§å€¼</span><br>        s = <span class="hljs-number">0</span>   <span class="hljs-comment"># é¢ç§¯</span><br>        l = <span class="hljs-number">0</span>   <span class="hljs-comment"># è¾¹é•¿</span><br>        <span class="hljs-keyword">while</span> right &gt; left:<br>            <span class="hljs-keyword">if</span> height[left] &gt; height[right]:<br>                l = height[right]<br>            <span class="hljs-keyword">else</span>:<br>                l = height[left]<br>            s = (right - left) * l<br>            <span class="hljs-keyword">if</span> s &gt; max_s:<br>                max_s = s<br>            <span class="hljs-keyword">if</span> height[left] &gt; height[right]:<br>                right = right - <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                left = left + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> max_s<br></code></pre></div></td></tr></table></figure><h2 id="ä¸‰æ•°ä¹‹å’Œ">15ã€ä¸‰æ•°ä¹‹å’Œ</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/15.png" /></p><p>é‡‡ç”¨åŒæŒ‡é’ˆçš„æ€æƒ³ï¼Œä¸ºäº†ä¸ä½¿ä¸‰å…ƒç»„é‡å¤ï¼Œå…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºã€‚å½“ç¡®å®šäº†ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåªéœ€è¦å¯¹å‰©ä¸‹å…ƒç´ è¿›è¡Œè®¾ç½®å·¦æŒ‡é’ˆå’Œå³æŒ‡é’ˆï¼Œå¦‚æœä¸‰å…ƒç»„å¤§ä¸0ï¼Œå³æŒ‡é’ˆå°±å·¦ç§»ä¸€ä½ï¼Œåä¹‹äº¦ç„¶ã€‚å¦‚æœä¸‰å…ƒç»„ä¹‹å’Œåˆšå¥½ç­‰äº0ï¼Œå°±éœ€è¦å·¦æŒ‡é’ˆå’Œå³æŒ‡é’ˆéƒ½ç§»åŠ¨ä¸€ä½ã€‚è¿™æ—¶å€™è¿˜ä¼šå‡ºç°é‡å¤é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­æ­¤æ—¶éå†çš„å…ƒç´ å’Œä¹‹å‰çš„æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒå°±è¦è·³è¿‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">threeSum</span>(<span class="hljs-params">self, nums: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]]:<br>        nums.sort()<br>        n = <span class="hljs-built_in">len</span>(nums)<br>        ans = <span class="hljs-built_in">list</span>()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<span class="hljs-comment"># å›ºå®šå…¶ä¸­ä¸€ä¸ªå…ƒç´ </span><br>            <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> nums[i] != nums[i - <span class="hljs-number">1</span>]:<br>                k = n - <span class="hljs-number">1</span><br>                j = i + <span class="hljs-number">1</span><br>                <span class="hljs-keyword">while</span> k &gt; j:<span class="hljs-comment"># è¿›è¡ŒåŒæŒ‡é’ˆéå†</span><br>                    <span class="hljs-keyword">if</span> k != n - <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> nums[k] == nums[k + <span class="hljs-number">1</span>]:<span class="hljs-comment"># å¦‚æœå³æŒ‡é’ˆä¹‹å‰å‡ºç°è¿‡å°±è·³è¿‡</span><br>                        k = k - <span class="hljs-number">1</span><br>                        <span class="hljs-keyword">continue</span><br>                    <span class="hljs-keyword">if</span> j != i + <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> nums[j] == nums[j - <span class="hljs-number">1</span>]:<span class="hljs-comment"># å¦‚æœå·¦æŒ‡é’ˆä¹‹å‰å‡ºç°è¿‡å°±è·³è¿‡</span><br>                        j = j + <span class="hljs-number">1</span><br>                        <span class="hljs-keyword">continue</span><br>                    s = nums[i] + nums[j] + nums[k]<br>                    <span class="hljs-keyword">if</span> s == <span class="hljs-number">0</span>:<br>                        ans.append([nums[i], nums[j], nums[k]])<br>                        k = k - <span class="hljs-number">1</span><br>                        j = j + <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">elif</span> s &gt; <span class="hljs-number">0</span>:<br>                        k = k - <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">elif</span> s &lt; <span class="hljs-number">0</span>:<br>                        j = j + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ">16ã€æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/16.png" /></p><p>é‡‡ç”¨åŒæŒ‡é’ˆçš„æ€æƒ³ï¼Œå…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºã€‚å½“ç¡®å®šäº†ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåªéœ€è¦å¯¹å‰©ä¸‹å…ƒç´ è¿›è¡Œè®¾ç½®å·¦æŒ‡é’ˆå’Œå³æŒ‡é’ˆï¼Œå¦‚æœä¸‰å…ƒç»„ä¹‹å’Œå¤§äºtargetï¼Œæˆ‘ä»¬åªéœ€è¦å°†å³èŠ‚ç‚¹å·¦ç§»ä¸€ä½ï¼Œç›¸åäº¦ç„¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">threeSumClosest</span>(<span class="hljs-params">self, nums: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>], target: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        n = <span class="hljs-built_in">len</span>(nums)<br>        nums.sort()<br>        min_num = <span class="hljs-number">10</span>**<span class="hljs-number">9</span><br>        ans = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            <span class="hljs-keyword">if</span> i != <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> nums[i] == nums[i - <span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">continue</span><br>            k = n - <span class="hljs-number">1</span><br>            j = i + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">while</span> k &gt; j:<br>                s = nums[i] + nums[j] + nums[k]<br>                <span class="hljs-keyword">if</span> s == target:<br>                    <span class="hljs-keyword">return</span> s<br>                <span class="hljs-keyword">if</span> s &gt; target:<br>                    <span class="hljs-keyword">if</span> s - target &lt; min_num:<br>                        min_num = s - target<br>                        ans = s<br>                    k = k - <span class="hljs-number">1</span><br>                <span class="hljs-keyword">elif</span> s &lt; target:<br>                    <span class="hljs-keyword">if</span> target - s &lt; min_num:<br>                        min_num = target - s<br>                        ans = s<br>                    j = j + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="å››æ•°ä¹‹å’Œ">18ã€å››æ•°ä¹‹å’Œ</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/18.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fourSum</span>(<span class="hljs-params">self, nums: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>], target: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]]:<br>        n = <span class="hljs-built_in">len</span>(nums)<br>        <span class="hljs-keyword">if</span> nums == [] <span class="hljs-keyword">or</span> n &lt; <span class="hljs-number">4</span>:<br>            <span class="hljs-keyword">return</span> []<br>        nums.sort()<br>        ans = <span class="hljs-built_in">list</span>()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n - <span class="hljs-number">3</span>):<br>            <span class="hljs-keyword">if</span> i != <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> nums[i] == nums[i - <span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">if</span> nums[i] + nums[i + <span class="hljs-number">1</span>] + nums[i + <span class="hljs-number">2</span>] + nums[i + <span class="hljs-number">3</span>] &gt; target:<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span> nums[i] + nums[n - <span class="hljs-number">1</span>] + nums[n - <span class="hljs-number">2</span>] + nums[n - <span class="hljs-number">3</span>] &lt; target:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i + <span class="hljs-number">1</span>, n - <span class="hljs-number">2</span>):<br>                <span class="hljs-keyword">if</span> j != i + <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> nums[j] == nums[j - <span class="hljs-number">1</span>]:<br>                    <span class="hljs-keyword">continue</span><br>                <span class="hljs-keyword">if</span> nums[i] + nums[j] + nums[j + <span class="hljs-number">1</span>] + nums[j + <span class="hljs-number">2</span>] &gt; target:<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">if</span> nums[i] + nums[n - <span class="hljs-number">1</span>] + nums[n - <span class="hljs-number">2</span>] + nums[n - <span class="hljs-number">3</span>] &lt; target:<br>                    <span class="hljs-keyword">continue</span><br>                k = j + <span class="hljs-number">1</span><br>                l = n - <span class="hljs-number">1</span><br>                <span class="hljs-keyword">while</span> k &lt; l:<br>                    <span class="hljs-built_in">sum</span> = nums[i] + nums[j] + nums[k] + nums[l]<br>                    <span class="hljs-keyword">if</span> <span class="hljs-built_in">sum</span> &lt; target:<br>                        k = k + <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">sum</span> &gt; target:<br>                        l = l - <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">sum</span> == target:<br>                        ans.append([nums[i], nums[j], nums[k], nums[l]])<br>                        <span class="hljs-keyword">while</span> k &lt; l <span class="hljs-keyword">and</span> nums[k] == nums[k + <span class="hljs-number">1</span>]:<br>                            k = k + <span class="hljs-number">1</span><br>                        k = k + <span class="hljs-number">1</span><br>                        <span class="hljs-keyword">while</span> k &lt; l <span class="hljs-keyword">and</span> nums[l] == nums[l - <span class="hljs-number">1</span>]:<br>                            l = l - <span class="hljs-number">1</span><br>                        l = l - <span class="hljs-number">1</span> <br><br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬nä¸ªç»“ç‚¹">19ã€åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªç»“ç‚¹</h2><p><img src="/img/LeetCode/é“¾è¡¨/19.png" /></p><p>é‡‡ç”¨åŒæŒ‡é’ˆçš„æ€æƒ³ï¼Œå·¦å³æŒ‡é’ˆéƒ½ä¸ºæŒ‡å‘å¤´èŠ‚ç‚¹ï¼Œé¦–å…ˆå³æŒ‡é’ˆå‘åéå†nä¸ªç»“ç‚¹ï¼Œæœ€åè®©å·¦å³ä¸€èµ·å‘åéå†ç›´è‡³å³æŒ‡é’ˆæŒ‡å‘çš„ä¸ºæœ€åä¸€ä¸ªç»“ç‚¹ï¼Œè¿™æ—¶å€™å·¦æŒ‡é’ˆæŒ‡å‘çš„å°±æ˜¯å€’æ•°ç¬¬nä¸ªç»“ç‚¹çš„å‰ä¸€ä¸ªç»“ç‚¹ï¼Œå°±å¯ä»¥è¿›è¡Œåˆ é™¤çš„æ“ä½œäº†ã€‚</p><p>ä½†æ˜¯æœ‰ä¸€ä¸ªç‰¹æ®Šæƒ…å†µï¼Œå¦‚æœåˆ é™¤çš„æ˜¯å¤´ç»“ç‚¹ï¼Œä¸Šè¿°ä¸æˆç«‹ï¼Œæ‰€ä»¥è¦å•ç‹¬è¿›è¡Œä¸€ä¸ªifåˆ¤æ–­ï¼Œå¦‚æœå³æŒ‡é’ˆå‘åéå†nä¸ªç»“ç‚¹åä¸ºç©ºï¼Œé‚£ä¹ˆåˆ é™¤çš„å°±æ˜¯å¤´ç»“ç‚¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># Definition for singly-linked list.</span><br><span class="hljs-comment"># class ListNode:</span><br><span class="hljs-comment">#     def __init__(self, val=0, next=None):</span><br><span class="hljs-comment">#         self.val = val</span><br><span class="hljs-comment">#         self.next = next</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">removeNthFromEnd</span>(<span class="hljs-params">self, head: ListNode, n: <span class="hljs-built_in">int</span></span>) -&gt; ListNode:<br>        right = head<br>        left = head<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            right = right.<span class="hljs-built_in">next</span><br>        <span class="hljs-keyword">if</span> right == <span class="hljs-literal">None</span>:<span class="hljs-comment"># å¦‚æœè¦åˆ é™¤çš„æ˜¯å¤´ç»“ç‚¹</span><br>            left = left.<span class="hljs-built_in">next</span><br>            <span class="hljs-keyword">return</span> left<br>        <span class="hljs-keyword">while</span> right.<span class="hljs-built_in">next</span> != <span class="hljs-literal">None</span>:<br>            left = left.<span class="hljs-built_in">next</span><br>            right = right.<span class="hljs-built_in">next</span><br>        left.<span class="hljs-built_in">next</span> = left.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span><br>        <span class="hljs-keyword">return</span> head<br></code></pre></div></td></tr></table></figure><h2 id="åˆ é™¤æœ‰åºæ•°ç»„ä¸­çš„é‡å¤é¡¹">26ã€åˆ é™¤æœ‰åºæ•°ç»„ä¸­çš„é‡å¤é¡¹</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/26.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">removeDuplicates</span>(<span class="hljs-params">self, nums: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-built_in">int</span>:<br>        <span class="hljs-keyword">if</span> nums == []:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>        n = <span class="hljs-built_in">len</span>(nums)<br>        left, right = <span class="hljs-number">1</span>, <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> right &lt; n:<br>            <span class="hljs-keyword">if</span> nums[right] != nums[right - <span class="hljs-number">1</span>]:<br>                nums[left] = nums[right]<br>                left = left + <span class="hljs-number">1</span><br>            right = right + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> left<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>åŠ¨æ€è§„åˆ’</title>
    <link href="/2022/04/29/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    <url>/2022/04/29/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/</url>
    
    <content type="html"><![CDATA[<h2 id="æœ€é•¿å›æ–‡å­ä¸²">4ã€æœ€é•¿å›æ–‡å­ä¸²</h2><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/2.png" /></p><p>æœ¬é¢˜ä½¿ç”¨çš„åŠ¨æ€è§„åˆ’çš„æ€æƒ³ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰s[i+1:j-1]<em>s</em>[<em>i</em>+1:<em>j</em>âˆ’1] æ˜¯å›æ–‡ä¸²ï¼Œå¹¶ä¸”s<em>s</em> çš„ç¬¬ i<em>i</em> å’Œ j<em>j</em>ä¸ªå­—æ¯ç›¸åŒæ—¶ï¼Œs[i:j]<em>s</em>[<em>i</em>:<em>j</em>] æ‰ä¼šæ˜¯å›æ–‡ä¸²ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">longestPalindrome</span>(<span class="hljs-params">self, s: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>        n = <span class="hljs-built_in">len</span>(s)<br>        <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">2</span>:  <span class="hljs-comment"># å¦‚æœå­—ç¬¦ä¸²é•¿ä¸º1</span><br>            <span class="hljs-keyword">return</span> s<br>        <br>        <span class="hljs-built_in">max</span> = <span class="hljs-number">1</span><br>        left = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># dp[i][j]ä»£è¡¨æ˜¯s[i...j]æ˜¯å¦ä¸ºå›æ–‡ä¸²</span><br>        dp = [[<span class="hljs-literal">False</span>] * n <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            dp[i][i] = <span class="hljs-literal">True</span><br><br>        <span class="hljs-keyword">for</span> L <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, n + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>                right = L + i - <span class="hljs-number">1</span><br>                <span class="hljs-keyword">if</span> right &gt;= n:<br>                    <span class="hljs-keyword">break</span><br>                <br>                <span class="hljs-keyword">if</span> s[i] != s[right]:<br>                    dp[i][right] = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-keyword">if</span> right - i &lt; <span class="hljs-number">3</span>:<br>                        dp[i][right] = <span class="hljs-literal">True</span><br>                    <span class="hljs-keyword">else</span>:<br>                        dp[i][right] = dp[i + <span class="hljs-number">1</span>][right - <span class="hljs-number">1</span>]<br><br>                <span class="hljs-keyword">if</span> dp[i][right] <span class="hljs-keyword">and</span> L &gt; <span class="hljs-built_in">max</span>:<br>                    <span class="hljs-built_in">max</span> = L<br>                    left = i<br>        <span class="hljs-keyword">return</span> s[left:left+<span class="hljs-built_in">max</span>]<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å­—ç¬¦ä¸²</title>
    <link href="/2022/04/29/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    <url>/2022/04/29/%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²">3ã€æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</h2><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/1.png" /></p><p>æ–¹æ³•ä¸€ï¼šæš´åŠ›è§£</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lengthOfLongestSubstring</span>(<span class="hljs-params">self, s: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        occ = <span class="hljs-built_in">set</span>()<br>        n = <span class="hljs-built_in">len</span>(s)<br>        <span class="hljs-comment"># rkä¸ºå·¦æŒ‡é’ˆï¼Œansä¸ºæ— é‡å¤å­ä¸²é•¿åº¦</span><br>        rk, ans = -<span class="hljs-number">1</span>, <span class="hljs-number">0</span><br>        flag = <span class="hljs-number">0</span>    <span class="hljs-comment"># å¾ªç¯ä¸­æ— é‡å¤å­ä¸²é•¿åº¦</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            rk = i<br>            flag = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">while</span> rk &lt; n <span class="hljs-keyword">and</span> s[rk] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> occ:<br>                occ.add(s[rk])<br>                flag = flag + <span class="hljs-number">1</span><br>                rk = rk + <span class="hljs-number">1</span><br>            ans = flag <span class="hljs-keyword">if</span> flag &gt; ans <span class="hljs-keyword">else</span> ans<br>            occ.clear()<br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><p>æ–¹æ³•äºŒï¼š</p><p>æ¯æ¬¡å¾ªç¯æ²¡å¿…è¦æŠŠé›†åˆé‡Œçš„å…ƒç´ å…¨éƒ¨åˆ é™¤ï¼Œå¯ä»¥æ¯æ¬¡åªåˆ é™¤ä¸Šä¸€è½®å¾ªç¯çš„æœ€å·¦è¾¹ç»“ç‚¹</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lengthOfLongestSubstring</span>(<span class="hljs-params">self, s: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        occ = <span class="hljs-built_in">set</span>()<br>        n = <span class="hljs-built_in">len</span>(s)<br>        <span class="hljs-comment"># rkä¸ºå·¦æŒ‡é’ˆï¼Œansä¸ºæ— é‡å¤å­ä¸²é•¿åº¦</span><br>        rk, ans = <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>        flag = <span class="hljs-number">0</span>    <span class="hljs-comment"># å¾ªç¯ä¸­æ— é‡å¤å­ä¸²é•¿åº¦</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            <span class="hljs-keyword">if</span> i &gt; <span class="hljs-number">0</span>:<br>                occ.remove(s[i - <span class="hljs-number">1</span>])<br>                flag = flag - <span class="hljs-number">1</span><br>            <span class="hljs-keyword">while</span> rk &lt; n <span class="hljs-keyword">and</span> s[rk] <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> occ:<br>                occ.add(s[rk])<br>                rk = rk + <span class="hljs-number">1</span><br>                flag = flag + <span class="hljs-number">1</span><br>            ans = flag <span class="hljs-keyword">if</span> flag &gt; ans <span class="hljs-keyword">else</span> ans<br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="æœ€é•¿å›æ–‡å­ä¸²">4ã€æœ€é•¿å›æ–‡å­ä¸²</h2><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/2.png" /></p><p>æœ¬é¢˜ä½¿ç”¨çš„åŠ¨æ€è§„åˆ’çš„æ€æƒ³ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰s[i+1:j-1]<em>s</em>[<em>i</em>+1:<em>j</em>âˆ’1] æ˜¯å›æ–‡ä¸²ï¼Œå¹¶ä¸”s<em>s</em> çš„ç¬¬ i<em>i</em> å’Œ j<em>j</em>ä¸ªå­—æ¯ç›¸åŒæ—¶ï¼Œs[i:j]<em>s</em>[<em>i</em>:<em>j</em>] æ‰ä¼šæ˜¯å›æ–‡ä¸²ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">longestPalindrome</span>(<span class="hljs-params">self, s: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>        n = <span class="hljs-built_in">len</span>(s)<br>        <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">2</span>:  <span class="hljs-comment"># å¦‚æœå­—ç¬¦ä¸²é•¿ä¸º1</span><br>            <span class="hljs-keyword">return</span> s<br>        <br>        <span class="hljs-built_in">max</span> = <span class="hljs-number">1</span><br>        left = <span class="hljs-number">0</span><br>        <span class="hljs-comment"># dp[i][j]ä»£è¡¨æ˜¯s[i...j]æ˜¯å¦ä¸ºå›æ–‡ä¸²</span><br>        dp = [[<span class="hljs-literal">False</span>] * n <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n)]<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            dp[i][i] = <span class="hljs-literal">True</span><br><br>        <span class="hljs-keyword">for</span> L <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, n + <span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>                right = L + i - <span class="hljs-number">1</span><br>                <span class="hljs-keyword">if</span> right &gt;= n:<br>                    <span class="hljs-keyword">break</span><br>                <br>                <span class="hljs-keyword">if</span> s[i] != s[right]:<br>                    dp[i][right] = <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-keyword">if</span> right - i &lt; <span class="hljs-number">3</span>:<br>                        dp[i][right] = <span class="hljs-literal">True</span><br>                    <span class="hljs-keyword">else</span>:<br>                        dp[i][right] = dp[i + <span class="hljs-number">1</span>][right - <span class="hljs-number">1</span>]<br><br>                <span class="hljs-keyword">if</span> dp[i][right] <span class="hljs-keyword">and</span> L &gt; <span class="hljs-built_in">max</span>:<br>                    <span class="hljs-built_in">max</span> = L<br>                    left = i<br>        <span class="hljs-keyword">return</span> s[left:left+<span class="hljs-built_in">max</span>]<br></code></pre></div></td></tr></table></figure><h2 id="zå­—å½¢å˜æ¢">6ã€Zå­—å½¢å˜æ¢</h2><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/3.png" /></p><p>ä½¿ç”¨äºŒç»´çŸ©é˜µè¿›è¡Œæ¨¡æ‹Ÿï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">convert</span>(<span class="hljs-params">self, s: <span class="hljs-built_in">str</span>, numRows: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>        n = <span class="hljs-built_in">len</span>(s)<br>        <span class="hljs-keyword">if</span> numRows == <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> numRows &gt;= n:<br>            <span class="hljs-keyword">return</span> s<br>        t = <span class="hljs-number">2</span> * numRows - <span class="hljs-number">2</span><br>        col = (n + t - <span class="hljs-number">1</span>) // t * (numRows - <span class="hljs-number">1</span>)<br>        matrix = [[<span class="hljs-string">&#x27;&#x27;</span>] * col <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(numRows)]<br>        x, y = <span class="hljs-number">0</span>, <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i, ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(s):<br>            matrix[x][y] = ch<br>            <span class="hljs-keyword">if</span> i % t &lt; numRows - <span class="hljs-number">1</span>:<br>                x = x + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                x = x - <span class="hljs-number">1</span><br>                y = y + <span class="hljs-number">1</span><br>        ans = <span class="hljs-string">&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(numRows):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(col):<br>                <span class="hljs-keyword">if</span> matrix[i][j]:<br>                    ans = ans + matrix[i][j]<br><br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="å­—ç¬¦ä¸²è½¬æ¢æ•´æ•°">7ã€å­—ç¬¦ä¸²è½¬æ¢æ•´æ•°</h2><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/4.png" /></p><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/5.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">myAtoi</span>(<span class="hljs-params">self, s: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        flag = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">if</span> s == <span class="hljs-string">&#x27;&#x27;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i, ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(s):<br>            <span class="hljs-keyword">if</span> ch != <span class="hljs-string">&#x27; &#x27;</span>:<br>                s = s[i:]<br>                <span class="hljs-keyword">break</span><br><br>        <span class="hljs-keyword">if</span> s[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;-&#x27;</span>:<br>            flag = <span class="hljs-literal">True</span><br>            s = s[<span class="hljs-number">1</span>:]<br>        <span class="hljs-keyword">elif</span> s[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;+&#x27;</span>:<br>            s = s[<span class="hljs-number">1</span>:]<br>        a = <span class="hljs-number">0</span><br>        ans = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i, ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(s):<br>            <span class="hljs-keyword">if</span> ch.isdigit() == <span class="hljs-literal">False</span>:<br>                <span class="hljs-keyword">break</span><br>            a = <span class="hljs-built_in">int</span>(ch)<br>            ans = ans * <span class="hljs-number">10</span> + a<br>        <span class="hljs-keyword">if</span> flag:<br>            ans = -<span class="hljs-number">1</span> * ans<br>        <span class="hljs-keyword">if</span> ans &gt; <span class="hljs-number">2</span> ** <span class="hljs-number">31</span> - <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> ** <span class="hljs-number">31</span> - <span class="hljs-number">1</span><br>        <span class="hljs-keyword">elif</span> ans &lt; -(<span class="hljs-number">2</span> ** <span class="hljs-number">31</span>):<br>            <span class="hljs-keyword">return</span> -(<span class="hljs-number">2</span> ** <span class="hljs-number">31</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="æœ€é•¿å…¬å…±å‰ç¼€">14ã€æœ€é•¿å…¬å…±å‰ç¼€</h2><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/6.png" /></p><p>æƒ³æ³•ä¸ºæ¨ªå‘å¯¹æ¯”ï¼ŒæŒ‰ç…§åˆ—è¡¨é¡ºåºå¼€å§‹é€æ­¥ç®—æ³•å‰xä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å‰ç¼€ï¼Œç›´è‡³å¾—åˆ°æœ€ç»ˆçš„æœ€é•¿å‰ç¼€</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">longestCommonPrefix</span>(<span class="hljs-params">self, strs: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>) -&gt; <span class="hljs-built_in">str</span>:<br>        flag = strs[<span class="hljs-number">0</span>]<span class="hljs-comment"># å‰å‡ ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å‰ç¼€</span><br>        a = <span class="hljs-string">&quot;&quot;</span><span class="hljs-comment"># æœ¬å­—ç¬¦ä¸²ä¸flagçš„æœ€é•¿å‰ç¼€</span><br>        ans = <span class="hljs-string">&quot;&quot;</span><br>        n = <span class="hljs-built_in">len</span>(strs)<br>        <span class="hljs-keyword">if</span> n == <span class="hljs-number">1</span>:<span class="hljs-comment"># å¦‚æœåªæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£å°±ç›´æ¥è¾“å‡º</span><br>            <span class="hljs-keyword">return</span> strs[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">for</span> i, s <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(strs):<br>            <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<span class="hljs-comment"># å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²é‚£å°±è·³è¿‡</span><br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">for</span> j, ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(s):<span class="hljs-comment"># æœ¬å­—ç¬¦ä¸²ä¸flagè¿›è¡Œæ¯”å¯¹</span><br>                <span class="hljs-keyword">if</span> j &lt; <span class="hljs-built_in">len</span>(flag) <span class="hljs-keyword">and</span> ch == flag[j]:<br>                    a = a + ch<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-keyword">break</span><br>            flag = a<br>            a = <span class="hljs-string">&quot;&quot;</span><br>            <span class="hljs-keyword">if</span> i == n - <span class="hljs-number">1</span>:<span class="hljs-comment"># å¦‚æœæ˜¯æœ€åä¸€ä¸ªç»“ç‚¹ï¼Œé‚£å°±æ˜¯æœ€ç»ˆæœ€é•¿å‰ç¼€äº†</span><br>                ans = flag<br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="ç”µè¯å·ç çš„å­—æ¯ç»„åˆ">17ã€ç”µè¯å·ç çš„å­—æ¯ç»„åˆ</h2><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/17.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">letterCombinations</span>(<span class="hljs-params">self, digits: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:<br>        <span class="hljs-keyword">if</span> digits == <span class="hljs-string">&#x27;&#x27;</span>:<br>            <span class="hljs-keyword">return</span> []<br><br>        phoneMap = &#123;<br>        <span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-string">&#x27;abc&#x27;</span>,<br>        <span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-string">&#x27;def&#x27;</span>,<br>        <span class="hljs-string">&#x27;4&#x27;</span>: <span class="hljs-string">&#x27;ghi&#x27;</span>,<br>        <span class="hljs-string">&#x27;5&#x27;</span>: <span class="hljs-string">&#x27;jkl&#x27;</span>,<br>        <span class="hljs-string">&#x27;6&#x27;</span>: <span class="hljs-string">&#x27;mno&#x27;</span>,<br>        <span class="hljs-string">&#x27;7&#x27;</span>: <span class="hljs-string">&#x27;pqrs&#x27;</span>,<br>        <span class="hljs-string">&#x27;8&#x27;</span>: <span class="hljs-string">&#x27;tuv&#x27;</span>,<br>        <span class="hljs-string">&#x27;9&#x27;</span>: <span class="hljs-string">&#x27;wxyz&#x27;</span>,   <br>        &#125;<br>        <br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">index: <span class="hljs-built_in">int</span></span>):<span class="hljs-comment"># å›æº¯</span><br>            <span class="hljs-keyword">if</span> index == <span class="hljs-built_in">len</span>(digits):<br>                combinations.append(<span class="hljs-string">&#x27;&#x27;</span>.join(combination))<br>            <span class="hljs-keyword">else</span>:<br>                digit = digits[index]<br>                <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> phoneMap[digit]:<br>                    combination.append(ch)<br>                    backtrack(index + <span class="hljs-number">1</span>)<br>                    combination.pop()<br><br>        combination = <span class="hljs-built_in">list</span>()<br>        combinations = <span class="hljs-built_in">list</span>()<br>        backtrack(<span class="hljs-number">0</span>)<br><br>        <span class="hljs-keyword">return</span> combinations<br></code></pre></div></td></tr></table></figure><h2 id="æœ‰æ•ˆçš„æ‹¬å·">20ã€æœ‰æ•ˆçš„æ‹¬å·</h2><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/20.png" /></p><p>é‡‡ç”¨äº†æ ˆçš„æ€æƒ³ï¼Œå°†ç¬¦å·ä¾æ¬¡å…¥æ ˆè¿›è¡Œåˆ¤æ–­</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">isValid</span>(<span class="hljs-params">self, s: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">bool</span>:<br>        stack = <span class="hljs-built_in">list</span>()<br>        <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> s:<br>            <span class="hljs-keyword">if</span> ch == <span class="hljs-string">&#x27;)&#x27;</span>:<br>                <span class="hljs-keyword">if</span> stack == []:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>                temp = stack.pop()<br>                <span class="hljs-keyword">if</span> temp != <span class="hljs-string">&#x27;(&#x27;</span>:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">elif</span> ch == <span class="hljs-string">&#x27;&#125;&#x27;</span>:<br>                <span class="hljs-keyword">if</span> stack == []:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>                temp = stack.pop()<br>                <span class="hljs-keyword">if</span> temp != <span class="hljs-string">&#x27;&#123;&#x27;</span>:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">elif</span> ch == <span class="hljs-string">&#x27;]&#x27;</span>:<br>                <span class="hljs-keyword">if</span> stack == []:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>                temp = stack.pop()<br>                <span class="hljs-keyword">if</span> temp != <span class="hljs-string">&#x27;[&#x27;</span>:<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">else</span>:<br>                stack.append(ch)<br>        <span class="hljs-keyword">if</span> stack:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br></code></pre></div></td></tr></table></figure><h2 id="åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨">21ã€åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨</h2><p><img src="/img/LeetCode/å­—ç¬¦ä¸²/21.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># Definition for singly-linked list.</span><br><span class="hljs-comment"># class ListNode:</span><br><span class="hljs-comment">#     def __init__(self, val=0, next=None):</span><br><span class="hljs-comment">#         self.val = val</span><br><span class="hljs-comment">#         self.next = next</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mergeTwoLists</span>(<span class="hljs-params">self, list1: <span class="hljs-type">Optional</span>[ListNode], list2: <span class="hljs-type">Optional</span>[ListNode]</span>) -&gt; <span class="hljs-type">Optional</span>[ListNode]:<br>        head = ListNode(<span class="hljs-number">0</span>, <span class="hljs-literal">None</span>)<br>        temp = head<br>        first = list1<br>        second = list2<br>        <span class="hljs-keyword">while</span> first <span class="hljs-keyword">and</span> second:<br>            <span class="hljs-keyword">if</span> first.val &lt;= second.val:<br>                temp.<span class="hljs-built_in">next</span> = first<br>                temp = temp.<span class="hljs-built_in">next</span><br>                first = first.<span class="hljs-built_in">next</span><br>            <span class="hljs-keyword">elif</span> first.val &gt; second.val:<br>                temp.<span class="hljs-built_in">next</span> = second<br>                temp = temp.<span class="hljs-built_in">next</span><br>                second = second.<span class="hljs-built_in">next</span><br>        <br>        temp.<span class="hljs-built_in">next</span> = first <span class="hljs-keyword">if</span> first <span class="hljs-keyword">else</span> second<br>        <br>        <span class="hljs-keyword">return</span> head.<span class="hljs-built_in">next</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>å“ˆå¸Œè¡¨</title>
    <link href="/2022/04/28/%E5%93%88%E5%B8%8C%E8%A1%A8/"/>
    <url>/2022/04/28/%E5%93%88%E5%B8%8C%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸¤æ•°ç›¸åŠ ">1ã€ä¸¤æ•°ç›¸åŠ </h2><p><img src="/img/LeetCode/å“ˆå¸Œè¡¨/1.png" /></p><p>è¿™æ ·æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œå¯¹äºæ¯ä¸€ä¸ª<code>x</code>ï¼Œæˆ‘ä»¬é¦–å…ˆæŸ¥è¯¢å“ˆå¸Œè¡¨ä¸­æ˜¯å¦å­˜åœ¨<code>target - x</code>ï¼Œç„¶åå°† <code>x</code>æ’å…¥åˆ°å“ˆå¸Œè¡¨ä¸­ï¼Œå³å¯ä¿è¯ä¸ä¼šè®© <code>x</code> å’Œè‡ªå·±åŒ¹é…ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">twoSum</span>(<span class="hljs-params">self, nums: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>], target: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]:<br>        hashtable = <span class="hljs-built_in">dict</span>()<br>        <span class="hljs-keyword">for</span> i, num <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(nums):<br>            <span class="hljs-keyword">if</span> target - num <span class="hljs-keyword">in</span> hashtable:<br>                <span class="hljs-keyword">return</span> [hashtable[target - num], i]<br>            <span class="hljs-keyword">else</span>:<br>                hashtable[num] = i<br>        <span class="hljs-keyword">return</span> []<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>é“¾è¡¨</title>
    <link href="/2022/04/28/%E9%93%BE%E8%A1%A8/"/>
    <url>/2022/04/28/%E9%93%BE%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸¤æ•°ç›¸åŠ ">2ã€ä¸¤æ•°ç›¸åŠ </h2><p><img src="/img/LeetCode/é“¾è¡¨/2.png" /></p><p>é‡‡ç”¨é€’å½’çš„æ€æƒ³ï¼Œå½“æŸä¸ªé“¾è¡¨å½“å‰èŠ‚ç‚¹å­˜åœ¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æˆ–è¿›ä½ç¬¦ä¸º1æ—¶ï¼Œå¾€ä¸‹é€’å½’ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># Definition for singly-linked list.</span><br><span class="hljs-comment"># class ListNode:</span><br><span class="hljs-comment">#     def __init__(self, val=0, next=None):</span><br><span class="hljs-comment">#         self.val = val</span><br><span class="hljs-comment">#         self.next = next</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">addTwoNumbers</span>(<span class="hljs-params">self, l1: <span class="hljs-type">Optional</span>[ListNode], l2: <span class="hljs-type">Optional</span>[ListNode], carryflag = <span class="hljs-number">0</span></span>) -&gt; <span class="hljs-type">Optional</span>[ListNode]:<br>        n1, n2 = l1.val <span class="hljs-keyword">if</span> l1 <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>, l2.val <span class="hljs-keyword">if</span> l2 <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>        s = n1 + n2 + carryflag<br>        val, carry_flag = s % <span class="hljs-number">10</span>, <span class="hljs-number">1</span> <span class="hljs-keyword">if</span> s &gt; <span class="hljs-number">9</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span><br>        next1, next2 = l1.<span class="hljs-built_in">next</span> <span class="hljs-keyword">if</span> l1 <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>, l2.<span class="hljs-built_in">next</span> <span class="hljs-keyword">if</span> l2 <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br>        <span class="hljs-keyword">if</span> next1 <span class="hljs-keyword">or</span> next2 <span class="hljs-keyword">or</span> carry_flag:<br>            <span class="hljs-keyword">return</span> ListNode(val, self.addTwoNumbers(next1, next2, carry_flag))<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> ListNode(val)<br></code></pre></div></td></tr></table></figure><h2 id="åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬nä¸ªç»“ç‚¹">19ã€åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªç»“ç‚¹</h2><p><img src="/img/LeetCode/é“¾è¡¨/19.png" /></p><p>é‡‡ç”¨åŒæŒ‡é’ˆçš„æ€æƒ³ï¼Œå·¦å³æŒ‡é’ˆéƒ½ä¸ºæŒ‡å‘å¤´èŠ‚ç‚¹ï¼Œé¦–å…ˆå³æŒ‡é’ˆå‘åéå†nä¸ªç»“ç‚¹ï¼Œæœ€åè®©å·¦å³ä¸€èµ·å‘åéå†ç›´è‡³å³æŒ‡é’ˆæŒ‡å‘çš„ä¸ºæœ€åä¸€ä¸ªç»“ç‚¹ï¼Œè¿™æ—¶å€™å·¦æŒ‡é’ˆæŒ‡å‘çš„å°±æ˜¯å€’æ•°ç¬¬nä¸ªç»“ç‚¹çš„å‰ä¸€ä¸ªç»“ç‚¹ï¼Œå°±å¯ä»¥è¿›è¡Œåˆ é™¤çš„æ“ä½œäº†ã€‚</p><p>ä½†æ˜¯æœ‰ä¸€ä¸ªç‰¹æ®Šæƒ…å†µï¼Œå¦‚æœåˆ é™¤çš„æ˜¯å¤´ç»“ç‚¹ï¼Œä¸Šè¿°ä¸æˆç«‹ï¼Œæ‰€ä»¥è¦å•ç‹¬è¿›è¡Œä¸€ä¸ªifåˆ¤æ–­ï¼Œå¦‚æœå³æŒ‡é’ˆå‘åéå†nä¸ªç»“ç‚¹åä¸ºç©ºï¼Œé‚£ä¹ˆåˆ é™¤çš„å°±æ˜¯å¤´ç»“ç‚¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># Definition for singly-linked list.</span><br><span class="hljs-comment"># class ListNode:</span><br><span class="hljs-comment">#     def __init__(self, val=0, next=None):</span><br><span class="hljs-comment">#         self.val = val</span><br><span class="hljs-comment">#         self.next = next</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">removeNthFromEnd</span>(<span class="hljs-params">self, head: ListNode, n: <span class="hljs-built_in">int</span></span>) -&gt; ListNode:<br>        right = head<br>        left = head<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            right = right.<span class="hljs-built_in">next</span><br>        <span class="hljs-keyword">if</span> right == <span class="hljs-literal">None</span>:<span class="hljs-comment"># å¦‚æœè¦åˆ é™¤çš„æ˜¯å¤´ç»“ç‚¹</span><br>            left = left.<span class="hljs-built_in">next</span><br>            <span class="hljs-keyword">return</span> left<br>        <span class="hljs-keyword">while</span> right.<span class="hljs-built_in">next</span> != <span class="hljs-literal">None</span>:<br>            left = left.<span class="hljs-built_in">next</span><br>            right = right.<span class="hljs-built_in">next</span><br>        left.<span class="hljs-built_in">next</span> = left.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span><br>        <span class="hljs-keyword">return</span> head<br></code></pre></div></td></tr></table></figure><h2 id="äº®äº®äº¤æ¢é“¾è¡¨ä¸­çš„ç»“ç‚¹">24ã€äº®äº®äº¤æ¢é“¾è¡¨ä¸­çš„ç»“ç‚¹</h2><p><img src="/img/LeetCode/é“¾è¡¨/24.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># Definition for singly-linked list.</span><br><span class="hljs-comment"># class ListNode:</span><br><span class="hljs-comment">#     def __init__(self, val=0, next=None):</span><br><span class="hljs-comment">#         self.val = val</span><br><span class="hljs-comment">#         self.next = next</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">swapPairs</span>(<span class="hljs-params">self, head: ListNode</span>) -&gt; ListNode:<br>        <span class="hljs-keyword">if</span> head == <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">return</span> head<br>        temp = ListNode(<span class="hljs-number">0</span>, head)<br>        first = temp<br>        second = temp.<span class="hljs-built_in">next</span><br><br>        <span class="hljs-keyword">while</span> second <span class="hljs-keyword">and</span> second.<span class="hljs-built_in">next</span>:<br>            first.<span class="hljs-built_in">next</span> = second.<span class="hljs-built_in">next</span><br>            second.<span class="hljs-built_in">next</span> = second.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span><br>            first.<span class="hljs-built_in">next</span>.<span class="hljs-built_in">next</span> = second<br>            <br>            first = second<br>            second = second.<span class="hljs-built_in">next</span><br>        <span class="hljs-keyword">return</span> temp.<span class="hljs-built_in">next</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ•°ç»„åŠæ•°å­¦</title>
    <link href="/2022/04/28/%E6%95%B0%E7%BB%84%E5%8F%8A%E6%95%B0%E5%AD%A6/"/>
    <url>/2022/04/28/%E6%95%B0%E7%BB%84%E5%8F%8A%E6%95%B0%E5%AD%A6/</url>
    
    <content type="html"><![CDATA[<h2 id="æ•´æ•°åè½¬">7ã€æ•´æ•°åè½¬</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/1.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">reverse</span>(<span class="hljs-params">self, x: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        ans = <span class="hljs-number">0</span><br>        flag = <span class="hljs-literal">False</span><br>        <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">0</span>:<br>            flag = <span class="hljs-literal">True</span><br>            x = -<span class="hljs-number">1</span> * x<br>        a = <span class="hljs-number">0</span>   <span class="hljs-comment"># é™¤æ³•ä½™æ•°</span><br>        <span class="hljs-keyword">while</span> x != <span class="hljs-number">0</span>:<br>            a = x % <span class="hljs-number">10</span><br>            x = x // <span class="hljs-number">10</span><br>            ans = ans * <span class="hljs-number">10</span> + a<br>        <span class="hljs-keyword">if</span> flag:<br>            ans = -<span class="hljs-number">1</span> * ans<br>        <span class="hljs-keyword">if</span> ans &gt; <span class="hljs-number">2</span> ** <span class="hljs-number">31</span> - <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> ans &lt; -(<span class="hljs-number">2</span> ** <span class="hljs-number">31</span>):<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="å›æ–‡æ•°">9ã€å›æ–‡æ•°</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/2.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">isPalindrome</span>(<span class="hljs-params">self, x: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">bool</span>:<br>        <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>        a = self.reverse(x) <span class="hljs-comment"># æ•´æ•°åè½¬</span><br>        <span class="hljs-keyword">if</span> a == x:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">reverse</span>(<span class="hljs-params">self, x: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        ans = <span class="hljs-number">0</span><br>        a = <span class="hljs-number">0</span>   <span class="hljs-comment"># é™¤æ³•ä½™æ•°</span><br>        <span class="hljs-keyword">while</span> x != <span class="hljs-number">0</span>:<br>            a = x % <span class="hljs-number">10</span><br>            x = x // <span class="hljs-number">10</span><br>            ans = ans * <span class="hljs-number">10</span> + a<br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="ç››æ°´æœ€å¤šçš„å®¹å™¨">11ã€ç››æ°´æœ€å¤šçš„å®¹å™¨</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/3.png" /></p><p>æˆ‘ä»¬ä½¿ç”¨åŒæŒ‡é’ˆçš„æ€æƒ³ï¼Œä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«ä¸ºæ•°ç»„çš„å¤´å°¾ç»“ç‚¹ï¼Œæ¯è½®éƒ½è¿›è¡Œé¢ç§¯çš„è®¡ç®—ï¼Œå¹¶ä¸”æ¯è½®åªç§»åŠ¨è¾ƒå°ç»“ç‚¹çš„æŒ‡é’ˆã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">maxArea</span>(<span class="hljs-params">self, height: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-built_in">int</span>:<br>        n = <span class="hljs-built_in">len</span>(height)<br>        left = <span class="hljs-number">0</span>    <span class="hljs-comment"># å·¦æŒ‡é’ˆ</span><br>        right = n - <span class="hljs-number">1</span>   <span class="hljs-comment"># å³æŒ‡é’ˆ</span><br>        max_s = <span class="hljs-number">0</span>   <span class="hljs-comment"># é¢ç§¯æœ€å¤§å€¼</span><br>        s = <span class="hljs-number">0</span>   <span class="hljs-comment"># é¢ç§¯</span><br>        l = <span class="hljs-number">0</span>   <span class="hljs-comment"># è¾¹é•¿</span><br>        <span class="hljs-keyword">while</span> right &gt; left:<br>            <span class="hljs-keyword">if</span> height[left] &gt; height[right]:<br>                l = height[right]<br>            <span class="hljs-keyword">else</span>:<br>                l = height[left]<br>            s = (right - left) * l<br>            <span class="hljs-keyword">if</span> s &gt; max_s:<br>                max_s = s<br>            <span class="hljs-keyword">if</span> height[left] &gt; height[right]:<br>                right = right - <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                left = left + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> max_s<br></code></pre></div></td></tr></table></figure><h2 id="æ•´æ•°è½¬ç½—é©¬æ•°å­—">12ã€æ•´æ•°è½¬ç½—é©¬æ•°å­—</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/4.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    A = [<br>        (<span class="hljs-number">1000</span>, <span class="hljs-string">&quot;M&quot;</span>),<br>        (<span class="hljs-number">900</span>, <span class="hljs-string">&quot;CM&quot;</span>),<br>        (<span class="hljs-number">500</span>, <span class="hljs-string">&quot;D&quot;</span>),<br>        (<span class="hljs-number">400</span>, <span class="hljs-string">&quot;CD&quot;</span>),<br>        (<span class="hljs-number">100</span>, <span class="hljs-string">&quot;C&quot;</span>),<br>        (<span class="hljs-number">90</span>, <span class="hljs-string">&quot;XC&quot;</span>),<br>        (<span class="hljs-number">50</span>, <span class="hljs-string">&quot;L&quot;</span>),<br>        (<span class="hljs-number">40</span>, <span class="hljs-string">&quot;XL&quot;</span>),<br>        (<span class="hljs-number">10</span>, <span class="hljs-string">&quot;X&quot;</span>),<br>        (<span class="hljs-number">9</span>, <span class="hljs-string">&quot;IX&quot;</span>),<br>        (<span class="hljs-number">5</span>, <span class="hljs-string">&quot;V&quot;</span>),<br>        (<span class="hljs-number">4</span>, <span class="hljs-string">&quot;IV&quot;</span>),<br>        (<span class="hljs-number">1</span>, <span class="hljs-string">&quot;I&quot;</span>),<br>    ]<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">intToRoman</span>(<span class="hljs-params">self, num: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>        ans = <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> value, s <span class="hljs-keyword">in</span> self.A:<br>            <span class="hljs-keyword">while</span> num &gt;= value:<br>                num = num - value<br>                ans = ans + s<br>            <span class="hljs-keyword">if</span> num == <span class="hljs-number">0</span>:<br>                <span class="hljs-keyword">break</span><br>        <br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="ç½—é©¬æ•°å­—è½¬æ•´æ•°">13ã€ç½—é©¬æ•°å­—è½¬æ•´æ•°</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/5.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    A = &#123;<br>        <span class="hljs-string">&#x27;I&#x27;</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-string">&#x27;V&#x27;</span>: <span class="hljs-number">5</span>,<br>        <span class="hljs-string">&#x27;X&#x27;</span>: <span class="hljs-number">10</span>,<br>        <span class="hljs-string">&#x27;L&#x27;</span>: <span class="hljs-number">50</span>,<br>        <span class="hljs-string">&#x27;C&#x27;</span>: <span class="hljs-number">100</span>,<br>        <span class="hljs-string">&#x27;D&#x27;</span>: <span class="hljs-number">500</span>,<br>        <span class="hljs-string">&#x27;M&#x27;</span>: <span class="hljs-number">1000</span>,<br>    &#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">romanToInt</span>(<span class="hljs-params">self, s: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        ans = <span class="hljs-number">0</span><br>        n = <span class="hljs-built_in">len</span>(s)<br>        <span class="hljs-keyword">for</span> i, ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(s):<br>            <span class="hljs-keyword">if</span> i &lt; n - <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> self.A[ch] &lt; self.A[s[i+<span class="hljs-number">1</span>]]:<br>                ans = ans - self.A[ch]<br>            <span class="hljs-keyword">else</span>:<br>                ans = ans + self.A[ch]<br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="ä¸‰æ•°ä¹‹å’Œ">15ã€ä¸‰æ•°ä¹‹å’Œ</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/15.png" /></p><p>é‡‡ç”¨åŒæŒ‡é’ˆçš„æ€æƒ³ï¼Œä¸ºäº†ä¸ä½¿ä¸‰å…ƒç»„é‡å¤ï¼Œå…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºã€‚å½“ç¡®å®šäº†ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåªéœ€è¦å¯¹å‰©ä¸‹å…ƒç´ è¿›è¡Œè®¾ç½®å·¦æŒ‡é’ˆå’Œå³æŒ‡é’ˆï¼Œå¦‚æœä¸‰å…ƒç»„å¤§ä¸0ï¼Œå³æŒ‡é’ˆå°±å·¦ç§»ä¸€ä½ï¼Œåä¹‹äº¦ç„¶ã€‚å¦‚æœä¸‰å…ƒç»„ä¹‹å’Œåˆšå¥½ç­‰äº0ï¼Œå°±éœ€è¦å·¦æŒ‡é’ˆå’Œå³æŒ‡é’ˆéƒ½ç§»åŠ¨ä¸€ä½ã€‚è¿™æ—¶å€™è¿˜ä¼šå‡ºç°é‡å¤é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦åˆ¤æ–­æ­¤æ—¶éå†çš„å…ƒç´ å’Œä¹‹å‰çš„æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒå°±è¦è·³è¿‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">threeSum</span>(<span class="hljs-params">self, nums: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]]:<br>        nums.sort()<br>        n = <span class="hljs-built_in">len</span>(nums)<br>        ans = <span class="hljs-built_in">list</span>()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<span class="hljs-comment"># å›ºå®šå…¶ä¸­ä¸€ä¸ªå…ƒç´ </span><br>            <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> nums[i] != nums[i - <span class="hljs-number">1</span>]:<br>                k = n - <span class="hljs-number">1</span><br>                j = i + <span class="hljs-number">1</span><br>                <span class="hljs-keyword">while</span> k &gt; j:<span class="hljs-comment"># è¿›è¡ŒåŒæŒ‡é’ˆéå†</span><br>                    <span class="hljs-keyword">if</span> k != n - <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> nums[k] == nums[k + <span class="hljs-number">1</span>]:<span class="hljs-comment"># å¦‚æœå³æŒ‡é’ˆä¹‹å‰å‡ºç°è¿‡å°±è·³è¿‡</span><br>                        k = k - <span class="hljs-number">1</span><br>                        <span class="hljs-keyword">continue</span><br>                    <span class="hljs-keyword">if</span> j != i + <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> nums[j] == nums[j - <span class="hljs-number">1</span>]:<span class="hljs-comment"># å¦‚æœå·¦æŒ‡é’ˆä¹‹å‰å‡ºç°è¿‡å°±è·³è¿‡</span><br>                        j = j + <span class="hljs-number">1</span><br>                        <span class="hljs-keyword">continue</span><br>                    s = nums[i] + nums[j] + nums[k]<br>                    <span class="hljs-keyword">if</span> s == <span class="hljs-number">0</span>:<br>                        ans.append([nums[i], nums[j], nums[k]])<br>                        k = k - <span class="hljs-number">1</span><br>                        j = j + <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">elif</span> s &gt; <span class="hljs-number">0</span>:<br>                        k = k - <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">elif</span> s &lt; <span class="hljs-number">0</span>:<br>                        j = j + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ">16ã€æœ€æ¥è¿‘çš„ä¸‰æ•°ä¹‹å’Œ</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/16.png" /></p><p>é‡‡ç”¨åŒæŒ‡é’ˆçš„æ€æƒ³ï¼Œå…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºã€‚å½“ç¡®å®šäº†ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåªéœ€è¦å¯¹å‰©ä¸‹å…ƒç´ è¿›è¡Œè®¾ç½®å·¦æŒ‡é’ˆå’Œå³æŒ‡é’ˆï¼Œå¦‚æœä¸‰å…ƒç»„ä¹‹å’Œå¤§äºtargetï¼Œæˆ‘ä»¬åªéœ€è¦å°†å³èŠ‚ç‚¹å·¦ç§»ä¸€ä½ï¼Œç›¸åäº¦ç„¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">threeSumClosest</span>(<span class="hljs-params">self, nums: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>], target: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">int</span>:<br>        n = <span class="hljs-built_in">len</span>(nums)<br>        nums.sort()<br>        min_num = <span class="hljs-number">10</span>**<span class="hljs-number">9</span><br>        ans = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            <span class="hljs-keyword">if</span> i != <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> nums[i] == nums[i - <span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">continue</span><br>            k = n - <span class="hljs-number">1</span><br>            j = i + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">while</span> k &gt; j:<br>                s = nums[i] + nums[j] + nums[k]<br>                <span class="hljs-keyword">if</span> s == target:<br>                    <span class="hljs-keyword">return</span> s<br>                <span class="hljs-keyword">if</span> s &gt; target:<br>                    <span class="hljs-keyword">if</span> s - target &lt; min_num:<br>                        min_num = s - target<br>                        ans = s<br>                    k = k - <span class="hljs-number">1</span><br>                <span class="hljs-keyword">elif</span> s &lt; target:<br>                    <span class="hljs-keyword">if</span> target - s &lt; min_num:<br>                        min_num = target - s<br>                        ans = s<br>                    j = j + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="å››æ•°ä¹‹å’Œ">18ã€å››æ•°ä¹‹å’Œ</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/18.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fourSum</span>(<span class="hljs-params">self, nums: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>], target: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]]:<br>        n = <span class="hljs-built_in">len</span>(nums)<br>        <span class="hljs-keyword">if</span> nums == [] <span class="hljs-keyword">or</span> n &lt; <span class="hljs-number">4</span>:<br>            <span class="hljs-keyword">return</span> []<br>        nums.sort()<br>        ans = <span class="hljs-built_in">list</span>()<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n - <span class="hljs-number">3</span>):<br>            <span class="hljs-keyword">if</span> i != <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> nums[i] == nums[i - <span class="hljs-number">1</span>]:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">if</span> nums[i] + nums[i + <span class="hljs-number">1</span>] + nums[i + <span class="hljs-number">2</span>] + nums[i + <span class="hljs-number">3</span>] &gt; target:<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span> nums[i] + nums[n - <span class="hljs-number">1</span>] + nums[n - <span class="hljs-number">2</span>] + nums[n - <span class="hljs-number">3</span>] &lt; target:<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i + <span class="hljs-number">1</span>, n - <span class="hljs-number">2</span>):<br>                <span class="hljs-keyword">if</span> j != i + <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> nums[j] == nums[j - <span class="hljs-number">1</span>]:<br>                    <span class="hljs-keyword">continue</span><br>                <span class="hljs-keyword">if</span> nums[i] + nums[j] + nums[j + <span class="hljs-number">1</span>] + nums[j + <span class="hljs-number">2</span>] &gt; target:<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">if</span> nums[i] + nums[n - <span class="hljs-number">1</span>] + nums[n - <span class="hljs-number">2</span>] + nums[n - <span class="hljs-number">3</span>] &lt; target:<br>                    <span class="hljs-keyword">continue</span><br>                k = j + <span class="hljs-number">1</span><br>                l = n - <span class="hljs-number">1</span><br>                <span class="hljs-keyword">while</span> k &lt; l:<br>                    <span class="hljs-built_in">sum</span> = nums[i] + nums[j] + nums[k] + nums[l]<br>                    <span class="hljs-keyword">if</span> <span class="hljs-built_in">sum</span> &lt; target:<br>                        k = k + <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">sum</span> &gt; target:<br>                        l = l - <span class="hljs-number">1</span><br>                    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">sum</span> == target:<br>                        ans.append([nums[i], nums[j], nums[k], nums[l]])<br>                        <span class="hljs-keyword">while</span> k &lt; l <span class="hljs-keyword">and</span> nums[k] == nums[k + <span class="hljs-number">1</span>]:<br>                            k = k + <span class="hljs-number">1</span><br>                        k = k + <span class="hljs-number">1</span><br>                        <span class="hljs-keyword">while</span> k &lt; l <span class="hljs-keyword">and</span> nums[l] == nums[l - <span class="hljs-number">1</span>]:<br>                            l = l - <span class="hljs-number">1</span><br>                        l = l - <span class="hljs-number">1</span> <br><br>        <span class="hljs-keyword">return</span> ans<br></code></pre></div></td></tr></table></figure><h2 id="åˆ é™¤æœ‰åºæ•°ç»„ä¸­çš„é‡å¤é¡¹">26ã€åˆ é™¤æœ‰åºæ•°ç»„ä¸­çš„é‡å¤é¡¹</h2><p><img src="/img/LeetCode/æ•°ç»„åŠæ•°å­¦/26.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">removeDuplicates</span>(<span class="hljs-params">self, nums: <span class="hljs-type">List</span>[<span class="hljs-built_in">int</span>]</span>) -&gt; <span class="hljs-built_in">int</span>:<br>        <span class="hljs-keyword">if</span> nums == []:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>        n = <span class="hljs-built_in">len</span>(nums)<br>        left, right = <span class="hljs-number">1</span>, <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> right &lt; n:<br>            <span class="hljs-keyword">if</span> nums[right] != nums[right - <span class="hljs-number">1</span>]:<br>                nums[left] = nums[right]<br>                left = left + <span class="hljs-number">1</span><br>            right = right + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> left<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>LeetCode</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>pytorch</title>
    <link href="/2022/04/27/pytorch/"/>
    <url>/2022/04/27/pytorch/</url>
    
    <content type="html"><![CDATA[<h1 id="pytorch">PyTorch</h1><h2 id="dataset">1ã€DataSet</h2><p>DataSetï¼šæä¾›ä¸€ç§æ–¹æ³•å»è·å–æ•°æ®åŠå…¶label</p><p>ä½¿ç”¨çš„æ•°æ®é›†ä¸ºèœœèœ‚ä¸èš‚èšçš„å›¾åƒæ•°æ®é›†ï¼Œåˆ†åˆ«ä¿å­˜åœ¨dataset/train/beesä»¥åŠdataset/train/ants</p><p>DataSetéœ€è¦é€šè¿‡ç»§æ‰¿é‡è½½æ‰èƒ½ä½¿ç”¨ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> Dataset<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyData</span>(<span class="hljs-title class_ inherited__">Dataset</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, root_dir, label_dir</span>):<span class="hljs-comment"># read data &amp; preprocess</span><br>        self.root_dir = root_dir    <span class="hljs-comment"># æ ¹ç›®å½•</span><br>        self.label_dir = label_dir  <span class="hljs-comment"># æ ‡è®°ç›®å½•</span><br>        self.path = os.path.join(self.root_dir, self.label_dir)     <span class="hljs-comment"># åœ°å€ç›¸åŠ </span><br>        self.img_path = os.listdir(self.path)   <span class="hljs-comment"># ç”Ÿæˆå›¾ç‰‡æ–‡ä»¶åˆ—è¡¨</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getitem__</span>(<span class="hljs-params">self, index</span>):<span class="hljs-comment"># returns one sample at a time</span><br>        img_name = self.img_path[index]   <span class="hljs-comment"># æ–‡ä»¶å</span><br>        img_item_path = os.path.join(self.root_dir, self.label_dir, img_name)<br>        img = Image.<span class="hljs-built_in">open</span>(img_item_path)<br>        label = self.label_dir<br>        <span class="hljs-keyword">return</span> img, label<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__len__</span>(<span class="hljs-params">self</span>):<span class="hljs-comment"># returns the size of the dataset</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.img_path)<br><br><br><span class="hljs-comment"># è¯»å–èš‚èšå’Œèœœèœ‚çš„å›¾ç‰‡æ•°æ®é›†</span><br>root_dir = <span class="hljs-string">&quot;dataset/train&quot;</span><br>ants_label_dir = <span class="hljs-string">&quot;ants&quot;</span><br>bees_label_dir = <span class="hljs-string">&quot;bees&quot;</span><br>ants_dataset = MyData(root_dir, ants_label_dir)<br>bees_dataset = MyData(root_dir, bees_label_dir)<br><br><span class="hljs-comment"># å°†ä¸¤ä¸ªæ•°æ®é›†è¿›è¡Œåˆå¹¶ï¼Œæˆä¸ºè®­ç»ƒæ•°æ®é›†</span><br>train_dataset = ants_dataset + bees_dataset<br></code></pre></div></td></tr></table></figure><h2 id="dataloader">2ã€DataLoader</h2><p>DataSetå°±ç›¸å½“äºæ˜¯ä¸€æ•´ä¸ªæ•°æ®é›†ï¼Œè€ŒDataLoaderæ˜¯å–å‡ºå…¶ä¸­ä¸€éƒ¨åˆ†åˆ°ç¥ç»ç½‘ç»œä¸­è¿›è¡Œä½¿ç”¨ã€‚</p><p>ä½¿ç”¨çš„æ˜¯torchvisionæ‰€æä¾›çš„æ•°æ®é›†ã€‚DataLoaderä¸­çš„å‚æ•°åˆ†åˆ«é‡Šä¹‰å¦‚ä¸‹ï¼š</p><ul><li>datasetï¼šæˆ‘ä»¬æ‰€ä½¿ç”¨çš„æ•°æ®é›†ï¼Œå³datasetç±»å‹æ•°æ®</li><li>batch_sizeï¼šä¸€æ¬¡æŠ“å–å¤šå°‘ä¸ªæ•°æ®</li><li>shuffleï¼šæŠ“å–æ—¶æ˜¯å¦æ‰“ä¹±é¡ºåº</li><li>num_workersï¼šä»£è¡¨åˆ›å»ºäº†å¤šå°‘ä¸ªworkerè¿›ç¨‹ï¼Œ0è¡¨ç¤ºåªæœ‰ä¸»è¿›ç¨‹å»åŠ è½½batchæ•°æ®ï¼Œ1è¡¨ç¤ºæœ‰ä¸€ä¸ªworkerè¿›ç¨‹åŠ è½½batchæ•°æ®</li><li>drop_lastï¼šæ— æ³•æ•´é™¤æ—¶ï¼Œæœ€åå‰©ä½™çš„å‡ æ¡æ•°æ®è¦ä¸è¦å»é™¤</li></ul><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torchvision<br><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader<br><br><span class="hljs-comment"># å‡†å¤‡çš„æµ‹è¯•æ•°æ®é›†</span><br><span class="hljs-keyword">from</span> torch.utils.tensorboard <span class="hljs-keyword">import</span> SummaryWriter<br><br>test_data = torchvision.datasets.CIFAR10(<span class="hljs-string">&quot;./dataset&quot;</span>, train=<span class="hljs-literal">False</span>, transform=torchvision.transforms.ToTensor(), download=<span class="hljs-literal">True</span>)<br><br>test_loader = DataLoader(dataset=test_data, batch_size=<span class="hljs-number">64</span>, shuffle=<span class="hljs-literal">True</span>, num_workers=<span class="hljs-number">0</span>, drop_last=<span class="hljs-literal">False</span>)<br><br>writer = SummaryWriter(<span class="hljs-string">&quot;dataloader&quot;</span>)<br>step = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> test_loader:<br>    imgs, targets = data<br>    writer.add_images(<span class="hljs-string">&quot;test_data&quot;</span>, imgs, step)<br>    step = step + <span class="hljs-number">1</span><br><br>writer.close()<br></code></pre></div></td></tr></table></figure><p>æœ€åæ˜¾ç¤ºç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/img/pytorch/1.png" /></p><h2 id="tensorboard">3ã€TensorBoard</h2><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡TensorBoardå¯ä»¥æŸ¥çœ‹å›¾åƒ</p><h3 id="è¾“å‡ºå‡½æ•°å›¾åƒ">3.1è¾“å‡ºå‡½æ•°å›¾åƒ</h3><p>é¦–å…ˆæˆ‘ä»¬é€šè¿‡TensorBoardæ¥ç»˜åˆ¶y=xçš„å›¾åƒï¼Œæˆ‘ä»¬éœ€è¦å…ˆç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œéšåé€šè¿‡add_scalar()æ–¹æ³•æ¥æ·»åŠ ï¼Œå‚æ•°åˆ†åˆ«ä¸ºåç§°ï¼Œyè½´çš„å€¼ï¼Œxè½´çš„å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> torch.utils.tensorboard <span class="hljs-keyword">import</span> SummaryWriter<br><br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªå®ä¾‹,å­˜å‚¨åœ¨logsæ–‡ä»¶å¤¹ä¸‹</span><br>writer = SummaryWriter(<span class="hljs-string">&quot;logs&quot;</span>)<br><br><span class="hljs-comment"># y = xå›¾åƒ</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    writer.add_scalar(<span class="hljs-string">&quot;y=x&quot;</span>, i, i)<br><br>writer.close()<br></code></pre></div></td></tr></table></figure><p>å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶å°è¾“å…¥å¦‚ä¸‹æŒ‡ä»¤æ¥è§‚çœ‹å›¾åƒ</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tensorboard --logdir=logs<br></code></pre></div></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡6006ç«¯å£æ¥æŸ¥çœ‹å›¾åƒï¼Œä½†æ˜¯å¦‚æœæœ‰å¾ˆå¤štensorboardéƒ½è¦æŸ¥çœ‹å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è‡ªå®šä¹‰ç«¯å£æŸ¥çœ‹ï¼Œä¾‹å¦‚æˆ‘ä»¬è¦é€‰æ‹©6007ç«¯å£æ¥æŸ¥çœ‹ï¼ŒæŒ‡ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tensorboard --logdir=logs --port=6007<br></code></pre></div></td></tr></table></figure><p><img src="/img/pytorch/2.png" /></p><p>è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°y=xçš„å›¾åƒ</p><p>å¦‚æœæ˜¯y=2xçš„å›¾åƒåˆ™éœ€è¦ä¿®æ”¹ä»£ç ä¸ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># y = 2xå›¾åƒ</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    writer.add_scalar(<span class="hljs-string">&quot;y=2x&quot;</span>, <span class="hljs-number">2</span>*i, i)<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºå›¾ç‰‡">3.2è¾“å‡ºå›¾ç‰‡</h3><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡TensorBoardæ¥æ˜¾ç¤ºæˆ‘ä»¬çš„å›¾ç‰‡ï¼Œé€šè¿‡TensorBoardçš„add_image()æ–¹æ³•ï¼Œå‚æ•°åˆ†åˆ«ä¸ºåç§°ã€å›¾ç‰‡ï¼ˆéœ€è¦ä¸ºtensorç±»å‹æˆ–è€…numpyç±»å‹ï¼‰ã€global_stepã€ç±»å‹ï¼ˆå› ä¸ºé»˜è®¤çš„ç±»å‹ä¸ºæ˜¯ï¼ˆ3ï¼ŒHï¼ŒWï¼‰å³é€šé“(channel)ä¸º3ï¼ŒHä¸ºé«˜åº¦ï¼ŒWä¸ºå®½åº¦ï¼‰ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">from</span> torch.utils.tensorboard <span class="hljs-keyword">import</span> SummaryWriter<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªå®ä¾‹,å­˜å‚¨åœ¨logsæ–‡ä»¶å¤¹ä¸‹</span><br>writer = SummaryWriter(<span class="hljs-string">&quot;logs&quot;</span>)<br>image_path = <span class="hljs-string">&quot;dataset/train/ants/0013035.jpg&quot;</span><br>img_PIL = Image.<span class="hljs-built_in">open</span>(image_path)<br>img_array = np.array(img_PIL)<br><br>writer.add_image(<span class="hljs-string">&quot;test&quot;</span>, img_array, <span class="hljs-number">1</span>, dataformats=<span class="hljs-string">&#x27;HWC&#x27;</span>)<br><br>writer.close()<br></code></pre></div></td></tr></table></figure><h2 id="ç¥ç»ç½‘ç»œçš„åŸºæœ¬éª¨æ¶">4ã€ç¥ç»ç½‘ç»œçš„åŸºæœ¬éª¨æ¶</h2><p>åŸºæœ¬éª¨æ¶æ˜¯é€šè¿‡å¯¹nn.Moduleçš„ç»§æ‰¿é‡å†™å®ç°çš„ï¼Œå¤§ä½“å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, <span class="hljs-built_in">input</span></span>):<br>        output = <span class="hljs-built_in">input</span> + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> output<br><br>res = MyModel()<br>x = torch.tensor(<span class="hljs-number">1.0</span>)<br>output = res(x)<span class="hljs-comment"># æœ‰__call__æ–¹æ³•æ¥è°ƒç”¨ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å°†xè¾“å…¥ï¼Œä¸ç”¨æˆ‘ä»¬æ¥è°ƒç”¨forward()æ–¹æ³•</span><br><span class="hljs-built_in">print</span>(output)<br><br></code></pre></div></td></tr></table></figure><p>æœ€åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tensor(2.)<br></code></pre></div></td></tr></table></figure><h2 id="å·ç§¯å±‚">5ã€å·ç§¯å±‚</h2><p>é¦–å…ˆå¯¹äºå·ç§¯å±‚çš„å­¦ä¹ ï¼Œè¦äº†è§£å·ç§¯å±‚çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨torch.nn.functionalä¸­çš„æ–¹æ³•ï¼ˆä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨torch.nnï¼Œå…¶å¯¹functionalè¿›è¡Œäº†å°è£…ï¼Œè¿™é‡Œæ˜¯ä¸ºäº†äº†è§£å¦‚ä½•å·ç§¯ï¼‰è¿›è¡Œå­¦ä¹ ï¼Œé¦–å…ˆè¦å¯¹conv2dçš„strideå‚æ•°è¿›è¡Œäº†è§£ï¼Œstrideæ—¶è®¡ç®—å·ç§¯æ—¶ç§»åŠ¨çš„æ­¥é•¿ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£ç æ¥äº†è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torch.nn.functional <span class="hljs-keyword">as</span> F<br><br><span class="hljs-built_in">input</span> = torch.tensor([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>],<br>                      [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>],<br>                      [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],<br>                      [<span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>],<br>                      [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]])<br><br>kernel = torch.tensor([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>],<br>                       [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>],<br>                       [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>]])<br><br><span class="hljs-built_in">input</span> = torch.reshape(<span class="hljs-built_in">input</span>, (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>))<br>kernel = torch.reshape(kernel, (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>))<br><br>output = F.conv2d(<span class="hljs-built_in">input</span>, kernel, stride=<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(output)<br><br>output2 = F.conv2d(<span class="hljs-built_in">input</span>, kernel, stride=<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(output2)<br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tensor([[[[10, 12, 12],<br>          [18, 16, 16],<br>          [13,  9,  3]]]])<br>tensor([[[[10, 12],<br>          [13,  3]]]])<br></code></pre></div></td></tr></table></figure><p>å›¾ç¤ºä¸ºï¼š</p><p><img src="/img/pytorch/4.png" /></p><p>éšåæˆ‘ä»¬è¦å­¦ä¹ çš„æ˜¯conv2dä¸­çš„paddingå‚æ•°ï¼Œå®ƒæ˜¯å¯¹è¾“å…¥å›¾åƒçš„å‘¨å›´è¿›è¡Œå¡«å……ï¼Œå¹¶è®¾ç½®å¡«å……å€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">output3 = F.conv2d(<span class="hljs-built_in">input</span>, kernel, stride=<span class="hljs-number">1</span>, padding=<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(output3)<br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tensor([[[[ 1,  3,  4, 10,  8],<br>          [ 5, 10, 12, 12,  6],<br>          [ 7, 18, 16, 16,  8],<br>          [11, 13,  9,  3,  4],<br>          [14, 13,  9,  7,  4]]]])<br></code></pre></div></td></tr></table></figure><p>å›¾ç¤ºä¸ºï¼š</p><p><img src="/img/pytorch/5.png" /></p><p>ç°åœ¨å¯¹å·ç§¯å±‚çš„çŸ¥è¯†è¿›è¡Œäº†å­¦ä¹ åæ­£å¼æ¥æ—¶å­¦ä¹ å·ç§¯å±‚æ˜¯å¦‚ä½•æ­å»ºçš„ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨çš„æ˜¯torch.nnä¸­çš„conv2dæ–¹æ³•ï¼Œå…¶æ–¹æ³•çš„å‚æ•°è§£é‡Šåœ¨å®˜æ–¹æ–‡æ¡£ä¸­å¦‚ä¸‹ï¼š</p><ul><li><strong>in_channels</strong> (<ahref="https://docs.python.org/3/library/functions.html#int"><em>int</em></a>)â€“ Number of channels in the input image</li><li><strong>out_channels</strong> (<ahref="https://docs.python.org/3/library/functions.html#int"><em>int</em></a>)â€“ Number of channels produced by the convolution</li><li><strong>kernel_size</strong> (<ahref="https://docs.python.org/3/library/functions.html#int"><em>int</em></a><em>or</em> <ahref="https://docs.python.org/3/library/stdtypes.html#tuple"><em>tuple</em></a>)â€“ Size of the convolving kernel</li><li><strong>stride</strong> (<ahref="https://docs.python.org/3/library/functions.html#int"><em>int</em></a><em>or</em> <ahref="https://docs.python.org/3/library/stdtypes.html#tuple"><em>tuple</em></a><em>,</em><em>optional</em>) â€“ Stride of the convolution. Default: 1</li><li><strong>padding</strong> (<ahref="https://docs.python.org/3/library/functions.html#int"><em>int</em></a><em>,</em><ahref="https://docs.python.org/3/library/stdtypes.html#tuple"><em>tuple</em></a><em>or</em> <ahref="https://docs.python.org/3/library/stdtypes.html#str"><em>str</em></a><em>,</em><em>optional</em>) â€“ Padding added to all four sides of the input.Default: 0</li><li><strong>padding_mode</strong> (*string**,* <em>optional</em>) â€“<code>'zeros'</code>, <code>'reflect'</code>, <code>'replicate'</code>or <code>'circular'</code>. Default: <code>'zeros'</code></li><li><strong>dilation</strong> (<ahref="https://docs.python.org/3/library/functions.html#int"><em>int</em></a><em>or</em> <ahref="https://docs.python.org/3/library/stdtypes.html#tuple"><em>tuple</em></a><em>,</em><em>optional</em>) â€“ Spacing between kernel elements. Default: 1</li><li><strong>groups</strong> (<ahref="https://docs.python.org/3/library/functions.html#int"><em>int</em></a><em>,</em><em>optional</em>) â€“ Number of blocked connections from input channelsto output channels. Default: 1</li><li><strong>bias</strong> (<ahref="https://docs.python.org/3/library/functions.html#bool"><em>bool</em></a><em>,</em><em>optional</em>) â€“ If <code>True</code>, adds a learnable bias to theoutput. Default: <code>True</code></li></ul><p><img src="/img/pytorch/3.png" /></p><p>æˆ‘ä»¬ç®€å•çš„å¯¹å›¾åƒè¿›è¡Œå·ç§¯å¤„ç†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torchvision<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> torch.nn <span class="hljs-keyword">import</span> Conv2d<br><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader<br><span class="hljs-keyword">from</span> torch.utils.tensorboard <span class="hljs-keyword">import</span> SummaryWriter<br><br>test_data = torchvision.datasets.CIFAR10(<span class="hljs-string">&quot;./dataset&quot;</span>, train=<span class="hljs-literal">False</span>, transform=torchvision.transforms.ToTensor(),<br>                                         download=<span class="hljs-literal">True</span>)<br>dataloader = DataLoader(dataset=test_data, batch_size=<span class="hljs-number">64</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(MyModel, self).__init__()<br>        self.conv1 = Conv2d(in_channels=<span class="hljs-number">3</span>, out_channels=<span class="hljs-number">6</span>, kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">1</span>, padding=<span class="hljs-number">0</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        x = self.conv1(x)<br>        <span class="hljs-keyword">return</span> x<br><br><br>myModel = MyModel()<br><br>writer = SummaryWriter(<span class="hljs-string">&quot;logs&quot;</span>)<br>step = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> dataloader:<br>    imgs, targets = data<br>    output = myModel(imgs)<br>    <span class="hljs-comment"># print(imgs.shape)</span><br>    <span class="hljs-comment"># print(output.shape)</span><br><br>    <span class="hljs-comment"># torch.Size([64, 3, 32, 32])</span><br>    writer.add_images(<span class="hljs-string">&quot;input&quot;</span>, imgs, step)<br>    <span class="hljs-comment"># torch.Size([64, 6, 32, 32]) -&gt; [xxx, 3, 32, 32]ï¼Œå› ä¸ºout_channelsä¸º6æ²¡åŠæ³•addè¿›å»</span><br>    output = torch.reshape(output, (-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>))<br>    writer.add_images(<span class="hljs-string">&quot;output&quot;</span>, output, step)<br><br>    step = step + <span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><p>è¿è¡Œç»“æœåœ¨tensorboardä¸Šæ˜¾ç¤ºä¸ºï¼š</p><p><img src="/img/pytorch/6.png" /></p><p><img src="/img/pytorch/7.png" /></p><h2 id="æ± åŒ–å±‚">6ã€æ± åŒ–å±‚</h2><p>æˆ‘ä»¬è¦ä½¿ç”¨çš„æ˜¯torch.nnä¸­çš„MaxPool2dæ–¹æ³•ï¼Œå…¶ä¸­å‚æ•°è§£é‡Šä¸ºï¼š</p><ul><li><strong>kernel_size</strong> â€“ the size of the window to take a maxover</li><li><strong>stride</strong> â€“ the stride of the window. Default value is<code>kernel_size</code></li><li><strong>padding</strong> â€“ implicit zero padding to be added on bothsides</li><li><strong>dilation</strong> â€“ a parameter that controls the stride ofelements in the window</li><li><strong>return_indices</strong> â€“ if <code>True</code>, will returnthe max indices along with the outputs. Useful for <ahref="https://pytorch.org/docs/stable/generated/torch.nn.MaxUnpool2d.html#torch.nn.MaxUnpool2d"><code>torch.nn.MaxUnpool2d</code></a>later</li><li><strong>ceil_mode</strong> â€“ when True, will use ceil instead offloor to compute the output shape</li></ul><p>å¯¹äºceil_modeçš„ä¸¤ç§æƒ…å†µå¦‚ä¸‹å›¾ç¤ºæ„ï¼š</p><p><img src="/img/pytorch/8.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> torch.nn <span class="hljs-keyword">import</span> MaxPool2d<br><br><span class="hljs-built_in">input</span> = torch.tensor([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>],<br>                      [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>],<br>                      [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],<br>                      [<span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>],<br>                      [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]], dtype=torch.float32)<br><span class="hljs-built_in">input</span> = torch.reshape(<span class="hljs-built_in">input</span>, (-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>))<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(MyModel, self).__init__()<br>        self.maxpool1 = MaxPool2d(kernel_size=<span class="hljs-number">3</span>, ceil_mode=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, <span class="hljs-built_in">input</span></span>):<br>        output = self.maxpool1(<span class="hljs-built_in">input</span>)<br>        <span class="hljs-keyword">return</span> output<br><br><br>myModel = MyModel()<br>output = myModel(<span class="hljs-built_in">input</span>)<br><span class="hljs-built_in">print</span>(output)<br></code></pre></div></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tensor([[[[2., 3.],<br>          [5., 1.]]]])<br></code></pre></div></td></tr></table></figure><p>å½“æˆ‘ä»¬å°†ceil_modeä¿®æ”¹ä¸ºFalseåï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">self.maxpool1 = MaxPool2d(kernel_size=<span class="hljs-number">3</span>, ceil_mode=<span class="hljs-literal">False</span>)<br></code></pre></div></td></tr></table></figure><p>ç»“æœä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tensor([[[[2.]]]])<br></code></pre></div></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç›´è§‚çš„æ„Ÿå—ä¸€ä¸‹æœ€å¤§æ± åŒ–åçš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å°†è¾“å…¥æ¢æˆæˆ‘ä»¬çš„æ•°æ®é›†ï¼Œåœ¨tensorboardä¸ŠæŸ¥çœ‹è¾“å…¥è¾“å‡ºçš„å·®åˆ«ï¼š</p><p><img src="/img/pytorch/9.png" /></p><h2 id="éçº¿æ€§æ¿€æ´»">7ã€éçº¿æ€§æ¿€æ´»</h2><p>é¦–å…ˆæˆ‘ä»¬è¦ä½¿ç”¨çš„æ˜¯torch.nnä¸­çš„ReLUæ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> torch.nn <span class="hljs-keyword">import</span> ReLU<br><br><span class="hljs-built_in">input</span> = torch.tensor([[<span class="hljs-number">1</span>, -<span class="hljs-number">0.5</span>],<br>                      [-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>]])<br><br><span class="hljs-built_in">input</span> = torch.reshape(<span class="hljs-built_in">input</span>, (-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>))<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(MyModel, self).__init__()<br>        self.relu1 = ReLU()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, <span class="hljs-built_in">input</span></span>):<br>        output = self.relu1(<span class="hljs-built_in">input</span>)<br>        <span class="hljs-keyword">return</span> output<br><br><br>myModel = MyModel()<br>output = myModel(<span class="hljs-built_in">input</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">input</span>)<br><span class="hljs-built_in">print</span>(output)<br></code></pre></div></td></tr></table></figure><p>ç»“æœä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tensor([[[[ 1.0000, -0.5000],<br>          [-1.0000,  3.0000]]]])<br>tensor([[[[1., 0.],<br>          [0., 3.]]]])<br></code></pre></div></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨torch.nnä¸­çš„Sigmoidæ–¹æ³•æ›´ç›´è§‚çš„æ¥æŸ¥çœ‹ç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torchvision<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> torch.nn <span class="hljs-keyword">import</span> Sigmoid<br><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader<br><span class="hljs-keyword">from</span> torch.utils.tensorboard <span class="hljs-keyword">import</span> SummaryWriter<br><br>test_data = torchvision.datasets.CIFAR10(<span class="hljs-string">&quot;./dataset&quot;</span>, train=<span class="hljs-literal">False</span>, transform=torchvision.transforms.ToTensor(),<br>                                         download=<span class="hljs-literal">True</span>)<br>dataloader = DataLoader(dataset=test_data, batch_size=<span class="hljs-number">64</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(MyModel, self).__init__()<br>        self.sigmoid1 = Sigmoid()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, <span class="hljs-built_in">input</span></span>):<br>        output = self.sigmoid1(<span class="hljs-built_in">input</span>)<br>        <span class="hljs-keyword">return</span> output<br><br>myModel = MyModel()<br>writer = SummaryWriter(<span class="hljs-string">&quot;logs_sigmoid&quot;</span>)<br>step = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> dataloader:<br>    imgs, target = data<br>    output = myModel(imgs)<br>    writer.add_images(<span class="hljs-string">&quot;input&quot;</span>, imgs, step)<br>    writer.add_images(<span class="hljs-string">&quot;output&quot;</span>, output, step)<br>    step = step + <span class="hljs-number">1</span><br><br>writer.close()<br></code></pre></div></td></tr></table></figure><p>åœ¨tensorboardä¸­æŸ¥çœ‹è¿è¡Œç»“æœï¼š</p><p><img src="/img/pytorch/10.png" /></p><h2 id="çº¿æ€§å±‚-åŠå…¶ä»–å±‚">8ã€çº¿æ€§å±‚ åŠå…¶ä»–å±‚</h2><p>ä¸»è¦è¿˜æ˜¯æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚</p><h2id="æ­å»ºå°å®ä¾‹å’Œsequentialçš„ä½¿ç”¨">9ã€æ­å»ºå°å®ä¾‹å’ŒSequentialçš„ä½¿ç”¨</h2><p>æˆ‘ä»¬ä½¿ç”¨ä¹‹å‰å­¦ä¹ è¿‡çš„åŸºç¡€æ¥æ­å»ºä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œï¼Œä¾‹å¦‚æˆ‘ä»¬æ¥æ­å»ºcifar10çš„æ¨¡å‹ï¼Œå…¶å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="/img/pytorch/11.png" /></p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(MyModel, self).__init__()<br>        self.conv1 = Conv2d(<span class="hljs-number">3</span>, <span class="hljs-number">32</span>, <span class="hljs-number">5</span>, padding=<span class="hljs-number">2</span>)<br>        self.maxpool1 = MaxPool2d(<span class="hljs-number">2</span>)<br>        self.conv2 = Conv2d(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">5</span>, padding=<span class="hljs-number">2</span>)<br>        self.maxpool2 = MaxPool2d(<span class="hljs-number">2</span>)<br>        self.conv3 = Conv2d(<span class="hljs-number">32</span>, <span class="hljs-number">64</span>, <span class="hljs-number">5</span>, padding=<span class="hljs-number">2</span>)<br>        self.maxpool3 = MaxPool2d(<span class="hljs-number">2</span>)<br>        self.flatten = Flatten()<br>        self.linear1 = Linear(<span class="hljs-number">1024</span>, <span class="hljs-number">64</span>)<br>        self.linear2 = Linear(<span class="hljs-number">64</span>, <span class="hljs-number">10</span>)<br><br>        self.model1 = Sequential(<br>            Conv2d(<span class="hljs-number">3</span>, <span class="hljs-number">32</span>, <span class="hljs-number">5</span>, padding=<span class="hljs-number">2</span>)<br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        x = self.conv1(x)<br>        x = self.maxpool1(x)<br>        x = self.conv2(x)<br>        x = self.maxpool2(x)<br>        x = self.conv2(x)<br>        x = self.maxpool2(x)<br>        x = self.flatten(x)<br>        x = self.linear1(x)<br>        x = self.linear2(x)<br>        <span class="hljs-keyword">return</span> x<br></code></pre></div></td></tr></table></figure><p>å¼•å…¥äº†Sequentialæ–¹æ³•åå¯ä»¥å°†æˆ‘ä»¬æ­å»ºçš„æ¨¡å‹ç®€å†™å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.model1 = Sequential(<br>            Conv2d(<span class="hljs-number">3</span>, <span class="hljs-number">32</span>, <span class="hljs-number">5</span>, padding=<span class="hljs-number">2</span>),<br>            MaxPool2d(<span class="hljs-number">2</span>),<br>            Conv2d(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">5</span>, padding=<span class="hljs-number">2</span>),<br>            MaxPool2d(<span class="hljs-number">2</span>),<br>            Conv2d(<span class="hljs-number">32</span>, <span class="hljs-number">64</span>, <span class="hljs-number">5</span>, padding=<span class="hljs-number">2</span>),<br>            MaxPool2d(<span class="hljs-number">2</span>),<br>            Flatten(),<br>            Linear(<span class="hljs-number">1024</span>, <span class="hljs-number">64</span>),<br>            Linear(<span class="hljs-number">64</span>, <span class="hljs-number">10</span>)<br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        x = self.model1(x)<br>        <span class="hljs-keyword">return</span> x<br></code></pre></div></td></tr></table></figure><h2 id="æŸå¤±å‡½æ•°ä¸åå‘ä¼ æ’­">10ã€æŸå¤±å‡½æ•°ä¸åå‘ä¼ æ’­</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨torch.nnä¸­çš„L1Lossä»¥åŠMSELossæ–¹æ³•æ¥æ„é€ æŸå¤±å‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-built_in">input</span> = torch.tensor([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], dtype=torch.float32)<br>target = torch.tensor([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>], dtype=torch.float32)<br><br><span class="hljs-built_in">input</span> = torch.reshape(<span class="hljs-built_in">input</span>, (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>))<br>target = torch.reshape(target, (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>))<br><br>loss = L1Loss(reduction=<span class="hljs-string">&#x27;sum&#x27;</span>)<br>result = loss(<span class="hljs-built_in">input</span>, target)<br><br>loss_mse = nn.MSELoss()<br>result_mse = loss_mse(<span class="hljs-built_in">input</span>, target)<br><br><span class="hljs-built_in">print</span>(result)<br><span class="hljs-built_in">print</span>(result_mse)<br></code></pre></div></td></tr></table></figure><p>è¿è¡Œç»“æœä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tensor(2.)<br>tensor(1.3333)<br></code></pre></div></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨äº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°æ¥è¿›è¡Œåå‘ä¼ æ’­ï¼Œåˆ©ç”¨backwardæ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">myModel = MyModel()<br>loss = nn.CrossEntropyLoss()<br><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> dataloader:<br>    imgs, targets = data<br>    output = myModel(imgs)<br>    result_loss = loss(output, targets)<br>    result_loss.backward()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ok&quot;</span>)<br></code></pre></div></td></tr></table></figure><h2 id="ä¼˜åŒ–å™¨">11ã€ä¼˜åŒ–å™¨</h2><p>ä½¿ç”¨torch.optimä¸­çš„ä¼˜åŒ–å™¨:</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">myModel = MyModel()<br>loss = nn.CrossEntropyLoss()<br>optim = torch.optim.SGD(myModel.parameters(), lr=<span class="hljs-number">0.01</span>)<br><span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>    runing_loss = <span class="hljs-number">0.0</span><br>    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> dataloader:<br>        imgs, targets = data<br>        output = myModel(imgs)<br>        result_loss = loss(output, targets)<br>        optim.zero_grad()<br>        result_loss.backward()<br>        optim.step()<br>        runing_loss = runing_loss + result_loss<br>    <span class="hljs-built_in">print</span>(runing_loss)<br></code></pre></div></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">tensor(<span class="hljs-number">18666.8984</span>, grad_fn=&lt;AddBackward0&gt;)<br>tensor(<span class="hljs-number">16161.6846</span>, grad_fn=&lt;AddBackward0&gt;)<br>tensor(<span class="hljs-number">15338.8057</span>, grad_fn=&lt;AddBackward0&gt;)<br>...<br></code></pre></div></td></tr></table></figure><h2 id="ç°æœ‰ç½‘ç»œæ¨¡å‹çš„ä½¿ç”¨ä¸ä¿®æ”¹">12ã€ç°æœ‰ç½‘ç»œæ¨¡å‹çš„ä½¿ç”¨ä¸ä¿®æ”¹</h2><p>æˆ‘ä»¬ä½¿ç”¨torchvisionä¸­ç°æœ‰çš„vgg16æ¨¡å‹è¿›è¡Œä½¿ç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">vgg16_true = torchvison.models.vgg16(pretrained=<span class="hljs-literal">True</span>)<br><span class="hljs-comment"># æ·»åŠ å±‚</span><br>vgg16_true.classifier.add_module(<span class="hljs-string">&#x27;add_linear&#x27;</span>, nn.Linear(<span class="hljs-number">1000</span>, <span class="hljs-number">10</span>))<br><span class="hljs-comment"># ä¿®æ”¹å±‚</span><br>vgg16_true.classifier[<span class="hljs-number">6</span>] = nn.Linear(<span class="hljs-number">4096</span>, <span class="hljs-number">10</span>)<br></code></pre></div></td></tr></table></figure><h2 id="ç½‘ç»œæ¨¡å‹çš„ä¿å­˜ä¸è¯»å–">13ã€ç½‘ç»œæ¨¡å‹çš„ä¿å­˜ä¸è¯»å–</h2><p>ä¿å­˜æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">vgg16 = torchvision.models.vgg16(pretrained=<span class="hljs-literal">False</span>)<br><span class="hljs-comment"># ä¿å­˜æ–¹æ³•1</span><br>torch.save(vgg16, <span class="hljs-string">&quot;vgg16_method1.pth&quot;</span>)<br><br><span class="hljs-comment"># ä¿å­˜æ–¹æ³•äºŒï¼Œå°†æ¨¡å‹å‚æ•°ä¿å­˜ä¸ºå­—å…¸ï¼ˆå®˜æ–¹æ¨èï¼‰</span><br>torch.save(vgg16.state_dict(), <span class="hljs-string">&quot;vgg16_method2.pth&quot;</span>)<br></code></pre></div></td></tr></table></figure><p>è¯»å–æ–¹æ³•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># æ–¹æ³•1ä¿å­˜çš„æ¨¡å‹è¿›è¡Œè¯»å–</span><br>model = torch.load(<span class="hljs-string">&quot;vgg16_method1.pth&quot;</span>)<br><br><span class="hljs-comment"># æ–¹æ³•2ä¿å­˜çš„æ¨¡å‹è¿›è¡Œè¯»å–</span><br>vgg16 = vgg16 = torchvision.models.vgg16(pretrained=<span class="hljs-literal">False</span>)<br>vgg16.load_state_dict(torch.load(<span class="hljs-string">&quot;vgg16_method1.pth&quot;</span>))<br></code></pre></div></td></tr></table></figure><h2 id="å®Œæ•´çš„æ¨¡å‹è®­ç»ƒ">14ã€å®Œæ•´çš„æ¨¡å‹è®­ç»ƒ</h2><p>model.pyï¼šç”¨äºä¿å­˜ç½‘ç»œæ¨¡å‹</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(MyModel, self).__init__()<br>        self.model = nn.Sequential(<br>            nn.Conv2d(<span class="hljs-number">3</span>, <span class="hljs-number">32</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br>            nn.Conv2d(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br>            nn.Conv2d(<span class="hljs-number">32</span>, <span class="hljs-number">64</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br>            nn.Flatten(),<br>            nn.Linear(<span class="hljs-number">64</span> * <span class="hljs-number">4</span> * <span class="hljs-number">4</span>, <span class="hljs-number">64</span>),<br>            nn.Linear(<span class="hljs-number">64</span>, <span class="hljs-number">10</span>)<br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        x = self.model(x)<br>        <span class="hljs-keyword">return</span> x<br><br><br><span class="hljs-comment"># éªŒè¯</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    myModel = MyModel()<br>    <span class="hljs-built_in">input</span> = torch.ones((<span class="hljs-number">64</span>, <span class="hljs-number">3</span>, <span class="hljs-number">32</span>, <span class="hljs-number">32</span>))<br>    output = myModel(<span class="hljs-built_in">input</span>)<br>    <span class="hljs-built_in">print</span>(output.shape)<br></code></pre></div></td></tr></table></figure><p>train.pyï¼šè¿›è¡Œç½‘ç»œè®­ç»ƒ</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torchvision<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader<br><span class="hljs-keyword">from</span> torch.utils.tensorboard <span class="hljs-keyword">import</span> SummaryWriter<br><br><span class="hljs-keyword">from</span> model <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># å‡†å¤‡æ•°æ®é›†</span><br>train_data = torchvision.datasets.CIFAR10(<span class="hljs-string">&quot;./dataset&quot;</span>, train=<span class="hljs-literal">True</span>, transform=torchvision.transforms.ToTensor(),<br>                                         download=<span class="hljs-literal">True</span>)<br>test_data = torchvision.datasets.CIFAR10(<span class="hljs-string">&quot;./dataset&quot;</span>, train=<span class="hljs-literal">False</span>, transform=torchvision.transforms.ToTensor(),<br>                                         download=<span class="hljs-literal">True</span>)<br><br><span class="hljs-comment"># è·å–æ•°æ®é›†é•¿åº¦</span><br>train_data_length = <span class="hljs-built_in">len</span>(train_data)<br>test_data_length = <span class="hljs-built_in">len</span>(test_data)<br><br><span class="hljs-comment"># åˆ©ç”¨DataLoaderåŠ è½½æ•°æ®</span><br>train_dataloader = DataLoader(train_data, batch_size=<span class="hljs-number">64</span>)<br>test_dataloader = DataLoader(test_data, batch_size=<span class="hljs-number">64</span>)<br><br><span class="hljs-comment"># åˆ›å»ºç½‘ç»œæ¨¡å‹</span><br>myModel = MyModel()<br><br><span class="hljs-comment"># æŸå¤±å‡½æ•°</span><br>loss_fn = nn.CrossEntropyLoss()<br><br><span class="hljs-comment"># ä¼˜åŒ–å™¨</span><br>learning_rate = <span class="hljs-number">0.01</span><br>optimizer = torch.optim.SGD(myModel.parameters(), lr=learning_rate)<br><br><span class="hljs-comment"># è®¾ç½®è®­ç»ƒç½‘ç»œçš„ä¸€äº›å‚æ•°</span><br><span class="hljs-comment"># è®°å½•è®­ç»ƒçš„æ¬¡æ•°</span><br>total_train_step = <span class="hljs-number">0</span><br><span class="hljs-comment"># è®°å½•æµ‹è¯•çš„æ¬¡æ•°</span><br>total_test_step = <span class="hljs-number">0</span><br><span class="hljs-comment"># è®­ç»ƒè®ºæ•°</span><br>epoch = <span class="hljs-number">10</span><br><br><span class="hljs-comment"># æ·»åŠ tensorboard</span><br>writer = SummaryWriter(<span class="hljs-string">&quot;logs_train&quot;</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(epoch):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;------ç¬¬%dè½®è®­ç»ƒå¼€å§‹------&quot;</span> % (i+<span class="hljs-number">1</span>))<br><br>    <span class="hljs-comment"># è®­ç»ƒæ­¥éª¤å¼€å§‹</span><br>    myModel.train()<br>    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> train_dataloader:<br>        imgs, targets = data<br>        outputs = myModel(imgs)<br>        loss = loss_fn(outputs, targets)<br><br>        <span class="hljs-comment"># ä¼˜åŒ–å™¨ä¼˜åŒ–æ¨¡å‹</span><br>        <span class="hljs-comment"># åˆ©ç”¨ä¼˜åŒ–å™¨è¿›è¡Œæ¢¯åº¦æ¸…é›¶</span><br>        optimizer.zero_grad()<br>        <span class="hljs-comment"># åå‘ä¼ æ’­</span><br>        loss.backward()<br>        optimizer.step()<br><br>        total_train_step = total_train_step + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> total_train_step % <span class="hljs-number">100</span> == <span class="hljs-number">0</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è®­ç»ƒæ¬¡æ•°ï¼š&#123;&#125;ï¼Œlossï¼š&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(total_train_step, loss.item()))<br>            writer.add_scalar(<span class="hljs-string">&quot;train_loss&quot;</span>, loss.item(), total_train_step)<br><br>    <span class="hljs-comment"># æµ‹è¯•æ­¥éª¤å¼€å§‹</span><br>    myModel.<span class="hljs-built_in">eval</span>()<br>    total_test_loss = <span class="hljs-number">0</span><br>    total_accuracy = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">with</span> torch.no_grad():<br>        <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> test_dataloader:<br>            imgs, targets = data<br>            outputs = myModel(imgs)<br>            loss = loss_fn(outputs, targets)<br>            total_test_loss = total_test_loss + loss.item()<br>            accuracy = (outputs.argmax(<span class="hljs-number">1</span>) == targets).<span class="hljs-built_in">sum</span>()<br>            total_accuracy = total_accuracy + accuracy<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ•´ä½“æµ‹è¯•é›†ä¸Šçš„Lossï¼š&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(total_test_loss))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ•´ä½“æµ‹è¯•é›†ä¸Šçš„æ­£ç¡®ç‡ï¼š&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(total_accuracy/test_data_length))<br>    writer.add_scalar(<span class="hljs-string">&quot;test_loss&quot;</span>, total_test_loss, total_test_step)<br>    writer.add_scalar(<span class="hljs-string">&quot;test_accuracy&quot;</span>, total_accuracy/test_data_length, total_test_step)<br>    total_test_step = total_test_step + <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># ä¿å­˜æ¯è½®çš„æ•°æ®</span><br>    torch.save(myModel, <span class="hljs-string">&quot;myModel_&#123;&#125;.pth&quot;</span>.<span class="hljs-built_in">format</span>(i))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ¨¡å‹å·²ä¿å­˜&quot;</span>)<br><br>writer.close()<br></code></pre></div></td></tr></table></figure><h2 id="ä½¿ç”¨gpuè®­ç»ƒ">15ã€ä½¿ç”¨GPUè®­ç»ƒ</h2><h3 id="æ–¹æ³•ä¸€">æ–¹æ³•ä¸€</h3><p>æˆ‘ä»¬éœ€è¦å¯¹ç½‘ç»œæ¨¡å‹ã€æ•°æ®ã€æŸå¤±å‡½æ•°è¿›è¡Œä¿®æ”¹</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># æ„å»ºæ¨¡å‹</span><br>myModel = MyModel()<br><span class="hljs-keyword">if</span> torch.cuda.is_available():<br>    myModel = myModel.cuda()<br>    <br><span class="hljs-comment"># æŸå¤±å‡½æ•°</span><br>loss_fn = nn.CrossEntropyLoss()<br><span class="hljs-keyword">if</span> torch.cuda.is_available():<br>    loss_fn = loss_fn.cuda()<br>    <br>imgs, targets = data<br><span class="hljs-keyword">if</span> torch.cuda.is_available():<br>imgs = imgs.cuda()<br>targets = targets.cuda()<br></code></pre></div></td></tr></table></figure><h3 id="æ–¹æ³•äºŒ">æ–¹æ³•äºŒ</h3><p>éœ€è¦åœ¨æ–‡ä»¶æœ€å¼€å§‹å®šä¹‰è®­ç»ƒçš„è®¾å¤‡</p><p>æ­¤æ—¶ä¸ºå°†è®¾å¤‡è®¾ç½®ä¸ºcpu</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># å®šä¹‰è®­ç»ƒçš„è®¾å¤‡</span><br>device = torch.device(<span class="hljs-string">&quot;cpu&quot;</span>)<br><br><span class="hljs-comment"># æ„å»ºæ¨¡å‹</span><br>myModel = MyModel()<br>myModel.to(device)<span class="hljs-comment"># æ¨¡å‹å’ŒæŸå¤±å‡½æ•°ä¸ç”¨é‡æ–°èµ‹å€¼</span><br><br><span class="hljs-comment"># æŸå¤±å‡½æ•°</span><br>loss_fn = nn.CrossEntropyLoss()<br>loss_fn.to(device)<br><br>imgs, targets = data<br>imgs = imgs.to(device)<span class="hljs-comment"># æ•°æ®éœ€è¦é‡æ–°èµ‹å€¼</span><br>targets = targets.to(device)<br></code></pre></div></td></tr></table></figure><p>å¦‚æœè¦ä½¿ç”¨gpuéœ€è¦å¦‚ä¸‹è®¾ç½®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># å®šä¹‰è®­ç»ƒçš„è®¾å¤‡</span><br>device = torch.device(<span class="hljs-string">&quot;cuda&quot;</span>)<br></code></pre></div></td></tr></table></figure><p>å¦‚æœæœ‰å¤šä¸ªgpuï¼Œå¯ä»¥æŒ‰ç…§å¦‚ä¸‹é€‰æ‹©è®¾ç½®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-comment"># å®šä¹‰è®­ç»ƒçš„è®¾å¤‡</span><br>device = torch.device(<span class="hljs-string">&quot;cudaï¼š0&quot;</span>)<br></code></pre></div></td></tr></table></figure><h2 id="æ¨¡å‹éªŒè¯å¥—è·¯">16ã€æ¨¡å‹éªŒè¯å¥—è·¯</h2><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">image_path = <span class="hljs-string">&quot;./img/dog.png&quot;</span><br><br>image = Image.<span class="hljs-built_in">open</span>(image_path)<br>image = image.convert(<span class="hljs-string">&#x27;RGB&#x27;</span>)<br><br>transform = torchvision.transforms.Compose([torchvision.transforms.Resize((<span class="hljs-number">32</span>, <span class="hljs-number">32</span>)),<br>                                            torchvision.transforms.ToTensor()])<br><br>image = transform(image)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(MyModel, self).__init__()<br>        self.model = nn.Sequential(<br>            nn.Conv2d(<span class="hljs-number">3</span>, <span class="hljs-number">32</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br>            nn.Conv2d(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br>            nn.Conv2d(<span class="hljs-number">32</span>, <span class="hljs-number">64</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br>            nn.Flatten(),<br>            nn.Linear(<span class="hljs-number">64</span> * <span class="hljs-number">4</span> * <span class="hljs-number">4</span>, <span class="hljs-number">64</span>),<br>            nn.Linear(<span class="hljs-number">64</span>, <span class="hljs-number">10</span>)<br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        x = self.model(x)<br>        <span class="hljs-keyword">return</span> x<br><br><br>myModel = torch.load(<span class="hljs-string">&quot;myModel_0.pth&quot;</span>)<br><span class="hljs-built_in">print</span>(myModel)<br>image = torch.reshape(image, (<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">32</span>, <span class="hljs-number">32</span>))<br>myModel.<span class="hljs-built_in">eval</span>()<br><span class="hljs-keyword">with</span> torch.no_grad():<br>    output = myModel(image)<br><span class="hljs-built_in">print</span>(output)<br><span class="hljs-built_in">print</span>(output.argmax(<span class="hljs-number">1</span>))<br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tensor([[ 0.3308,  0.0307,  0.9064,  0.9474,  0.2715,  0.8123, -0.4077,  0.2044,<br>         -0.4149, -1.0106]])<br>tensor([3])<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ€åé¢„æµ‹æˆ‘ä»¬çš„å›¾ç‰‡å±äºç¬¬ä¸‰ç±»</p>]]></content>
    
    
    <categories>
      
      <category>Deep Learning</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>çº¿æ€§æ¨¡å‹</title>
    <link href="/2022/04/26/%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B/"/>
    <url>/2022/04/26/%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="çº¿æ€§æ¨¡å‹">çº¿æ€§æ¨¡å‹</h1><h2 id="çº¿æ€§å›å½’">1ã€çº¿æ€§å›å½’</h2><p>å‡å¦‚å’±ä»¬æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œé‡Œé¢çš„æ•°æ®æ˜¯ä¿„å‹’å†ˆå·æ³¢ç‰¹å…°å¸‚çš„ <spanclass="math inline">\(47\)</span> å¥—æˆ¿å±‹çš„é¢ç§¯å’Œä»·æ ¼ï¼š</p><table><thead><tr class="header"><th style="text-align: center;">å±…ä½é¢ç§¯ï¼ˆå¹³æ–¹è‹±å°ºï¼‰</th><th style="text-align: center;">ä»·æ ¼ï¼ˆåƒç¾å…ƒï¼‰</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;"><spanclass="math inline">\(2104\)</span></td><td style="text-align: center;"><spanclass="math inline">\(400\)</span></td></tr><tr class="even"><td style="text-align: center;"><spanclass="math inline">\(1600\)</span></td><td style="text-align: center;"><spanclass="math inline">\(330\)</span></td></tr><tr class="odd"><td style="text-align: center;"><spanclass="math inline">\(2400\)</span></td><td style="text-align: center;"><spanclass="math inline">\(369\)</span></td></tr><tr class="even"><td style="text-align: center;"><spanclass="math inline">\(1416\)</span></td><td style="text-align: center;"><spanclass="math inline">\(232\)</span></td></tr><tr class="odd"><td style="text-align: center;"><spanclass="math inline">\(3000\)</span></td><td style="text-align: center;"><spanclass="math inline">\(540\)</span></td></tr><tr class="even"><td style="text-align: center;">â€¦â€¦</td><td style="text-align: center;">â€¦â€¦</td></tr></tbody></table><p><img src="/img/çº¿æ€§æ¨¡å‹/1.png" /></p><p>å¦‚æœæ¥äº†ä¸€ä¸ªæ–°çš„é¢ç§¯ï¼Œå‡è®¾åœ¨é”€å”®ä»·é’±çš„è®°å½•ä¸­æ²¡æœ‰çš„ï¼Œæˆ‘ä»¬æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€æ¡æ›²çº¿å»å°½é‡å‡†çš„æ‹Ÿåˆè¿™äº›æ•°æ®ï¼Œç„¶åå¦‚æœæœ‰æ–°çš„è¾“å…¥è¿‡æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ›²çº¿ä¸Šè¿™ä¸ªç‚¹å¯¹åº”çš„å€¼è¿”å›ã€‚è¿™å°±æ˜¯çº¿æ€§å›å½’çš„æ€æƒ³ã€‚</p><p>ä¸ºäº†è®©æˆ‘ä»¬çš„æˆ¿å±‹æ¡ˆä¾‹æ›´æœ‰æ„æ€ï¼Œå’±ä»¬ç¨å¾®å¯¹æ•°æ®é›†è¿›è¡Œä¸€ä¸‹è¡¥å……ï¼Œå¢åŠ ä¸Šæ¯ä¸€ä¸ªæˆ¿å±‹çš„å§å®¤æ•°ç›®ï¼š</p><table><thead><tr class="header"><th style="text-align: center;">å±…ä½é¢ç§¯ï¼ˆå¹³æ–¹è‹±å°ºï¼‰</th><th style="text-align: center;">å§å®¤æ•°ç›®</th><th style="text-align: center;">ä»·æ ¼ï¼ˆåƒç¾å…ƒï¼‰</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;"><spanclass="math inline">\(2104\)</span></td><td style="text-align: center;"><spanclass="math inline">\(3\)</span></td><td style="text-align: center;"><spanclass="math inline">\(400\)</span></td></tr><tr class="even"><td style="text-align: center;"><spanclass="math inline">\(1600\)</span></td><td style="text-align: center;"><spanclass="math inline">\(3\)</span></td><td style="text-align: center;"><spanclass="math inline">\(330\)</span></td></tr><tr class="odd"><td style="text-align: center;"><spanclass="math inline">\(2400\)</span></td><td style="text-align: center;"><spanclass="math inline">\(3\)</span></td><td style="text-align: center;"><spanclass="math inline">\(369\)</span></td></tr><tr class="even"><td style="text-align: center;"><spanclass="math inline">\(1416\)</span></td><td style="text-align: center;"><spanclass="math inline">\(2\)</span></td><td style="text-align: center;"><spanclass="math inline">\(232\)</span></td></tr><tr class="odd"><td style="text-align: center;"><spanclass="math inline">\(3000\)</span></td><td style="text-align: center;"><spanclass="math inline">\(4\)</span></td><td style="text-align: center;"><spanclass="math inline">\(540\)</span></td></tr><tr class="even"><td style="text-align: center;">â€¦â€¦</td><td style="text-align: center;">â€¦â€¦</td><td style="text-align: center;">â€¦â€¦</td></tr></tbody></table><p>ä¹Ÿæ˜¯åŒæ ·çš„æ–¹æ³•ï¼Œæ­¤æ—¶çš„è‡ªå˜é‡å°±å˜æˆäº†äºŒç»´å‘é‡ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„æœºå™¨å­¦ä¹ çš„è¿‡ç¨‹ï¼Œé¦–å…ˆç»™å‡ºä¸€ä¸ªè¾“å…¥æ•°æ®ï¼Œæˆ‘ä»¬çš„ç®—æ³•ä¼šé€šè¿‡ä¸€ç³»åˆ—çš„è¿‡ç¨‹å¾—åˆ°ä¸€ä¸ªä¼°è®¡çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æœ‰èƒ½åŠ›å¯¹æ²¡æœ‰è§è¿‡çš„æ–°æ•°æ®ç»™å‡ºä¸€ä¸ªæ–°çš„ä¼°è®¡ï¼Œä¹Ÿè¢«ç§°ä¸ºæ„å»ºä¸€ä¸ªæ¨¡å‹ã€‚å°±å¦‚åŒä¸Šé¢çš„çº¿æ€§å›å½’å‡½æ•°ã€‚</p><p><img src="/img/çº¿æ€§æ¨¡å‹/2.png" /></p><p>çº¿æ€§å›å½’å‡è®¾ç‰¹å¾å’Œç»“æœæ»¡è¶³çº¿æ€§å…³ç³»ã€‚å…¶å®çº¿æ€§å…³ç³»çš„è¡¨è¾¾èƒ½åŠ›éå¸¸å¼ºå¤§ï¼Œæ¯ä¸ªç‰¹å¾å¯¹ç»“æœçš„å½±å“å¼ºå¼±å¯ä»¥æœ‰å‰é¢çš„å‚æ•°ä½“ç°ï¼Œè€Œä¸”æ¯ä¸ªç‰¹å¾å˜é‡å¯ä»¥é¦–å…ˆæ˜ å°„åˆ°ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åå†å‚ä¸çº¿æ€§è®¡ç®—ã€‚è¿™æ ·å°±å¯ä»¥è¡¨è¾¾ç‰¹å¾ä¸ç»“æœä¹‹é—´çš„éçº¿æ€§å…³ç³»ã€‚</p><p>æˆ‘ä»¬ç”¨<span class="math inline">\(x_1\)</span>ï¼Œ<spanclass="math inline">\(x_2\)</span>å»æè¿°featureé‡Œé¢çš„åˆ†é‡ï¼Œæ¯”å¦‚ <spanclass="math inline">\(x_1\)</span>=å±…ä½é¢ç§¯ï¼Œ<spanclass="math inline">\(x_2\)</span>=å§å®¤æ•°ç›®ï¼Œæˆ‘ä»¬å¯ä»¥åšå‡ºä¸€ä¸ªä¼°è®¡å‡½æ•°ï¼š<span class="math display">\[h_\theta  (x) = \theta_0 + \theta_1 \times x_1 + \theta_2 \times x_2\]</span> ç®€åŒ–ä¸€ä¸‹å°±ä¸ºï¼š <span class="math display">\[h(x) = \sum^n_{i=0}  \theta_i x_i = \theta^T x\]</span> æˆ‘ä»¬ç¨‹åºä¹Ÿéœ€è¦ä¸€ä¸ªæœºåˆ¶å»è¯„ä¼°æˆ‘ä»¬<spanclass="math inline">\(\theta\)</span>æ˜¯å¦æ¯”è¾ƒå¥½ï¼Œæ‰€ä»¥è¯´éœ€è¦å¯¹æˆ‘ä»¬åšå‡ºçš„<spanclass="math inline">\(h\)</span>å‡½æ•°è¿›è¡Œè¯„ä¼°ï¼Œä¸€èˆ¬è¿™ä¸ªå‡½æ•°ç§°ä¸ºæŸå¤±å‡½æ•°ï¼ˆloss functionï¼‰æˆ–è€…é”™è¯¯å‡½æ•°(errorfunction)ï¼Œæè¿°<span class="math inline">\(h\)</span>å‡½æ•°ä¸å¥½çš„ç¨‹åº¦ï¼Œåœ¨ä¸‹é¢ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå‡½æ•°ä¸º<spanclass="math inline">\(J\)</span>å‡½æ•°ï¼š <span class="math display">\[J(\theta) = \frac 12 \sum^m_{i=1}(h_\theta(x^{(i)})-y^{(i)})^2\]</span> å¦‚ä½•è°ƒæ•´<span class="math inline">\(\theta\)</span>ä»¥ä½¿å¾—<spanclass="math inline">\(J(\theta)\)</span>å–å¾—æœ€å°å€¼æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œå…¶ä¸­æœ‰æœ€å°äºŒä¹˜æ³•(leastsquares method)å’Œæ¢¯åº¦ä¸‹é™æ³•ç­‰ã€‚</p><h3 id="æœ€å°äºŒä¹˜æ³•">1.1 æœ€å°äºŒä¹˜æ³•</h3><p>ç»™å®šä¸€ä¸ªè®­ç»ƒé›†ï¼ŒæŠŠ<strong>è®¾è®¡çŸ©é˜µï¼ˆdesign matrixï¼‰</strong> <spanclass="math inline">\(x\)</span> è®¾ç½®ä¸ºä¸€ä¸ª <spanclass="math inline">\(m\times n\)</span>çŸ©é˜µï¼ˆå®é™…ä¸Šï¼Œå¦‚æœè€ƒè™‘åˆ°æˆªè·é¡¹ï¼Œä¹Ÿå°±æ˜¯ <spanclass="math inline">\(\theta_0\)</span> é‚£ä¸€é¡¹ï¼Œå°±åº”è¯¥æ˜¯ <spanclass="math inline">\(m\times (n+1)\)</span>çŸ©é˜µï¼‰ï¼Œè¿™ä¸ªçŸ©é˜µé‡Œé¢åŒ…å«äº†è®­ç»ƒæ ·æœ¬çš„è¾“å…¥å€¼ä½œä¸ºæ¯ä¸€è¡Œï¼š</p><p><span class="math display">\[X =\begin{bmatrix}(x^{(1)}) ^T\\(x^{(2)}) ^T\\\vdots \\(x^{(m)}) ^T\\\end{bmatrix}\]</span></p><p>ç„¶åï¼Œå’±ä»¬è®¾ <span class="math inline">\(\vec{y}\)</span> æ˜¯ä¸€ä¸ª<span class="math inline">\(m\)</span> ç»´å‘é‡ï¼ˆm-dimensionalvectorï¼‰ï¼Œå…¶ä¸­åŒ…å«äº†è®­ç»ƒé›†ä¸­çš„æ‰€æœ‰ç›®æ ‡å€¼ï¼š</p><p><span class="math display">\[Y =\begin{bmatrix}y^{(1)}\\y^{(2)}\\\vdots \\y^{(m)}\\\end{bmatrix}\]</span></p><p>å‡è®¾<span class="math inline">\(h_\theta(x_1,x_2,...,x_m)=\theta_0+\theta_1 \times x_1 + \theta_2 \times x_2 + ... +\theta \timesx_m\)</span>â€‹ çš„çŸ©é˜µè¡¨è¾¾å¼ä¸º <span class="math display">\[h_\theta(x)=X_\theta\]</span> æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š <span class="math display">\[\frac \partial {\partial\theta_j}J(\theta) = \frac12 (X_\theta - Y) ^ T(X_\theta - T)\]</span> è¿™æ—¶å€™æˆ‘ä»¬è¦å¯¹è¿™ä¸ªæŸå¤±å‡½æ•°çš„ <spanclass="math inline">\(\theta\)</span> å‘é‡è¿›è¡Œæ±‚å¯¼å–0ï¼Œç»“æœå¦‚ä¸‹å¼ï¼š<span class="math display">\[\theta = (X^T X)^{-1} X^T Y\]</span></p><h3 id="æ¢¯åº¦ä¸‹é™ç®—æ³•">1.2 æ¢¯åº¦ä¸‹é™ç®—æ³•</h3><p>æˆ‘ä»¬å¸Œæœ›é€‰æ‹©ä¸€ä¸ªèƒ½è®© <span class="math inline">\(J(\theta)\)</span>æœ€å°çš„ <span class="math inline">\(\theta\)</span>å€¼ã€‚æ€ä¹ˆåšå‘¢ï¼Œå’±ä»¬å…ˆç”¨ä¸€ä¸ªæœç´¢çš„ç®—æ³•ï¼Œä»æŸä¸€ä¸ªå¯¹ <spanclass="math inline">\(\theta\)</span> çš„â€œåˆå§‹çŒœæµ‹å€¼â€ï¼Œç„¶åå¯¹ <spanclass="math inline">\(\theta\)</span> å€¼ä¸æ–­è¿›è¡Œè°ƒæ•´ï¼Œæ¥è®© <spanclass="math inline">\(J(\theta)\)</span>é€æ¸å˜å°ï¼Œæœ€å¥½æ˜¯ç›´åˆ°æˆ‘ä»¬èƒ½å¤Ÿè¾¾åˆ°ä¸€ä¸ªä½¿ <spanclass="math inline">\(J(\theta)\)</span> æœ€å°çš„ <spanclass="math inline">\(\theta\)</span>ã€‚å…·ä½“æ¥è¯´ï¼Œå’±ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼ˆgradientdescent algorithmï¼‰ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯ä»æŸä¸€ä¸ª <spanclass="math inline">\(\theta\)</span>çš„åˆå§‹å€¼å¼€å§‹ï¼Œç„¶åé€æ¸é‡å¤æ›´æ–°ï¼š</p><p><span class="math display">\[\theta_j := \theta_j - \alpha \frac \partial {\partial\theta_j}J(\theta)\]</span></p><p>ï¼ˆä¸Šé¢çš„è¿™ä¸ªæ›´æ–°è¦åŒæ—¶å¯¹åº”ä» <span class="math inline">\(0\)</span>åˆ° <span class="math inline">\(n\)</span> çš„æ‰€æœ‰<spanclass="math inline">\(j\)</span> å€¼è¿›è¡Œã€‚ï¼‰è¿™é‡Œçš„ <spanclass="math inline">\(\alpha\)</span>ä¹Ÿç§°ä¸ºå­¦ä¹ é€Ÿç‡ã€‚è¿™ä¸ªç®—æ³•æ˜¯å¾ˆè‡ªç„¶çš„ï¼Œé€æ­¥é‡å¤æœå‘ <spanclass="math inline">\(J\)</span> é™ä½æœ€å¿«çš„æ–¹å‘ç§»åŠ¨ã€‚</p><p>è¦å®ç°è¿™ä¸ªç®—æ³•ï¼Œå’±ä»¬éœ€è¦è§£å†³ç­‰å·å³è¾¹çš„å¯¼æ•°é¡¹ã€‚é¦–å…ˆæ¥è§£å†³åªæœ‰ä¸€ç»„è®­ç»ƒæ ·æœ¬<span class="math inline">\((x, y)\)</span>çš„æƒ…å†µï¼Œè¿™æ ·å°±å¯ä»¥å¿½ç•¥æ‰ç­‰å·å³è¾¹å¯¹ <spanclass="math inline">\(J\)</span> çš„æ±‚å’Œé¡¹ç›®äº†ã€‚å…¬å¼å°±ç®€åŒ–ä¸‹é¢è¿™æ ·ï¼š</p><p><span class="math display">\[\begin{aligned}\frac \partial {\partial\theta_j}J(\theta) &amp; = \frac \partial{\partial\theta_j} \frac  12(h_\theta(x)-y)^2\\&amp; = 2 \cdot\frac 12(h_\theta(x)-y)\cdot \frac \partial{\partial\theta_j}  (h_\theta(x)-y) \\&amp; = (h_\theta(x)-y)\cdot \frac \partial{\partial\theta_j}(\sum^n_{i=0} \theta_ix_i-y) \\&amp; = (h_\theta(x)-y) x_j\end{aligned}\]</span></p><p>å¯¹å•ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œæ›´æ–°è§„åˆ™å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><span class="math display">\[\theta_j := \theta_j + \alpha (y^{(i)}-h_\theta (x^{(i)}))x_j^{(i)}\]</span></p><p>ç¬¬ä¸€ç§å°±æ˜¯ä¸‹é¢è¿™ä¸ªç®—æ³•ï¼š</p>$<span class="math display">\[\begin{aligned}&amp;\qquad é‡å¤ç›´åˆ°æ”¶æ•› \{ \\&amp;\qquad\qquad\theta_j := \theta_j + \alpha\sum^m_{i=1}(y^{(i)}-h_\theta (x^{(i)}))x_j^{(i)}\quad(å¯¹æ¯ä¸ªj) \\&amp;\qquad\}\end{aligned}\]</span><p>$</p><p>è¯»è€…å¾ˆå®¹æ˜“èƒ½è¯æ˜ï¼Œåœ¨ä¸Šé¢è¿™ä¸ªæ›´æ–°è§„åˆ™ä¸­æ±‚å’Œé¡¹çš„å€¼å°±æ˜¯<spanclass="math inline">\(\frac {\partial J(\theta)}{\partial\theta_j}\)</span> ï¼ˆè¿™æ˜¯å› ä¸ºå¯¹ <span class="math inline">\(J\)</span>çš„åŸå§‹å®šä¹‰ï¼‰ã€‚æ‰€ä»¥è¿™ä¸ªæ›´æ–°è§„åˆ™å®é™…ä¸Šå°±æ˜¯å¯¹åŸå§‹çš„æˆæœ¬å‡½æ•°<spanclass="math inline">\(J\)</span>è¿›è¡Œç®€å•çš„æ¢¯åº¦ä¸‹é™ã€‚è¿™ä¸€æ–¹æ³•åœ¨æ¯ä¸€ä¸ªæ­¥é•¿å†…æ£€æŸ¥æ‰€æœ‰æ•´ä¸ªè®­ç»ƒé›†ä¸­çš„æ‰€æœ‰æ ·æœ¬ï¼Œä¹Ÿå«åš<strong>æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•ï¼ˆbatchgradientdescent</strong>ï¼‰ã€‚è¿™é‡Œè¦æ³¨æ„ï¼Œå› ä¸ºæ¢¯åº¦ä¸‹é™æ³•å®¹æ˜“è¢«å±€éƒ¨æœ€å°å€¼å½±å“ï¼Œè€Œæˆ‘ä»¬è¦è§£å†³çš„è¿™ä¸ªçº¿æ€§å›å½’çš„ä¼˜åŒ–é—®é¢˜åªèƒ½æœ‰ä¸€ä¸ªå…¨å±€çš„è€Œä¸æ˜¯å±€éƒ¨çš„æœ€ä¼˜è§£ï¼›å› æ­¤ï¼Œæ¢¯åº¦ä¸‹é™æ³•åº”è¯¥æ€»æ˜¯æ”¶æ•›åˆ°å…¨å±€æœ€å°å€¼ï¼ˆå‡è®¾å­¦ä¹ é€Ÿç‡<span class="math inline">\(\alpha\)</span> ä¸è®¾ç½®çš„è¿‡å¤§ï¼‰ã€‚</p><p>å¯¹å’±ä»¬ä¹‹å‰çš„æˆ¿å±‹æ•°æ®é›†è¿›è¡Œæ‰¹é‡æ¢¯åº¦ä¸‹é™æ¥æ‹Ÿåˆ <spanclass="math inline">\(\theta\)</span>ï¼ŒæŠŠæˆ¿å±‹ä»·æ ¼å½“ä½œæˆ¿å±‹é¢ç§¯çš„å‡½æ•°æ¥è¿›è¡Œé¢„æµ‹ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯ <spanclass="math inline">\(\theta_0 = 71.27, \theta_1 =0.1345\)</span>ã€‚å¦‚æœæŠŠ <spanclass="math inline">\(h_{\theta}(x)\)</span> ä½œä¸ºä¸€ä¸ªå®šä¹‰åŸŸåœ¨ <spanclass="math inline">\(x\)</span>ä¸Šçš„å‡½æ•°æ¥æŠ•å½±ï¼ŒåŒæ—¶ä¹ŸæŠ•ä¸Šè®­ç»ƒé›†ä¸­çš„å·²æœ‰æ•°æ®ç‚¹ï¼Œä¼šå¾—åˆ°ä¸‹é¢è¿™å¹…å›¾ï¼š</p><p><img src="/img/çº¿æ€§æ¨¡å‹/3.png" /></p><p>å¦‚æœåœ¨æ•°æ®é›†ä¸­æ·»åŠ ä¸Šå§å®¤æ•°ç›®ä½œä¸ºè¾“å…¥ç‰¹å¾ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ç»“æœå°±æ˜¯ <spanclass="math inline">\(\theta_0 = 89.60, \theta_1 = 0.1392, \theta_2 =âˆ’8.738\)</span>â€‹ã€‚è¿™ä¸ªç»“æœå°±æ˜¯ç”¨æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•æ¥è·å¾—çš„ã€‚</p><p>æ­¤å¤–è¿˜æœ‰å¦å¤–ä¸€ç§æ–¹æ³•èƒ½å¤Ÿæ›¿ä»£æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•ï¼Œè¿™ç§æ–¹æ³•æ•ˆæœä¹Ÿä¸é”™ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>$<span class="math display">\[\begin{aligned}&amp;\qquadå¾ªç¯ï¼š\{ \\&amp;\qquad\qquad iä»1åˆ°m,\{   \\&amp;\qquad\qquad\qquad\theta_j :=\theta_j  +\alpha(y^{(i)}-h_{\theta}(x^{(i)}))x_j^{(i)} \qquad(å¯¹æ¯ä¸ª j)\\&amp;\qquad\qquad\}  \\&amp;\qquad\}\end{aligned}\]</span><p>$</p><p>åœ¨è¿™ä¸ªç®—æ³•é‡Œï¼Œæˆ‘ä»¬å¯¹æ•´ä¸ªè®­ç»ƒé›†è¿›è¡Œäº†å¾ªç¯éå†ï¼Œæ¯æ¬¡é‡åˆ°ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œæ ¹æ®æ¯ä¸ªå•ä¸€è®­ç»ƒæ ·æœ¬çš„è¯¯å·®æ¢¯åº¦æ¥å¯¹å‚æ•°è¿›è¡Œæ›´æ–°ã€‚è¿™ä¸ªç®—æ³•å«åš<strong>éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼ˆstochasticgradient descentï¼‰</strong>ï¼Œæˆ–è€…å«<strong>å¢é‡æ¢¯åº¦ä¸‹é™æ³•ï¼ˆincrementalgradientdescentï¼‰</strong>ã€‚æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•è¦åœ¨è¿è¡Œç¬¬ä¸€æ­¥ä¹‹å‰å…ˆå¯¹æ•´ä¸ªè®­ç»ƒé›†è¿›è¡Œæ‰«æéå†ï¼Œå½“è®­ç»ƒé›†çš„è§„æ¨¡<span class="math inline">\(m\)</span>å˜å¾—å¾ˆå¤§çš„æ—¶å€™ï¼Œå¼•èµ·çš„æ€§èƒ½å¼€é”€å°±å¾ˆä¸åˆ’ç®—äº†ï¼›éšæœºæ¢¯åº¦ä¸‹é™æ³•å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œè€Œæ˜¯å¯ä»¥ç«‹å³å¼€å§‹ï¼Œå¯¹æŸ¥è¯¢åˆ°çš„æ¯ä¸ªæ ·æœ¬éƒ½è¿›è¡Œè¿ç®—ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œéšæœºæ¢¯åº¦ä¸‹é™æ³•æŸ¥æ‰¾åˆ°è¶³å¤Ÿæ¥è¿‘æœ€ä½å€¼çš„<span class="math inline">\(\theta\)</span>çš„é€Ÿåº¦è¦æ¯”æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•æ›´å¿«ä¸€äº›ã€‚ï¼ˆä¹Ÿè¦æ³¨æ„ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šä¸€ç›´æ— æ³•æ”¶æ•›ï¼ˆconvergeï¼‰åˆ°æœ€å°å€¼ï¼Œè¿™æ—¶å€™<span class="math inline">\(\theta\)</span> ä¼šä¸€ç›´åœ¨ <spanclass="math inline">\(J(\theta)\)</span>æœ€å°å€¼é™„è¿‘éœ‡è¡ï¼›ä¸è¿‡é€šå¸¸æƒ…å†µä¸‹åœ¨æœ€å°å€¼é™„è¿‘çš„è¿™äº›å€¼å¤§å¤šæ•°å…¶å®ä¹Ÿè¶³å¤Ÿé€¼è¿‘äº†ï¼Œè¶³ä»¥æ»¡è¶³å’±ä»¬çš„ç²¾åº¦è¦æ±‚ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨ã€‚ï¼‰ç”±äºè¿™äº›åŸå› ï¼Œç‰¹åˆ«æ˜¯åœ¨è®­ç»ƒé›†å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œéšæœºæ¢¯åº¦ä¸‹é™å¾€å¾€æ¯”æ‰¹é‡æ¢¯åº¦ä¸‹é™æ›´å—é’çã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Machine Learning</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
